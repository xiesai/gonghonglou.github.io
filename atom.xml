<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>与佳期的个人博客</title>
  <subtitle>登白薠兮骋望，与佳期兮夕张。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://gonghonglou.com/"/>
  <updated>2017-09-07T05:43:12.000Z</updated>
  <id>http://gonghonglou.com/</id>
  
  <author>
    <name>与佳期</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>100 Days, 100 Blogs</title>
    <link href="http://gonghonglou.com/2017/08/09/100days-100blogs/"/>
    <id>http://gonghonglou.com/2017/08/09/100days-100blogs/</id>
    <published>2017-08-09T03:57:11.000Z</published>
    <updated>2017-09-07T05:43:12.000Z</updated>
    
    <content type="html">&lt;p&gt;一直以来都活跃在微博、简书等各大网站搜罗技术博客，每当看到大牛发布或者转发技术博客都会点进去搂一眼，内容比较好或者比较感兴趣的话就会转发收藏。&lt;br&gt;但这些都是零零碎碎的，大多时候都是路上、睡觉前或者什么间隙看到一篇好文章，简单看一下就收藏了，当时来不及 想着以后细读，但往往是在这之后基本上不会再次翻阅了。所以计划从今天起每天仔细阅读一篇技术博客，在这里做一做笔记。&lt;/p&gt;
&lt;p&gt;微博每日打卡：&lt;a href=&quot;https://weibo.com/p/100808e7a8991364ef294db915427e9aeb2a7e&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;#100days,100blogs#&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;持续更新中……&quot;&gt;&lt;a href=&quot;#持续更新中……&quot; class=&quot;headerlink&quot; title=&quot;# 持续更新中……&quot;&gt;&lt;/a&gt;# 持续更新中……&lt;/h1&gt;&lt;h1 id=&quot;Day-30-神经病院Objective-C-Runtime出院第三天——如何正确使用Runtime&quot;&gt;&lt;a href=&quot;#Day-30-神经病院Objective-C-Runtime出院第三天——如何正确使用Runtime&quot; class=&quot;headerlink&quot; title=&quot;# Day 30 : 神经病院Objective-C Runtime出院第三天——如何正确使用Runtime&quot;&gt;&lt;/a&gt;# Day 30 : &lt;a href=&quot;http://www.jianshu.com/p/db6dc23834e3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;神经病院Objective-C Runtime出院第三天——如何正确使用Runtime&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://www.jianshu.com/u/12201cdd5d7a&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;一缕殇流化隐半边冰霜（halfrost）&lt;/a&gt; 发布&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Runtime的优点&lt;ul&gt;
&lt;li&gt;实现多继承Multiple Inheritance：&lt;br&gt;  – &lt;code&gt;forwardingTargetForSelector:&lt;/code&gt;这一步将消息转发给正确的类对象就可以模拟多继承的效果&lt;br&gt;  – 即使我们利用转发消息来实现了“假”继承，但是NSObject类还是会将两者区分开，像respondsToSelector:和 isKindOfClass:这类方法只会考虑继承体系，不会考虑转发链，可以重写 respondsToSelector:和 isKindOfClass:等方法来加入自己的转发算法。&lt;/li&gt;
&lt;li&gt;Method Swizzling：&lt;ul&gt;
&lt;li&gt;Method Swizzling原理：本质上就是对IMP和SEL进行交换。&lt;/li&gt;
&lt;li&gt;Method Swizzling使用：通常应用于在category中添加一个方法。&lt;/li&gt;
&lt;li&gt;Method Swizzling注意点&lt;br&gt;  – Swizzling应该总在+load中执行&lt;br&gt;  – Swizzling应该总是在dispatch_once中执行&lt;br&gt;  – Swizzling在+load中执行时，不要调用[super load]&lt;/li&gt;
&lt;li&gt;Method Swizzling使用场景&lt;br&gt;  – 实现AOP&lt;br&gt;  – 实现埋点统计&lt;br&gt;  – 实现异常保护&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Aspect Oriented Programming&lt;/li&gt;
&lt;li&gt;Isa Swizzling&lt;br&gt;  – KVO是为了监听一个对象的某个属性值是否发生变化。在属性值发生变化的时候，肯定会调用其setter方法。所以KVO的本质就是监听对象有没有调用被监听属性对应的setter方法。&lt;/li&gt;
&lt;li&gt;Associated Object关联对象&lt;/li&gt;
&lt;li&gt;动态的增加方法&lt;/li&gt;
&lt;li&gt;NSCoding的自动归档和自动解档&lt;br&gt;  – 用runtime实现的思路就比较简单，我们循环依次找到每个成员变量的名称，然后利用KVC读取和赋值就可以完成encodeWithCoder和initWithCoder了。&lt;/li&gt;
&lt;li&gt;字典和模型互相转换&lt;ul&gt;
&lt;li&gt;字典转模型&lt;br&gt;  – 调用 class_getProperty 方法获取当前 Model 的所有属性。&lt;br&gt;  – 调用 property_copyAttributeList 获取属性列表。&lt;br&gt;  – 根据属性名称生成 setter 方法。&lt;br&gt;  – 使用 objc_msgSend 调用 setter 方法为 Model 的属性赋值（或者 KVC）&lt;/li&gt;
&lt;li&gt;模型转字典&lt;br&gt;  – 调用 class_copyPropertyList 方法获取当前 Model 的所有属性。&lt;br&gt;  – 调用 property_getName 获取属性名称。&lt;br&gt;  – 根据属性名称生成 getter 方法。&lt;br&gt;  – 使用 objc_msgSend 调用 getter 方法获取属性值（或者 KVC）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Runtime的缺点&lt;br&gt;  –     Method swizzling is not atomic&lt;br&gt;  –     Changes behavior of un-owned code&lt;br&gt;  –     Possible naming conflicts&lt;br&gt;  –     Swizzling changes the method’s arguments&lt;br&gt;  –     The order of swizzles matters&lt;br&gt;  –     Difficult to understand (looks recursive)&lt;br&gt;  –     Difficult to debug&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;日常可能用的比较多的Runtime函数：&lt;br&gt;&lt;figure class=&quot;highlight oxygene&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 调用指定方法的实现 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;id method_invoke ( id receiver, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;, ... );&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 调用返回一个数据结构的方法的实现 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;void method_invoke_stret ( id receiver, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;, ... );&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 返回指定方法的方法描述结构体 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;struct objc_method_description * method_getDescription ( &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;m&lt;/span&gt; );&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//获取cls类对象所有成员ivar结构体 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Ivar *class_copyIvarList(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, unsigned int *outCount) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//获取cls类对象name对应的实例方法结构体 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_getInstanceMethod&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, SEL name)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;类对象&lt;span class=&quot;title&quot;&gt;name&lt;/span&gt;对应类方法结构体 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_getClassMethod&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, SEL name)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;类对象&lt;span class=&quot;title&quot;&gt;name&lt;/span&gt;对应方法&lt;span class=&quot;title&quot;&gt;imp&lt;/span&gt;实现 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;IMP&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_getMethodImplementation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, SEL name)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//测试&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;对应的实例是否响应&lt;span class=&quot;title&quot;&gt;sel&lt;/span&gt;对应的方法 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_respondsToSelector&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, SEL sel)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;对应方法列表 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;Method&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;class_copyMethodList&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, unsigned int *outCount)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//测试&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;是否遵守&lt;span class=&quot;title&quot;&gt;protocol&lt;/span&gt;协议 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_conformsToProtocol&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, Protocol *protocol)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//为&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;类对象添加新方法 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_addMethod&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, SEL name, IMP imp, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; char *types)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//替换&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;类对象中&lt;span class=&quot;title&quot;&gt;name&lt;/span&gt;对应方法的实现 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;IMP&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_replaceMethod&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, SEL name, IMP imp, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; char *types)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//为&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;添加新成员 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_addIvar&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; char *name, size_t size, uint8_t alignment, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; char *types)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//为&lt;span class=&quot;title&quot;&gt;cls&lt;/span&gt;添加新属性 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;class_addProperty&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Class&lt;/span&gt; cls, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; char *name, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; objc_property_attribute_t *attributes, unsigned int attributeCount)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;对应的选择器 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;SEL&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_getName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;对应的方法实现的&lt;span class=&quot;title&quot;&gt;imp&lt;/span&gt;指针 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;IMP&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_getImplementation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;方法的对应编码 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;char&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;method_getTypeEncoding&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;方法参数的个数 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_getNumberOfArguments&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//&lt;span class=&quot;title&quot;&gt;copy&lt;/span&gt;方法返回值类型 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;char&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;method_copyReturnType&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;方法&lt;span class=&quot;title&quot;&gt;index&lt;/span&gt;索引参数的类型 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;char&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;method_copyArgumentType&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m, unsigned int &lt;span class=&quot;keyword&quot;&gt;index&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;方法返回值类型 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_getReturnType&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m, char *dst, size_t dst_len)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取方法的参数类型 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_getArgumentType&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m, unsigned int &lt;span class=&quot;keyword&quot;&gt;index&lt;/span&gt;, char *dst, size_t dst_len)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//设置&lt;span class=&quot;title&quot;&gt;m&lt;/span&gt;方法的具体实现指针 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;IMP&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_setImplementation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m, IMP imp)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//交换&lt;span class=&quot;title&quot;&gt;m1&lt;/span&gt;，&lt;span class=&quot;title&quot;&gt;m2&lt;/span&gt;方法对应具体实现的函数指针 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;method_exchangeImplementations&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m1, &lt;span class=&quot;keyword&quot;&gt;Method&lt;/span&gt; m2)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;v&lt;/span&gt;的名称 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;char&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;ivar_getName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Ivar v)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;v&lt;/span&gt;的类型编码 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;char&lt;/span&gt; *&lt;span class=&quot;title&quot;&gt;ivar_getTypeEncoding&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Ivar v)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//设置&lt;span class=&quot;title&quot;&gt;object&lt;/span&gt;对象关联的对象 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;objc_setAssociatedObject&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(id object, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; void *key, id value, objc_AssociationPolicy policy)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//获取&lt;span class=&quot;title&quot;&gt;object&lt;/span&gt;关联的对象 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;objc_getAssociatedObject&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(id object, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; void *key)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//移除&lt;span class=&quot;title&quot;&gt;object&lt;/span&gt;关联的对象 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;objc_removeAssociatedObjects&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(id object)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;⚠️注：runtime 系列文章，有原理讲解有用法示例，深度好文！&lt;/p&gt;
&lt;h1 id=&quot;Day-29-神经病院Objective-C-Runtime住院第二天——消息发送与转发&quot;&gt;&lt;a href=&quot;#Day-29-神经病院Objective-C-Runtime住院第二天——消息发送与转发&quot; class=&quot;headerlink&quot; title=&quot;# Day 29 : 神经病院Objective-C Runtime住院第二天——消息发送与转发&quot;&gt;&lt;/a&gt;# Day 29 : &lt;a href=&quot;http://www.jianshu.com/p/4d619b097e20&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;神经病院Objective-C Runtime住院第二天——消息发送与转发&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://www.jianshu.com/u/12201cdd5d7a&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;一缕殇流化隐半边冰霜（halfrost）&lt;/a&gt; 发布&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;objc_msgSend函数简介。objc_msgSend会做一下几件事情：&lt;br&gt;  – 检测这个 selector 是不是要忽略的。&lt;br&gt;  – 检查target是不是为nil。如果这里有相应的nil的处理函数，就跳转到相应的函数中。如果没有处理nil的函数，就自动清理现场并返回。这一点就是为何在OC中给nil发送消息不会崩溃的原因。&lt;br&gt;  – 确定不是给nil发消息之后，在该class的缓存中查找方法对应的IMP实现。如果找到，就跳转进去执行。如果没有找到，就在方法分发表里面继续查找，一直找到NSObject为止&lt;br&gt;  – 如果还没有找到，那就需要开始消息转发阶段了。至此，发送消息Messaging阶段完成。这一阶段主要完成的是通过select()快速查找IMP的过程&lt;/li&gt;
&lt;li&gt;消息发送Messaging阶段—objc_msgSend源码解析&lt;/li&gt;
&lt;li&gt;消息转发Message Forwarding阶段&lt;/li&gt;
&lt;li&gt;forwardInvocation的例子&lt;/li&gt;
&lt;li&gt;入院考试&lt;/li&gt;
&lt;li&gt;Runtime中的优化&lt;br&gt;  –    方法列表的缓存&lt;br&gt;  – 虚函数表vTable&lt;br&gt;  – dyld共享缓存&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;runtime 系列文章，同样很有深度。因为有很多源码分析和原理讲解且内容较多所以不好简洁总结，之后再温故知新吧！&lt;/p&gt;
&lt;h1 id=&quot;Day-28-神经病院Objective-C-Runtime入院第一天——isa和Class&quot;&gt;&lt;a href=&quot;#Day-28-神经病院Objective-C-Runtime入院第一天——isa和Class&quot; class=&quot;headerlink&quot; title=&quot;# Day 28 : 神经病院Objective-C Runtime入院第一天——isa和Class&quot;&gt;&lt;/a&gt;# Day 28 : &lt;a href=&quot;http://www.jianshu.com/p/9d649ce6d0b8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;神经病院Objective-C Runtime入院第一天——isa和Class&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://www.jianshu.com/u/12201cdd5d7a&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;一缕殇流化隐半边冰霜（halfrost）&lt;/a&gt; 发布&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;NSObject起源&lt;br&gt;  – 在NSObject协议中，有以下5个方法：&lt;/p&gt;
  &lt;figure class=&quot;highlight haml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-&lt;span class=&quot;ruby&quot;&gt; (Class)&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;OBJC_SWIFT_UNAVAILABLE&lt;/span&gt;(&quot;&lt;span class=&quot;title&quot;&gt;use&lt;/span&gt; &#39;&lt;span class=&quot;title&quot;&gt;anObject&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;dynamicType&lt;/span&gt;&#39; &lt;span class=&quot;title&quot;&gt;instead&lt;/span&gt;&quot;);&lt;/span&gt; /&lt;span class=&quot;regexp&quot;&gt;/ 返回对象的类&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;regexp&quot;&gt; (BOOL)isKindOfClass:(Class)aClass; /&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/ 检查对象是否存在于指定的类的继承体系中(是否是其子类或者父类或者当前类的成员变量)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;regexp&quot;&gt; (BOOL)isMemberOfClass:(Class)aClass; /&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/ 检查对象是否存在于指定的类的继承体系中(是否是其子类或者父类或者当前类的成员变量)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;regexp&quot;&gt; (BOOL)conformsToProtocol:(Protocol *)aProtocol; /&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/ 检查对象能否响应指定的消息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;regexp&quot;&gt; (BOOL)respondsToSelector:(SEL)aSelector; /&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/ 检查对象是否实现了指定协议类的方法&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;  在NSObject的类中还定义了一个方法：&lt;code&gt;- (IMP)methodForSelector:(SEL)aSelector;&lt;/code&gt;这个方法会返回指定方法实现的地址IMP&lt;br&gt;  – 当我们导入了objc/Runtime.h和objc/message.h两个头文件之后，我们查找到了Runtime的函数之后，代码打完，发现没有代码提示了，可以在 &lt;code&gt;Build settings&lt;/code&gt; 中搜索 &lt;code&gt;objc_msg&lt;/code&gt; 将 &lt;code&gt;Enable Strict Checking objc_msgSend Calls&lt;/code&gt; 设为 &lt;code&gt;NO&lt;/code&gt;&lt;br&gt;  – 在引入元类之后，类对象和对象查找方法的机制就完全统一了：对象的实例方法调用时，通过对象的 isa 在类中获取方法的实现。类对象的类方法调用时，通过类的 isa 在元类中获取方法的实现。&lt;/p&gt;
&lt;p&gt;  – isa_t结构体的具体实现&lt;br&gt;  – cache_t的具体实现：Cache的作用主要是为了优化方法调用的性能。当对象receiver调用方法message时，首先根据对象receiver的isa指针查找到它对应的类，然后在类的methodLists中搜索方法，如果没有找到，就使用super_class指针到父类中的methodLists查找，一旦找到就调用方法。如果没有找到，有可能消息转发，也可能忽略它。但这样查找方式效率太低，因为往往一个类大概只有20%的方法经常被调用，占总调用次数的80%。所以使用Cache来缓存经常调用的方法，当调用方法时，优先在Cache查找，如果没有找到，再到methodLists查找&lt;br&gt;  – class_data_bits_t的具体实现&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;入院考试&lt;br&gt;  – [self class] 与 [super class]&lt;br&gt;  – isKindOfClass 与 isMemberOfClass&lt;br&gt;  – Class与内存地址&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;⚠️注：很有深度，应该是那种温故而知新的文章，后续还会再读！&lt;/p&gt;
&lt;h1 id=&quot;Day-27-处理手势冲突和错乱的一点经验&quot;&gt;&lt;a href=&quot;#Day-27-处理手势冲突和错乱的一点经验&quot; class=&quot;headerlink&quot; title=&quot;# Day 27 : 处理手势冲突和错乱的一点经验&quot;&gt;&lt;/a&gt;# Day 27 : &lt;a href=&quot;http://yulingtianxia.com/blog/2016/08/29/Some-Experience-of-Gesture/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;处理手势冲突和错乱的一点经验&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://yulingtianxia.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;玉令天下的博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;对于复杂页面掺合多种手势的场景，采用“状态机”的方案来区分手势进行页面操作&lt;/p&gt;
&lt;p&gt;– 对手势统一处理和分发：把各种手势全都添加到底层的全屏视图上，然后统一处理和分发结果。因为每种手势只有一个且都加在了底层视图，所以不会发生不同视图间的手势错乱。而不同种手势之间的冲突就需要在 UIGestureRecognizerDelegate 中根据业务逻辑来解决了。&lt;br&gt;– 计算响应手势的视图：可以通过 locationInView: 获取手势的坐标，但这里决不能简单地计算手势坐标到视图 center 的距离并选取最近的视图，这里需要检测手势坐标处于哪个视图的范围内。&lt;br&gt;– 处理 Pinch 手势：1、分辨率：当对含有矢量内容的视图进行缩放时会有模糊和锯齿出现，这时递归需要改变 UIView 的 contentScaleFactor 和 CALayer 的 contentsScale 属性。2、坐标：视图的 transform 属性是不会修改视图的 bounds 的，但 frame 作为计算属性还是会变化的。也就是说无论视图放大了多少倍，视图内部的子视图的 frame 不会变。&lt;br&gt;– 处理 Rotation 手势：一直用『视图区域』而不直接用 frame 来描述手势判断依据，是因为当视图旋转（90°倍数除外）之后 frame 并不等于『视图区域』（文中有提供方法用于判断某个点是否在『视图区域』内）&lt;br&gt;– 如果所有手势都交给一个底层视图统一处理的话，上层那一坨视图是不需要响应触摸事件的，有些甚至可以用 Layer 来做。&lt;/p&gt;
&lt;p&gt;其中两条参考链接值得参考：&lt;br&gt;&lt;a href=&quot;http://www.informit.com/articles/article.aspx?p=1951182&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Taking Charge of UIView Transforms in iOS Programming&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://stackoverflow.com/questions/5927223/scaling-uitextview-using-contentscalefactor-property&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Scaling UITextView using contentScaleFactor property&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;Day-26-详解CALayer-和-UIView的区别和联系&quot;&gt;&lt;a href=&quot;#Day-26-详解CALayer-和-UIView的区别和联系&quot; class=&quot;headerlink&quot; title=&quot;# Day 26 : 详解CALayer 和 UIView的区别和联系&quot;&gt;&lt;/a&gt;# Day 26 : &lt;a href=&quot;http://www.jianshu.com/p/079e5cf0f014?utm_campaign=maleskine&amp;amp;utm_content=note&amp;amp;utm_medium=writer_share&amp;amp;utm_source=weibo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;详解CALayer 和 UIView的区别和联系&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://www.jianshu.com/u/8d704c0faf00&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;kissGod&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;– 每个 UIView 内部都有一个 CALayer 在背后提供内容的绘制和显示，并且 UIView 的尺寸样式都由内部的 Layer 所提供。两者都有树状层级结构，layer 内部有 SubLayers，View 内部有 SubViews.但是 Layer 比 View 多了个AnchorPoint&lt;br&gt;– 在 View显示的时候，UIView 做为 Layer 的 CALayerDelegate,View 的显示内容由内部的 CALayer 的 display&lt;br&gt;– CALayer 是默认修改属性支持隐式动画的，在给 UIView 的 Layer 做动画的时候，View 作为 Layer 的代理，Layer 通过 actionForLayer:forKey:向 View请求相应的 action(动画行为)&lt;br&gt;– layer 内部维护着三分 layer tree,分别是 presentLayer Tree(动画树),modeLayer Tree(模型树), Render Tree (渲染树),在做 iOS动画的时候，我们修改动画的属性，在动画的其实是 Layer 的 presentLayer的属性值,而最终展示在界面上的其实是提供 View的modelLayer&lt;br&gt;– 两者最明显的区别是 View可以接受并处理事件，而 Layer 不可以&lt;/p&gt;
&lt;h1 id=&quot;Day-25-iOS-常见知识点（三）：Lock&quot;&gt;&lt;a href=&quot;#Day-25-iOS-常见知识点（三）：Lock&quot; class=&quot;headerlink&quot; title=&quot;# Day 25 : iOS 常见知识点（三）：Lock&quot;&gt;&lt;/a&gt;# Day 25 : &lt;a href=&quot;http://www.jianshu.com/p/ddbe44064ca4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOS 常见知识点（三）：Lock&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://www.jianshu.com/u/263107bb1199&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AidenRao&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;iOS 中的八大锁&lt;br&gt;– NSLock：遵循 NSLocking 协议lock 方法是加锁，unlock 是解锁，tryLock 是尝试加锁，如果失败的话返回 NO，lockBeforeDate: 是在指定Date之前尝试加锁，如果在指定时间之前都不能加锁，则返回NO&lt;br&gt;互斥锁会使得线程阻塞，阻塞的过程又分两个阶段，第一阶段是会先空转，可以理解成跑一个 while 循环，不断地去申请加锁，在空转一定时间之后，线程会进入 waiting 状态，此时线程就不占用CPU资源了，等锁可用的时候，这个线程会立即被唤醒。&lt;br&gt;– NSConditionLock：遵循 NSLocking 协议，方法都类似，只是多了一个 condition 属性，以及每个操作都多了一个关于 condition 属性的方法。NSConditionLock 还可以实现任务之间的依赖&lt;br&gt;– NSRecursiveLock：递归锁，他和 NSLock 的区别在于，NSRecursiveLock 可以在一个线程中重复加锁（反正单线程内任务是按顺序执行的，不会出现资源竞争问题），NSRecursiveLock 会记录上锁和解锁的次数，当二者平衡的时候，才会释放锁，其它线程才可以上锁成功&lt;br&gt;– NSCondition：NSCondition 并不会像上文的那些锁一样，先轮询，而是直接进入 waiting 状态，当其它线程中的该锁执行 signal 或者 broadcast 方法时，线程被唤醒，继续运行之后的方法&lt;br&gt;– @synchronized：&lt;br&gt;– dispatch_semaphore：GCD 用来同步的一种方式&lt;br&gt;– OSSpinLock：OSSpinLock 会一直轮询，等待时会消耗大量 CPU 资源，不适用于较长时间的任务&lt;br&gt;– pthread_mutex：C 语言下多线程加互斥锁的方式&lt;/p&gt;
&lt;p&gt;这里介绍了iOS中的几种锁，简单介绍了其中的用法，但仅凭阅读一篇博客并不能熟知iOS中锁的应用，具体的原理及使用还是要代码中实践才是。&lt;/p&gt;
&lt;h1 id=&quot;Day-24-iOS书写高质量代码之耦合的处理&quot;&gt;&lt;a href=&quot;#Day-24-iOS书写高质量代码之耦合的处理&quot; class=&quot;headerlink&quot; title=&quot;# Day 24 : iOS书写高质量代码之耦合的处理&quot;&gt;&lt;/a&gt;# Day 24 : &lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI5MjEzNzA1MA==&amp;amp;mid=2650264313&amp;amp;idx=1&amp;amp;sn=9dbb05dec78c0265efee16299ea95d22&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOS书写高质量代码之耦合的处理&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;&quot;&gt;MrPeak杂货铺&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;写高质量代码之耦合的处理的几种方式：&lt;br&gt;– .m引用：直接在 .m 文件创建对象调用方法&lt;br&gt;– .h Property：.h 文件中声明引用，依赖关系清晰&lt;br&gt;– .h ReadOnly Property：重写 setter 方法，对代码有更大的掌控能力，且避免轻易修改引用属性&lt;br&gt;– init 注入：对外就只提供一次机会（初始化init）来设置&lt;br&gt;– parameter 注入：将依赖类作为参数传入函数，耦合只发生在函数内部，一旦函数调用结束，就结束了依赖关系&lt;br&gt;– 单例引用：函数调用中使用单例，缺点也十分明显，应当慎用单例&lt;br&gt;– 继承：通过继承调用父类的方法，但确认父子关系也是麻烦的存在&lt;br&gt;– runtime依赖：耦合度非常之低，甚至可以说感觉不到，但是当依赖类的方法名发生改变时编译并不会提醒&lt;br&gt;– protocol依赖：好处在于他只规定了方法的声明，并不限定具体是那个类来实现它，给后期的维护留下更大的空间和可能性&lt;/p&gt;
&lt;p&gt;以上方法的优点和缺点都很明显，怎么使用还要靠业务和coder自己决定。&lt;/p&gt;
&lt;h1 id=&quot;Day-23-iOS关于时间的处理&quot;&gt;&lt;a href=&quot;#Day-23-iOS关于时间的处理&quot; class=&quot;headerlink&quot; title=&quot;# Day 23 : iOS关于时间的处理&quot;&gt;&lt;/a&gt;# Day 23 : &lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI5MjEzNzA1MA==&amp;amp;mid=2650264295&amp;amp;idx=1&amp;amp;sn=cdbe94a73be261aebf2afaba24320ef7&amp;amp;scene=19#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOS关于时间的处理&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;&quot;&gt;MrPeak杂货铺&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;– GMT：以格林尼治的时间作为公共时间，也就是我们所说的GMT时间（Greenwich Mean Time）。&lt;br&gt;– UTC：原子钟所反映的时间，也就是我们现在所使用的UTC（Coordinated Universal Time ）标准时间。&lt;br&gt;– NSDate：描述的是时间线上的一个绝对的值，和时区和文化无关，它参考的值是：以UTC为标准的，2001年一月一日00：00：00这一刻的时间绝对值。受手机系统时间控制的。也就是说，当你修改了手机上的时间显示，NSDate获取当前时间的输出也会随之改变。&lt;br&gt;&lt;figure class=&quot;highlight axapta&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;NSDate* &lt;span class=&quot;keyword&quot;&gt;date&lt;/span&gt; = [NSDate &lt;span class=&quot;keyword&quot;&gt;date&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;current date: %@&quot;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;date&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 绝对的UTC时间&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;current date interval: %f&quot;&lt;/span&gt;, [&lt;span class=&quot;keyword&quot;&gt;date&lt;/span&gt; timeIntervalSinceReferenceDate]); &lt;span class=&quot;comment&quot;&gt;// 返回的是距离参考时间的偏移量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;timeIntervalSince1970: %f&quot;&lt;/span&gt;, [&lt;span class=&quot;keyword&quot;&gt;date&lt;/span&gt; timeIntervalSince1970]); &lt;span class=&quot;comment&quot;&gt;// 返回Unix time&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;– CFAbsoluteTimeGetCurrent()：参考点是：以GMT为标准的，2001年一月一日00：00：00这一刻的时间绝对值。会跟着当前设备的系统时间一起变化，也可能会被用户修改。&lt;br&gt;– gettimeofday：获得的值是Unix time。Unix time是以UTC 1970年1月1号 00：00：00为基准时间，当前时间距离基准点偏移的秒数。受当前设备的系统时间影响。只不过是参考的时间基准点不一样而已。我们和服务器通讯的时候一般使用Unix time。&lt;br&gt;&lt;figure class=&quot;highlight rust&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;timeval&lt;/span&gt;&lt;/span&gt; now;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;timezone&lt;/span&gt;&lt;/span&gt; tz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gettimeofday(&amp;amp;now, &amp;amp;tz);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;gettimeofday: %ld&quot;&lt;/span&gt;, now.tv_sec); &lt;span class=&quot;comment&quot;&gt;// Unix time&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;在Mac的终端可以通过 &lt;code&gt;date -r 1481266031&lt;/code&gt; 命令转换成可阅读的时间。&lt;br&gt;– mach_absolute_time()：返回的是CPU已经运行的tick（CPU的时钟周期数）的数量。将这个tick数经过一定的转换就可以变成秒数，或者纳秒数，这样就和时间直接关联了。不会受系统时间影响，只受设备重启和休眠行为影响。&lt;br&gt;– CACurrentMediaTime()：就是将上面mach_absolute_time()的CPU tick数转化成秒数的结果。不会受系统时间影响，只受设备重启和休眠行为影响。&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; mediaTime = &lt;span class=&quot;built_in&quot;&gt;CACurrentMediaTime&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;CACurrentMediaTime: %f&quot;&lt;/span&gt;, mediaTime); &lt;span class=&quot;comment&quot;&gt;// 开机后设备一共运行了(设备休眠不统计在内)多少秒&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSTimeInterval&lt;/span&gt; systemUptime = [[&lt;span class=&quot;built_in&quot;&gt;NSProcessInfo&lt;/span&gt; processInfo] systemUptime];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;systemUptime: %f&quot;&lt;/span&gt;, systemUptime); &lt;span class=&quot;comment&quot;&gt;// 相同效果：开机后设备一共运行了(设备休眠不统计在内)多少秒&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;– sysctl：返回的值是上次设备重启的Unix time。会受系统时间影响，用户如果修改时间，值也会随着变化。&lt;br&gt;&lt;figure class=&quot;highlight arduino&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;sys/sysctl.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;)bootTime&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; MIB_SIZE 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mib[MIB_SIZE];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    size_t &lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; timeval  boottime;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mib[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = CTL_KERN;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mib[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = KERN_BOOTTIME;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(boottime);    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;if&lt;/span&gt; (sysctl(mib, MIB_SIZE, &amp;amp;boottime, &amp;amp;&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;, NULL, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) != &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; boottime.tv_sec;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;– 场景一，时间测量：CACurrentMediaTime与NSDate代码本身的损耗差异在几微秒，而我们做UI性能优化的维度在毫秒级别，几个微秒的差异完全不会影响我们最后的判断结果。所以使用NSDate做benchmark完全是可行的，以下是我常用的两个宏：&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; TICK   NSDate *startTime = [NSDate date]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; TOCK   NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;Time Cost: %f&quot;&lt;/span&gt;, -[startTime timeIntervalSinceNow])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;– 场景二：客户端和服务器之间的时间同步：（给出了一点技巧，参考原文）&lt;/p&gt;
&lt;h1 id=&quot;Day-22-正确使用-synchronized&quot;&gt;&lt;a href=&quot;#Day-22-正确使用-synchronized&quot; class=&quot;headerlink&quot; title=&quot;# Day 22 : 正确使用@synchronized()&quot;&gt;&lt;/a&gt;# Day 22 : &lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI5MjEzNzA1MA==&amp;amp;mid=2650264278&amp;amp;idx=1&amp;amp;sn=9353080a2fa5bb6f599faf00882e8176&amp;amp;scene=19#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;正确使用@synchronized()&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;&quot;&gt;MrPeak杂货铺&lt;/a&gt; 发布&lt;/p&gt;
&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@synchronized(obj)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//code&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;@synchronized原理&lt;br&gt;  – synchronized是使用的递归mutex来做同步。&lt;br&gt;  – @synchronized(nil)不起任何作用&lt;br&gt;  – synchronized中传入的object的内存地址，被用作key，通过hash map对应的一个系统维护的递归锁。&lt;/li&gt;
&lt;li&gt;@synchronized使用&lt;br&gt;  – 慎用@synchronized(self)，正确的做法是传入一个类内部维护的NSObject对象，而且这个对象是对外不可见的。&lt;br&gt;  – 精准的粒度控制，不同的 @synchronized (token) 使用不同的 token&lt;br&gt;  – 注意内部的函数调用，避免 {} 内部有其他隐蔽的函数调用拖慢锁的性能&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Day-21-iOS多线程到底不安全在哪里？&quot;&gt;&lt;a href=&quot;#Day-21-iOS多线程到底不安全在哪里？&quot; class=&quot;headerlink&quot; title=&quot;# Day 21 : iOS多线程到底不安全在哪里？&quot;&gt;&lt;/a&gt;# Day 21 : &lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI5MjEzNzA1MA==&amp;amp;mid=2650264274&amp;amp;idx=1&amp;amp;sn=2592a071424c4b217f33385115613988&amp;amp;scene=19#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOS多线程到底不安全在哪里？&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;&quot;&gt;MrPeak杂货铺&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;– &lt;code&gt;self.userName = @&amp;quot;peak&amp;quot;;&lt;/code&gt; 是在对指针本身进行赋值，而 &lt;code&gt;[self.userName rangeOfString:@&amp;quot;peak&amp;quot;];&lt;/code&gt; 是在访问指针指向的字符串所在的内存区域，这二者并不一样。&lt;br&gt;– 由于BOOL大小只有1个字节，64位系统的地址总线对于读写指令可以支持8个字节的长度，所以对于BOOL的读和写操作我们可以认为是原子的，所以当我们声明BOOL类型的property的时候，从原子性的角度看，使用atomic和nonatomic并没有实际上的区别（当然如果重载了getter方法就另当别论了）。&lt;br&gt;– atomic的作用只是给getter和setter加了个锁，atomic只能保证代码进入getter或者setter函数内部时是安全的，一旦出了getter和setter，多线程安全只能靠程序员自己保障了。&lt;br&gt;– iOS给代码加锁的方式有很多种，常用的有：&lt;code&gt;@synchronized(token)&lt;/code&gt;，&lt;code&gt;NSLock&lt;/code&gt;，&lt;code&gt;dispatch_semaphore_t&lt;/code&gt;，&lt;code&gt;OSSpinLock&lt;/code&gt;，这几种锁都可以带来原子性，性能的损耗依次更小。&lt;br&gt;– &lt;code&gt;_intA ++;&lt;/code&gt;（非原子性），&lt;code&gt;OSAtomicIncrement32(&amp;amp;(_intA));&lt;/code&gt;（原子性），Atomic Operation只能应用于32位或者64位的数据类型，在多线程使用NSString或者NSArray这类对象的场景，还是得使用锁。&lt;/p&gt;
&lt;h1 id=&quot;Day-20-与调试器共舞-LLDB-的华尔兹&quot;&gt;&lt;a href=&quot;#Day-20-与调试器共舞-LLDB-的华尔兹&quot; class=&quot;headerlink&quot; title=&quot;# Day 20 : 与调试器共舞 - LLDB 的华尔兹&quot;&gt;&lt;/a&gt;# Day 20 : &lt;a href=&quot;https://objccn.io/issue-19-2/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;与调试器共舞 - LLDB 的华尔兹&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;这是一篇有料有趣的文章，介绍了很多 LLDB 的命令和用法&lt;br&gt;&lt;figure class=&quot;highlight gams&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;help	&lt;span class=&quot;comment&quot;&gt;// 列举出所有的命令&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;print	&lt;span class=&quot;comment&quot;&gt;// prin，pri，p，但不能使用 pr，因为 LLDB 不能消除和 process 的歧义&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;expression &lt;span class=&quot;comment&quot;&gt;// 改变一个值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;po	&lt;span class=&quot;comment&quot;&gt;// e -0 --，打印对象&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p/x	&lt;span class=&quot;comment&quot;&gt;// 打印十六进制变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p/t	&lt;span class=&quot;comment&quot;&gt;// 打印二进制变量（two）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p/c 	&lt;span class=&quot;comment&quot;&gt;// 打印字符&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p/s 	&lt;span class=&quot;comment&quot;&gt;// 打印以空终止的字符串 (译者注：以 &#39;\0&#39; 结尾的字符串)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c	&lt;span class=&quot;comment&quot;&gt;// continue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;n	&lt;span class=&quot;comment&quot;&gt;// next，thread step-over 如果这行代码是一个函数调用，那么就不会跳进这个函数，而是会执行这个函数，然后继续。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s 	&lt;span class=&quot;comment&quot;&gt;// step，thread step in跳进一个函数调用来调试或者检查程序的执行情况。注意，当前行不是函数调用时，next 和 step 效果是一样的。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;breakpoint list	 &lt;span class=&quot;comment&quot;&gt;// br li，看到所有的断点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;breakpoint &lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt; -f &lt;span class=&quot;comment&quot;&gt;main.m -l 16&lt;/span&gt;	//&lt;span class=&quot;comment&quot;&gt; b main.m:16&lt;/span&gt;，创建断点&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;b &lt;span class=&quot;comment&quot;&gt;isEven&lt;/span&gt; //&lt;span class=&quot;comment&quot;&gt; br s -F isEven&lt;/span&gt;，在一个符号&lt;span class=&quot;comment&quot;&gt; (C&lt;/span&gt; 语言函数&lt;span class=&quot;comment&quot;&gt;)&lt;/span&gt; 上创建断点，而完全不用指定哪一行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建断点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;breakpoint &lt;span class=&quot;comment&quot;&gt;set -F&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;&quot;-[NSArray objectAtIndex:]&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;b &lt;span class=&quot;comment&quot;&gt;-[NSArray objectAtIndex:]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;breakpoint &lt;span class=&quot;comment&quot;&gt;set -F&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;&quot;+[NSSet setWithObject:]&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;b &lt;span class=&quot;comment&quot;&gt;+[NSSet setWithObject:]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;po &lt;span class=&quot;comment&quot;&gt;[[[UIApplication sharedApplication] keyWindow] recursiveDescription]&lt;/span&gt; // 可以看到整个层次&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;在 Xcode 的UI上创建符号断点：&lt;br&gt;你可以点击断点栏左侧的 + 按钮，选择 “Add Symbolic Breakpoint”，这时会出现一个弹出框，你可以在里面添加例如 -[NSArray objectAtIndex:] 这样的符号断点。这样每次调用这个函数的时候，程序都会停止，不管是你调用还是苹果调用。&lt;/p&gt;
&lt;p&gt;断点行为 (Action)：&lt;br&gt;右击任意断点选择“Edit Breakpoint”&lt;br&gt;– 添加 action，可以添加 Debugger Command，Shell Command，Log Message，Sound 等行为&lt;br&gt;– 选项： “Automatically continue after evaluation actions.” 选中它，调试器会运行你所有的命令，然后继续运行&lt;/p&gt;
&lt;p&gt;调试器可用命令总览参考：&lt;a href=&quot;http://lldb.llvm.org/lldb-gdb.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GDB to LLDB&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;Day-19-IP，TCP-和-HTTP&quot;&gt;&lt;a href=&quot;#Day-19-IP，TCP-和-HTTP&quot; class=&quot;headerlink&quot; title=&quot;# Day 19 : IP，TCP 和 HTTP&quot;&gt;&lt;/a&gt;# Day 19 : &lt;a href=&quot;https://objccn.io/issue-10-6/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;IP，TCP 和 HTTP&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;又温习一遍网络连接的知识。。。&lt;/p&gt;
&lt;h1 id=&quot;Day-18-基础集合类&quot;&gt;&lt;a href=&quot;#Day-18-基础集合类&quot; class=&quot;headerlink&quot; title=&quot;# Day 18 : 基础集合类&quot;&gt;&lt;/a&gt;# Day 18 : &lt;a href=&quot;https://objccn.io/issue-7-1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;基础集合类&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;这篇文章可真的是基础了，可能是今天时间太紧张没找到一篇比较有深度的文章，不过这篇文章从基础集合类（NSArray, NSSet, NSOrderedSet 和 NSDictionary）讲起，分别介绍了它们的方法，分析了性能，当是基础知识的一次复习吧。&lt;br&gt;文中总结列出了枚举 NSArray 和 NSDictionary 的几种方法，并分析了各自的性能，值得一看。因为都是一些基础集合类，就不做什么笔记了，各个类的方法到 Xcode 里都能轻易找着。&lt;/p&gt;
&lt;h1 id=&quot;Day-17-Build-过程&quot;&gt;&lt;a href=&quot;#Day-17-Build-过程&quot; class=&quot;headerlink&quot; title=&quot;# Day 17 : Build 过程&quot;&gt;&lt;/a&gt;# Day 17 : &lt;a href=&quot;https://objccn.io/issue-6-1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Build 过程&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;解密 Build 日志&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Build过程的控制&lt;br&gt;  – Build Phases：代表将代码转变为可执行文件的最高级别规则。&lt;br&gt;  – 定制Build Phases：可以在 build phases 中添加运行自定义脚本，就像CocoaPods使用的一样，来做额外的工作。&lt;br&gt;  – Build Rules：指定了不同的文件类型该如何编译。&lt;br&gt;  – Build Settings：可以配置每个任务（之前在 build log 输出中看到的任务）的详细内容。例如可以添加一个 “Run Script”：如果一个源文件超过指定行数，就发出警告。如下代码所示，设置的行数为 200：&lt;/p&gt;
  &lt;figure class=&quot;highlight nsis&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;find &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;SRCROOT&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt; \( -name &lt;span class=&quot;string&quot;&gt;&quot;*.h&quot;&lt;/span&gt; -or -name &lt;span class=&quot;string&quot;&gt;&quot;*.m&quot;&lt;/span&gt; \) -print0 | xargs -&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; wc -l | awk &#39;&lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt; &amp;gt; &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt; != &lt;span class=&quot;string&quot;&gt;&quot;total&quot;&lt;/span&gt; &amp;#123; &lt;span class=&quot;literal&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;:1: warning: file more than 200 lines&quot;&lt;/span&gt; &amp;#125;&#39;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;工程文件（.pbxproj）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Day-16-自定义控件&quot;&gt;&lt;a href=&quot;#Day-16-自定义控件&quot; class=&quot;headerlink&quot; title=&quot;# Day 16 : 自定义控件&quot;&gt;&lt;/a&gt;# Day 16 : &lt;a href=&quot;https://objccn.io/issue-3-4/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;自定义控件&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;该篇文章比较基础，介绍了自定义控件用到的 UIView 基类、渲染、交互、本地化及测试：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;视图层次概览&lt;br&gt;  – reponders (响应者)：UIView 的父类，能够处理触摸、手势、远程控制等事件。&lt;br&gt;  – views (视图)：视图的区域是由它的 frame 定义的。实际上 frame 是一个派生属性，是由 center 和 bounds 合成而来。&lt;br&gt;  – controls (控件)：建立在视图上，增加了更多的交互支持。最重要的是，它增加了 target / action 模式。&lt;/li&gt;
&lt;li&gt;渲染&lt;br&gt;  – 尽量避免 drawRect:，使用现有的视图构建自定义视图。如果重写 drawRect:，确保检查内容模式。默认的模式是将内容缩放以填充视图的范围，这在当视图的 frame 改变时并不会重新绘制。&lt;br&gt;  – 处理图片时，你也可以让 GPU 为你工作来代替使用 Core Graphics。使用 Core Image，你不必用 CPU 做任何的工作就可以在图片上建立复杂的效果。&lt;/li&gt;
&lt;li&gt;自定义交互&lt;br&gt;  – 使用 Target-Action&lt;br&gt;  – 使用代理&lt;br&gt;  – 使用 Block&lt;br&gt;  – 使用 KVO&lt;br&gt;  – 使用通知&lt;/li&gt;
&lt;li&gt;辅助功能 (Accessibility)&lt;br&gt;  – 本地化：使用 NSLocalizedString 本地化字符串。&lt;br&gt;  – 测试：可以使用 UIAutomation 或者其它基于它的工具。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Day-15-底层并发-API&quot;&gt;&lt;a href=&quot;#Day-15-底层并发-API&quot; class=&quot;headerlink&quot; title=&quot;# Day 15 : 底层并发 API&quot;&gt;&lt;/a&gt;# Day 15 : &lt;a href=&quot;https://objccn.io/issue-2-3/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;底层并发 API&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;该篇文章并非是专门介绍 GCD(Grand Central Dispatch) 使用的，但从分析及解决并发问题的角度出发介绍了很多 GCD 的用法&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;从前…：&lt;code&gt;dispatch_once&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;延后执行：&lt;code&gt;dispatch_after&lt;/code&gt;&lt;br&gt;  – 队列&lt;br&gt;  – 目标队列：为一个类创建它自己的队列而不是使用全局的队列，这种方式可以设置队列的名字，在 Xcode 的 Debug Navigator 中可以看到所有的队列名字，(lldb) thread list 命令会在控制台打印出所有队列的名字。&lt;br&gt;  – 优先级&lt;/li&gt;
&lt;li&gt;隔离&lt;br&gt;  – 资源保护&lt;br&gt;  – 单一资源的多读单写：&lt;code&gt;dispatch_barrier_async&lt;/code&gt;&lt;br&gt;  – 锁竞争&lt;br&gt;  – 全都使用异步分发：&lt;code&gt;dispatch_async()&lt;/code&gt;&lt;br&gt;  – 如何写出好的异步 API&lt;/li&gt;
&lt;li&gt;迭代执行：&lt;code&gt;dispatch_apply&lt;/code&gt;&lt;br&gt;  – 组：&lt;code&gt;dispatch_group_t&lt;/code&gt;&lt;br&gt;  – 对现有API使用 dispatch_group_t&lt;/li&gt;
&lt;li&gt;事件源：&lt;code&gt;dispatch_source_t&lt;/code&gt;&lt;br&gt;  – 监视进程&lt;br&gt;  – 监视文件&lt;br&gt;  – 定时器&lt;br&gt;  – 取消&lt;/li&gt;
&lt;li&gt;输入输出&lt;br&gt;  – GCD 和缓冲区：&lt;code&gt;dispatch_data_t&lt;/code&gt;&lt;br&gt;  – 读和写：&lt;code&gt;dispatch_io_create_with_path&lt;/code&gt;、&lt;code&gt;dispatch_io_read&lt;/code&gt;、&lt;code&gt;dispatch_io_write&lt;/code&gt; 和 &lt;code&gt;dispatch_io_close&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;基准测试：&lt;code&gt;uint64_t dispatch_benchmark(size_t count, void (^block)(void));&lt;/code&gt;能够测量给定的代码执行的平均的纳秒数&lt;/li&gt;
&lt;li&gt;原子操作&lt;br&gt;  – 计数器&lt;br&gt;  – 比较和交换&lt;br&gt;  – 原子队列&lt;br&gt;  – 自旋锁&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Day-14-常见的后台实践&quot;&gt;&lt;a href=&quot;#Day-14-常见的后台实践&quot; class=&quot;headerlink&quot; title=&quot;# Day 14 : 常见的后台实践&quot;&gt;&lt;/a&gt;# Day 14 : &lt;a href=&quot;https://objccn.io/issue-2-2/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;常见的后台实践&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;作者从以下方面介绍了将耗时操作放进后台执行的策略：&lt;br&gt;– 后台的 Core Data&lt;br&gt;– 更新 Main Context&lt;br&gt;– 后台 UI 代码&lt;br&gt;– 后台绘制：如果确定 drawRect: 是应用的性能瓶颈，把 drawRect:中的代码放到后台操作中去。然后将原本打算绘制的视图用一个 image view 来替换，等到操作执行完后再去更新。在绘制的方法中，使用 UIGraphicsBeginImageContextWithOptions 来取代 UIGraphicsGetCurrentContext ：&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIGraphicsBeginImageContextWithOptions&lt;/span&gt;(size, &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// drawing code here&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *i = &lt;span class=&quot;built_in&quot;&gt;UIGraphicsGetImageFromCurrentImageContext&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIGraphicsEndImageContext&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;通过在第三个参数中传入 0 ，设备的主屏幕的 scale 将被自动传入，这将使图片在普通设备和 retina 屏幕上都有良好的表现。&lt;/p&gt;
&lt;p&gt;– 异步网络请求处理：像 AFNetworking 这样的框架：建立一个独立的线程，为建立的线程设置自己的 run loop，然后在其中调度 URL 连接。&lt;br&gt;– 进阶：后台文件 I/O：对于不方便一次性读入内存的大文件可以使用异步处理文件的 NSInputStream&lt;br&gt;。。。。。。&lt;/p&gt;
&lt;h1 id=&quot;Day-13-并发编程：API-及挑战&quot;&gt;&lt;a href=&quot;#Day-13-并发编程：API-及挑战&quot; class=&quot;headerlink&quot; title=&quot;# Day 13 : 并发编程：API 及挑战&quot;&gt;&lt;/a&gt;# Day 13 : &lt;a href=&quot;https://objccn.io/issue-2-1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;并发编程：API 及挑战&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、OS X 和 iOS 中的并发编程&lt;br&gt;– 线程&lt;br&gt;可以使用 Instruments 中的 CPU strategy view 来得知代码是如何在多核 CPU 中调度执行的。&lt;br&gt;– Grand Central Dispatch&lt;br&gt;GCD 公开有 5 个不同的队列：运行在主线程中的 main queue，3 个不同优先级的后台队列，以及一个优先级更低的后台队列（用于 I/O）。 另外，开发者可以创建自定义队列：串行或者并行队列。自定义队列非常强大，在自定义队列中被调度的所有 block 最终都将被放入到系统的全局队列中和线程池中。&lt;br&gt;强烈建议在绝大多数情况下使用默认的优先级队列，避免在不同优先级的队列中调度访问共享资源的任务而产生不可预期的行为，比如低优先级的任务阻塞了高优先级任务而造成程序的完全挂起。&lt;br&gt;– Operation Queues&lt;br&gt;NSOperationQueue 有两种不同类型的队列：主队列和自定义队列。主队列运行在主线程之上，而自定义队列在后台执行。你可以通过重写 main 或者 start 方法来定义自己的 operations。&lt;br&gt;你可以通过 maxConcurrentOperationCount 属性来控制一个特定队列中可以有多少个操作参与并发执行，还可以在 operation 之间指定依赖关系。&lt;br&gt;– Run Loops&lt;br&gt;主线程一般来说都已经配置好了 main run loop。然而其他线程默认情况下都没有设置 run loop。你也可以自行为其他线程设置 run loop ，但是一般来说我们很少需要这么做。大多数时间使用 main run loop 会容易得多。&lt;/p&gt;
&lt;p&gt;##2、并发编程中面临的挑战&lt;br&gt;– 资源共享&lt;br&gt;– 互斥锁&lt;br&gt;– 死锁&lt;br&gt;– 资源饥饿（Starvation）&lt;br&gt;– 优先级反转&lt;/p&gt;
&lt;p&gt;##3、总结&lt;br&gt;我们建议采纳的安全模式是这样的：从主线程中提取出要使用到的数据，并利用一个操作队列在后台处理相关的数据，最后回到主队列中来发送你在后台队列中得到的结果。使用这种方式，你不需要自己做任何锁操作，这也就大大减少了犯错误的几率。&lt;/p&gt;
&lt;h1 id=&quot;Day-12-理解-Scroll-Views&quot;&gt;&lt;a href=&quot;#Day-12-理解-Scroll-Views&quot; class=&quot;headerlink&quot; title=&quot;# Day 12 : 理解 Scroll Views&quot;&gt;&lt;/a&gt;# Day 12 : &lt;a href=&quot;https://objccn.io/issue-3-2/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;理解 Scroll Views&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;该篇文章比较简洁，从 UIView 的光栅化和组合说起，简单明了的介绍了 Scroll View 的实现思路。&lt;br&gt;并介绍了 Scroll View 的：&lt;br&gt;– Content Offset：相当于更改 Superview.bounds.origin&lt;br&gt;– Content Size：可滚动区域&lt;br&gt;– Content Insets：可以改变 content offset 的最大和最小值，这样便可以滚动出可滚动区域&lt;/p&gt;
&lt;p&gt;或许可以应用在有键盘弹出的页面，比如登录页面，弹出键盘输入用户名密码时会遮挡屏幕下半部的视图，可以采用 Scroll View 的滚动特性来解决这一尴尬，恰巧今天碰见 Medium 的登录页面貌似就是这么设计的。&lt;/p&gt;
&lt;h1 id=&quot;Day-11-绘制像素到屏幕上&quot;&gt;&lt;a href=&quot;#Day-11-绘制像素到屏幕上&quot; class=&quot;headerlink&quot; title=&quot;# Day 11 : 绘制像素到屏幕上&quot;&gt;&lt;/a&gt;# Day 11 : &lt;a href=&quot;https://objccn.io/issue-3-1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;绘制像素到屏幕上&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://objccn.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ObjC 中国&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;文章知识比较碎却又是全集中在屏幕绘制这一块，许多知识点都基于原理特别受用。以下是文章中提及的知识点（目录）：&lt;br&gt;– 图形堆栈&lt;br&gt;– 软件组成：Display &amp;lt;-&amp;gt; GPU &amp;lt;-&amp;gt; GPU Driver &amp;lt;-&amp;gt; OpenGL(Open Graphics Library) &amp;lt;-&amp;gt; Core Animation/Core Graphics/Core Image &amp;lt;-&amp;gt; app&lt;br&gt;– 硬件参与者&lt;br&gt;– 合成：对于屏幕上的每一个像素，GPU 需要算出怎么混合这些纹理来得到像素 RGB 的值，并最终显示在屏幕上。所以减少视图层级可以有效提高性能，因为 GPU 需要将重叠的视图计算合成在一起（将纹理中的一个像素合成到另一个纹理的像素上）。&lt;br&gt;– 不透明 VS 透明：当源纹理是完全不透明的时候，目标像素就等于源纹理。这可以省下 GPU 很大的工作量，这样只需简单的拷贝源纹理而不需要合成所有的像素值。CALayer 有一个叫做 opaque 的属性，如果这个属性为 YES，GPU 将不会做任何合成，而是简单从这个层拷贝，不需要考虑它下方的任何东西(因为都被它遮挡住了)，这节省了 GPU 相当大的工作量。Instruments 中 color blended layers 选项中所涉及的，允许你看到哪一个 layers(纹理) 被标注为透明的。&lt;br&gt;– 像素对齐 VS 不重合在一起：「缩放」和「纹理的起点不在一个像素的边界上」会导致一个 layer 上所有的像素和屏幕上的像素不对齐，GPU 需要再做额外的计算。它需要将源纹理上多个像素混合起来，生成一个用来合成的值。&lt;br&gt;– Masks(蒙板)：mask 是一个拥有 alpha 值的位图，当像素要和它下面包含的像素合并之前都会把 mask 应用到图层的像素上去。当你要设置一个图层的圆角半径时，你可以有效的在图层上面设置一个 mask。&lt;br&gt;– 离屏渲染(Offscreen Rendering)：为 layer 使用蒙板、设置圆角半径、产生阴影会造成屏幕外渲染。Instrument 的 Core Animation 工具有一个叫做 Color Offscreen-Rendered Yellow 的选项，它会将已经被渲染到屏幕外缓冲区的区域标注为黄色。同时记得检查 Color Hits Green and Misses Red 选项。绿色代表无论何时一个屏幕外缓冲区被复用，而红色代表当缓冲区被重新创建。&lt;br&gt;– 更多的关于合成&lt;br&gt;– OS X&lt;br&gt;– Core Animation OpenGL ES&lt;br&gt;– CPU 限制 VS GPU 限制：你可以使用 OpenGL ES Driver instrument，点击上面那个小的 i 按钮，配置一下，同时注意勾选 Device Utilization %。现在，当你运行你的 app 时，你可以看到你 GPU 的负荷。&lt;br&gt;– Core Graphics / Quartz 2D&lt;br&gt;– CGLayer&lt;br&gt;– 像素&lt;br&gt;– 默认的像素布局&lt;br&gt;– 深奥的布局&lt;br&gt;– 二维数据&lt;br&gt;– YCbCr&lt;br&gt;– 图片格式&lt;br&gt;– JPEG&lt;br&gt;– PNG&lt;br&gt;– 挑选一个格式&lt;br&gt;– UIKit 和 Pixels&lt;br&gt;– With –drawRect:&lt;br&gt;– 不使用 -drawRect:&lt;br&gt;– 实现-drawRect: 还是不实现 -drawRect:&lt;br&gt;– 单一颜色&lt;br&gt;– 可变尺寸的图像&lt;br&gt;– 并发绘图&lt;br&gt;– CALayer&lt;br&gt;– 自定义绘制的图层&lt;br&gt;– 形状和文本图层&lt;br&gt;– 异步绘图&lt;/p&gt;
&lt;h1 id=&quot;Day-10-谈谈-iOS-中图片的解压缩&quot;&gt;&lt;a href=&quot;#Day-10-谈谈-iOS-中图片的解压缩&quot; class=&quot;headerlink&quot; title=&quot;# Day 10 : 谈谈 iOS 中图片的解压缩&quot;&gt;&lt;/a&gt;# Day 10 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2017/02/20/talking-about-the-decompression-of-the-image-in-ios/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;谈谈 iOS 中图片的解压缩&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、图片加载&lt;br&gt;图片加载的工作流参考 &lt;a href=&quot;https://github.com/path/FastImageCache#the-problem&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;FastImageCache 在 GitHub&lt;/a&gt; 上的 README.md。&lt;br&gt;图片在渲染到 UIImageView 的图层之前需要将其解压缩，而对图片解压缩默认是在主线程完成的，并且是一个非常耗时的操作，在对性能要求比较高时可以在图片渲染到屏幕之前在子线程提前对图片进行强制解压缩，强制解压缩的原理就是对图片进行重新绘制，得到一张新的解压缩后的位图。其中，用到的最核心的函数是 CGBitmapContextCreate ：&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CG_EXTERN CGContextRef __&lt;span class=&quot;function&quot;&gt;nullable &lt;span class=&quot;title&quot;&gt;CGBitmapContextCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; * __nullable data,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; width, &lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; height, &lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; bitsPerComponent, &lt;span class=&quot;keyword&quot;&gt;size_t&lt;/span&gt; bytesPerRow,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    CGColorSpaceRef cg_nullable space, &lt;span class=&quot;keyword&quot;&gt;uint32_t&lt;/span&gt; bitmapInfo)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;title&quot;&gt;CG_AVAILABLE_STARTING&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(__MAC_10_0, __IPHONE_2_0)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;其中：&lt;br&gt;– data：如果不为 NULL ，那么它应该指向一块大小至少为 bytesPerRow &lt;em&gt; height 字节的内存；如果 为 NULL ，那么系统就会为我们自动分配和释放所需的内存，所以一般指定 NULL 即可；&lt;br&gt;– width 和 height：位图的宽度和高度，分别赋值为图片的像素宽度和像素高度即可；&lt;br&gt;– bitsPerComponent：像素的每个颜色分量使用的 bit 数，在 RGB 颜色空间下指定 8 即可；&lt;br&gt;– bytesPerRow：位图的每一行使用的字节数，大小至少为 width &lt;/em&gt; bytes per pixel 字节。有意思的是，当我们指定 0 时，系统不仅会为我们自动计算，而且还会进行 cache line alignment 的优化；&lt;br&gt;– space：就是我们前面提到的颜色空间，一般使用 RGB 即可；&lt;br&gt;– bitmapInfo：就是我们前面提到的位图的布局信息。&lt;br&gt;涉及到的概念：&lt;br&gt;Pixel Format（像素格式）、Color and Color Spaces（颜色空间）、Color Spaces and Bitmap Layout（位图布局）&lt;/p&gt;
&lt;p&gt;##2、开源库&lt;br&gt;贴出了 YYKit 中存在于 YYImageCoder 类中用于解压缩图片的核心代码的函数 YYCGImageCreateDecodedCopy。讲解代码步骤并对 YYKit，SDWebImage，FLAnimatedImage 做了性能比对。&lt;/p&gt;
&lt;h1 id=&quot;Day-9-Objective-C-Fast-Enumeration-的实现原理&quot;&gt;&lt;a href=&quot;#Day-9-Objective-C-Fast-Enumeration-的实现原理&quot; class=&quot;headerlink&quot; title=&quot;# Day 9 : Objective-C Fast Enumeration 的实现原理&quot;&gt;&lt;/a&gt;# Day 9 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2016/06/20/objective-c-fast-enumeration-implementation-principle/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C Fast Enumeration 的实现原理&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、解析 NSFastEnumeration 协议&lt;br&gt;&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Returns &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;reference&lt;/span&gt; a C array &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; objects &lt;span class=&quot;keyword&quot;&gt;over&lt;/span&gt; which &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; sender should iterate, &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;return&lt;/span&gt; value &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; objects &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; array.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; @param state  Context information &lt;span class=&quot;keyword&quot;&gt;that&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; used &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; enumeration &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; addition &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; other possibilities, ensure &lt;span class=&quot;keyword&quot;&gt;that&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; collection has &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; been mutated.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; @param buffer A C array &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; objects &lt;span class=&quot;keyword&quot;&gt;over&lt;/span&gt; which &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; sender &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; iterate.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; @param len    The maximum &lt;span class=&quot;built_in&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; objects &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; stackbuf.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; @discussion The state structure &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; assumed &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; be &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; stack &lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt; memory, so you can recast &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; passed &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; state structure &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; one more suitable &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; your iteration.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; @&lt;span class=&quot;literal&quot;&gt;return&lt;/span&gt; The &lt;span class=&quot;built_in&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; objects returned &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; stackbuf. Returns &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; when &lt;span class=&quot;keyword&quot;&gt;the&lt;/span&gt; iteration &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; finished.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                  objects:(&lt;span class=&quot;built_in&quot;&gt;id&lt;/span&gt; __unsafe_unretained [])stackbuf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                    &lt;span class=&quot;built_in&quot;&gt;count&lt;/span&gt;:(NSUInteger)len&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;结构体 NSFastEnumerationState 的定义:&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; state;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; __unsafe_unretained _Nullable * _Nullable itemsPtr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; * _Nullable mutationsPtr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; extra[&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;built_in&quot;&gt;NSFastEnumerationState&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;##2、快速枚举的内部实现&lt;br&gt;通过 &lt;code&gt;clang -rewrite-objc main.m&lt;/code&gt; 命令重写了一段 OC 的快速枚举代码，详尽的注释介绍了快速枚举的内部实现，及在 &lt;code&gt;for/in&lt;/code&gt; 语句中利用 goto 实现 &lt;code&gt;continue&lt;/code&gt; 和 &lt;code&gt;break&lt;/code&gt; 命令的 c++ 代码。&lt;/p&gt;
&lt;p&gt;##3、实现 NSFastEnumeration 协议&lt;br&gt;作者给出了一个实现 &lt;code&gt;- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(id __unsafe_unretained [])stackbuf count:(NSUInteger)len;&lt;/code&gt; 的例子&lt;/p&gt;
&lt;p&gt;##3、参考链接&lt;br&gt;在文末的参考链接中有文 &lt;a href=&quot;https://www.mikeash.com/pyblog/friday-qa-2010-04-16-implementing-fast-enumeration.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Friday Q&amp;amp;A 2010-04-16: Implementing Fast Enumeration&lt;/a&gt; 同样介绍了快速枚举的实现。&lt;/p&gt;
&lt;h1 id=&quot;Day-8-iOS-并发编程之-Operation-Queues&quot;&gt;&lt;a href=&quot;#Day-8-iOS-并发编程之-Operation-Queues&quot; class=&quot;headerlink&quot; title=&quot;# Day 8 : iOS 并发编程之 Operation Queues&quot;&gt;&lt;/a&gt;# Day 8 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/07/29/ios-concurrency-programming-operation-queues/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOS 并发编程之 Operation Queues&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;这篇文章比较长，且相当详细，很多也是 Operation Queues 的基础用法，所以这里就只将文章目录记下来好了，下次复习（的话）先来过一遍目录，记不起的再去查阅文章吧。&lt;br&gt;该篇文章详细介绍了 Operation Queues 的一系列使用，并且 SDWebImage 也用到了 Operation Queues，对于不久后去阅读 SDWebImage 源码想必会很有帮助。&lt;/p&gt;
&lt;p&gt;##1、基本概念&lt;br&gt;– 进程（process）、线程（thread）、任务（task）&lt;br&gt;– 串行 vs. 并发&lt;br&gt;– 同步 vs. 异步&lt;br&gt;– 队列 vs. 线程的概念。&lt;/p&gt;
&lt;p&gt;##2、iOS 的并发编程模型    &lt;/p&gt;
&lt;p&gt;##3、Operation Queues vs. Grand Central Dispatch (GCD)&lt;/p&gt;
&lt;p&gt;##4、关于 Operation 对象&lt;br&gt;– 并发 vs. 非并发 Operation&lt;br&gt;– 创建 NSInvocationOperation 对象&lt;br&gt;– 创建 NSBlockOperation 对象&lt;/p&gt;
&lt;p&gt;##5、自定义 Operation 对象&lt;br&gt;– 执行主任务&lt;br&gt;– 响应取消事件&lt;br&gt;– 配置并发执行的 Operation&lt;br&gt;– 维护 KVO 通知&lt;/p&gt;
&lt;p&gt;##6、定制 Operation 对象的执行行为&lt;br&gt;– 配置依赖关系&lt;br&gt;– 修改 Operation 在队列中的优先级&lt;br&gt;– 修改 Operation 执行任务线程的优先级&lt;br&gt;– 设置 Completion Block&lt;/p&gt;
&lt;p&gt;##7、执行 Operation 对象&lt;br&gt;– 添加 Operation 到 Operation Queue 中&lt;br&gt;– 手动执行 Operation&lt;br&gt;– 取消 Operation&lt;br&gt;– 等待 Operation 执行完成&lt;br&gt;– 暂停和恢复 Operation Queue&lt;/p&gt;
&lt;p&gt;##8、总结&lt;/p&gt;
&lt;h1 id=&quot;Day-7-Objective-C-Method-Swizzling-的最佳实践&quot;&gt;&lt;a href=&quot;#Day-7-Objective-C-Method-Swizzling-的最佳实践&quot; class=&quot;headerlink&quot; title=&quot;# Day 7 : Objective-C Method Swizzling 的最佳实践&quot;&gt;&lt;/a&gt;# Day 7 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/06/14/objective-c-method-swizzling-best-practice/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C Method Swizzling 的最佳实践&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、Method 的数据结构：&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_t&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SEL name; &lt;span class=&quot;comment&quot;&gt;// 方法的名称，用于唯一标识某个方法，比如 @selector(viewWillAppear:)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *types; &lt;span class=&quot;comment&quot;&gt;// 方法的返回值和参数类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    IMP imp; &lt;span class=&quot;comment&quot;&gt;// 函数指针，指向方法的实现&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; SortBySELAddress :&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::binary_function&amp;lt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_t&lt;/span&gt;&amp;amp;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_t&lt;/span&gt;&amp;amp;, &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_t&lt;/span&gt;&amp;amp; lhs,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                         &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_t&lt;/span&gt;&amp;amp; rhs)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&amp;#123; &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; lhs.name &amp;lt; rhs.name; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;; &lt;span class=&quot;comment&quot;&gt;// 一个根据 name 的地址对方法进行排序的函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;– 实例方法保存在类对象中，类方法保存在元类对象中。（参见&lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/04/25/objective-c-object-model/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C 对象模型&lt;/a&gt;）&lt;br&gt;– 原则上，方法的名称 name 和方法的实现 imp 是一一对应的，而 Method Swizzling 的原理就是动态地改变它们的对应关系，以达到替换方法实现的目的。&lt;/p&gt;
&lt;p&gt;##2、Method Swizzling 的最佳实践&lt;br&gt;+load 和 +initialize 是 Objective-C runtime 会自动调用的两个类方法。&lt;br&gt;– +initialize 方法以懒加载的方式被调用的，有可能不会被调用，而 +load 方法是在类被加载的时候调用。&lt;br&gt;– Objective-C runtime 自动调用 +load 方法时，分类中的 +load 方法并不会对主类中的 +load 方法造成覆盖&lt;br&gt;综上，分类中的 +load 方法是实现 Method Swizzling 逻辑的最佳“场所”&lt;br&gt;– 应当使用 dispatch_once 保证 Method Swizzling 只被调用一次&lt;/p&gt;
&lt;p&gt;文章示例代码：&lt;br&gt;– 主类本身有实现需要替换的方法，即返回 NO 时，直接交换两个方法的实现；&lt;br&gt;– 主类本身没有实现需要替换的方法，而是继承了父类的实现，即返回 YES 时，将父类的实现替换到我们自定义的 mrc_viewWillAppear 方法中。&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@implementation&lt;/span&gt; UIViewController (MRCUMAnalytics)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (void)load &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    static dispatch_once_t onceToken;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;selector-tag&quot;&gt;dispatch_once&lt;/span&gt;(&amp;amp;onceToken, ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Class class = &lt;span class=&quot;selector-attr&quot;&gt;[self class]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SEL originalSelector = &lt;span class=&quot;variable&quot;&gt;@selector&lt;/span&gt;(&lt;span class=&quot;attribute&quot;&gt;viewWillAppear&lt;/span&gt;:);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SEL swizzledSelector = &lt;span class=&quot;variable&quot;&gt;@selector&lt;/span&gt;(&lt;span class=&quot;attribute&quot;&gt;mrc_viewWillAppear&lt;/span&gt;:);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Method originalMethod = class_getInstanceMethod(class, originalSelector);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Method swizzledMethod = class_getInstanceMethod(class, swizzledSelector);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        BOOL success = class_addMethod(class, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;selector-tag&quot;&gt;if&lt;/span&gt; (success) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            class_replaceMethod(class, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            method_exchangeImplementations(originalMethod, swizzledMethod);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-id&quot;&gt;#pragma&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;mark&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;Swizzling&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;-&lt;/span&gt; (void)&lt;span class=&quot;selector-tag&quot;&gt;mrc_viewWillAppear&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:(BOOL)animated&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;selector-attr&quot;&gt;[self mrc_viewWillAppear:animated]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;selector-attr&quot;&gt;[MobClick beginLogPageView:NSStringFromClass([self class]&lt;/span&gt;)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;Day-6-Objective-C-Autorelease-Pool-的实现原理&quot;&gt;&lt;a href=&quot;#Day-6-Objective-C-Autorelease-Pool-的实现原理&quot; class=&quot;headerlink&quot; title=&quot;# Day 6 : Objective-C Autorelease Pool 的实现原理&quot;&gt;&lt;/a&gt;# Day 6 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/05/31/objective-c-autorelease-pool-implementation-principle/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C Autorelease Pool 的实现原理&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、autoreleased 对象的释放时机&lt;br&gt;对象 A 被创建时引用计数为 1，当有变量 B 指向这个对象时，引用计数 +1，变量 B 离开作用域后为 nil，对象 A 的引用计数 -1，当对象 A 所在的 autoreleasepool 被 drain ，其中的 autoreleased 对象被 release ，对象 A 的引用计数 -1。当对象 A 的引用计数为 0 时随即被释放。&lt;/p&gt;
&lt;p&gt;其中提到了 &lt;code&gt;__weak&lt;/code&gt; 的两个特性：&lt;br&gt;– &lt;code&gt;__weak&lt;/code&gt; 变量不会影响所指向对象的生命周期&lt;br&gt;– &lt;code&gt;__weak&lt;/code&gt; 变量所指向的对象被释放时，&lt;code&gt;__weak&lt;/code&gt; 变量的值会被置为 &lt;code&gt;nil&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;##2、AutoreleasePoolPage&lt;br&gt;– 介绍了 AutoreleasePoolPage 的内存结构&lt;br&gt;– Autorelease Pool Blocks 通过 &lt;code&gt;clang -rewrite-objc&lt;/code&gt; 改写成 c++ 代码的实现，和其中的 push 操作、autorelease 操作、pop 操作&lt;/p&gt;
&lt;p&gt;##3、NSThread、NSRunLoop 和 NSAutoreleasePool&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Each NSThread object, including the application’s main thread, has an NSRunLoop object automatically created for it as needed.&lt;/p&gt;
&lt;p&gt;The Application Kit creates an autorelease pool on the main thread at the beginning of every cycle of the event loop, and drains it at the end, thereby releasing any autoreleased objects generated while processing an event.&lt;/p&gt;
&lt;p&gt;Each thread (including the main thread) maintains its own stack of NSAutoreleasePool objects.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;Day-5-Objective-C-Associated-Objects-的实现原理&quot;&gt;&lt;a href=&quot;#Day-5-Objective-C-Associated-Objects-的实现原理&quot; class=&quot;headerlink&quot; title=&quot;# Day 5 : Objective-C Associated Objects 的实现原理&quot;&gt;&lt;/a&gt;# Day 5 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/06/26/objective-c-associated-objects-implementation-principle/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C Associated Objects 的实现原理&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、相关函数&lt;br&gt;在 Objective-C 中可以通过 Category 给一个现有的类添加属性，但是却不能添加实例变量，我们可以通过 Associated Objects 来弥补这一不足&lt;br&gt;&lt;figure class=&quot;highlight cs&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;objc_setAssociatedObject&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;id &lt;span class=&quot;keyword&quot;&gt;object&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *key, id &lt;span class=&quot;keyword&quot;&gt;value&lt;/span&gt;, objc_AssociationPolicy policy&lt;/span&gt;)&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 用于给对象添加关联对象，传入 nil 则可以移除已有的关联对象&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;id &lt;span class=&quot;title&quot;&gt;objc_getAssociatedObject&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;id &lt;span class=&quot;keyword&quot;&gt;object&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *key&lt;/span&gt;)&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 用于获取关联对象&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;objc_removeAssociatedObjects&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;id &lt;span class=&quot;keyword&quot;&gt;object&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 用于移除一个对象的所有关联对象&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;##2、key 值&lt;br&gt;上边前两个函数需要传入一个 &lt;code&gt;key&lt;/code&gt; 作为唯一变量，作者推荐 &lt;code&gt;selector&lt;/code&gt; ，使用 &lt;code&gt;getter&lt;/code&gt; 方法的名称作为 key 值。这样就省掉了一个变量名，解决了给这个 key 命名的烦恼。&lt;/p&gt;
&lt;p&gt;##3、关联策略  &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;关联策略&lt;/th&gt;
&lt;th&gt;等价属性&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OBJC_ASSOCIATION_ASSIGN&lt;/td&gt;
&lt;td&gt;@property (assign) or @property (unsafe_unretained)&lt;/td&gt;
&lt;td&gt;弱引用关联对象&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OBJC_ASSOCIATION_RETAIN_NONATOMIC&lt;/td&gt;
&lt;td&gt;@property (strong, nonatomic)&lt;/td&gt;
&lt;td&gt;强引用关联对象，且为非原子操作&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OBJC_ASSOCIATION_COPY_NONATOMIC&lt;/td&gt;
&lt;td&gt;@property (copy, nonatomic)&lt;/td&gt;
&lt;td&gt;复制关联对象，且为非原子操作&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OBJC_ASSOCIATION_RETAIN&lt;/td&gt;
&lt;td&gt;@property (strong, atomic)&lt;/td&gt;
&lt;td&gt;强引用关联对象，且为原子操作&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OBJC_ASSOCIATION_COPY&lt;/td&gt;
&lt;td&gt;@property (copy, atomic)&lt;/td&gt;
&lt;td&gt;复制关联对象，且为原子操作&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;##4、实现 getter setter 方法&lt;br&gt;ViewController+AssociatedObjects.h：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@interface&lt;/span&gt; ViewController (AssociatedObjects)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@property&lt;/span&gt; (nonatomic, copy) NSString *associatedObject_copy;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ViewController+AssociatedObjects.m：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@implementation&lt;/span&gt; ViewController (AssociatedObjects)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (NSString *)associatedObject_copy &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return objc_getAssociatedObject(self, _cmd);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (void)&lt;span class=&quot;attribute&quot;&gt;setAssociatedObject_copy&lt;/span&gt;:(NSString *)associatedObject_copy &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    objc_setAssociatedObject(self, &lt;span class=&quot;variable&quot;&gt;@selector&lt;/span&gt;(associatedObject_copy), associatedObject_copy, OBJC_ASSOCIATION_COPY_NONATOMIC);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;##5、总结&lt;br&gt;– 关联对象与被关联对象本身的存储并没有直接的关系，它是存储在单独的哈希表中的；&lt;br&gt;– 关联对象的五种关联策略与属性的限定符非常类似，在绝大多数情况下，我们都会使用 OBJC_ASSOCIATION_RETAIN_NONATOMIC 的关联策略，这可以保证我们持有关联对象；&lt;br&gt;– 关联对象的释放时机与移除时机并不总是一致，比如实验中用关联策略 OBJC_ASSOCIATION_ASSIGN 进行关联的对象，很早就已经被释放了，但是并没有被移除，而再使用这个关联对象时就会造成 Crash 。&lt;/p&gt;
&lt;h1 id=&quot;Day-4-Objective-C-load-vs-initialize&quot;&gt;&lt;a href=&quot;#Day-4-Objective-C-load-vs-initialize&quot; class=&quot;headerlink&quot; title=&quot;# Day 4 : Objective-C +load vs +initialize&quot;&gt;&lt;/a&gt;# Day 4 : &lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/05/02/objective-c-plus-load-vs-plus-initialize/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C +load vs +initialize&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.leichunfeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;雷纯锋的技术博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、+load&lt;br&gt;– 调用所有类的 +load 方法（包括分类的 +load 方法）是直接使用函数内存地址的方式 &lt;code&gt;(*load_method)(cls, SEL_load);&lt;/code&gt; 进行调用的，而不是使用发送消息 &lt;code&gt;objc_msgSend&lt;/code&gt; 的方式。也就是说如果子类没有实现 +load 方法，那么当它被加载时 runtime 是不会去调用父类的 +load 方法的。同理，当一个类和它的分类都实现了 +load 方法时，两个方法都会被调用。&lt;br&gt;– 子类的 +load 方法会在它的所有父类的 +load 方法之后执行，而分类的 +load 方法会在它的主类的 +load 方法之后执行。但是不同的类之间的 +load 方法的调用顺序是不确定的。&lt;/p&gt;
&lt;p&gt;##2、+initialize&lt;br&gt;– runtime 使用了发送消息 &lt;code&gt;objc_msgSend&lt;/code&gt; 的方式对 +initialize 方法进行调用。如果子类没有实现 +initialize 方法，那么继承自父类的实现会被调用；如果一个类的分类实现了 +initialize 方法，那么就会对这个类中的实现造成覆盖。&lt;br&gt;– 如果一个子类没有实现 +initialize 方法，那么父类的实现是会被执行多次的。可以使用下面的代码确保自己的 +initialize 方法只执行一次：&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)initialize &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; == [ClassName &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// ... do the initialization ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;##3、总结&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;+load&lt;/th&gt;
&lt;th&gt;+initialize&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;调用时机&lt;/td&gt;
&lt;td&gt;被添加到 runtime 时&lt;/td&gt;
&lt;td&gt;收到第一条消息前，可能永远不调用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;调用顺序&lt;/td&gt;
&lt;td&gt;父类-&amp;gt;子类-&amp;gt;分类&lt;/td&gt;
&lt;td&gt;父类-&amp;gt;子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;调用次数&lt;/td&gt;
&lt;td&gt;1次&lt;/td&gt;
&lt;td&gt;多次&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;是否需要显式调用父类实现&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;是否沿用父类的实现&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;分类中的实现&lt;/td&gt;
&lt;td&gt;类和分类都执行&lt;/td&gt;
&lt;td&gt;覆盖类中的方法，只执行分类的实现&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;Day-3-Objective-C对象模型及应用&quot;&gt;&lt;a href=&quot;#Day-3-Objective-C对象模型及应用&quot; class=&quot;headerlink&quot; title=&quot;# Day 3 : Objective-C对象模型及应用&quot;&gt;&lt;/a&gt;# Day 3 : &lt;a href=&quot;http://blog.devtang.com/2013/10/15/objective-c-object-model/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Objective-C对象模型及应用&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.devtang.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;唐巧的博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、ISA 指针&lt;br&gt;– 每一个对象都有一个名为 isa 的指针，指向该对象的类。&lt;br&gt;– 在 Objective-C 语言中，每一个类实际上也是一个对象，每一个类也有一个名为 isa 的指针，指向该类的元类。&lt;br&gt;– 元类的 isa 指针指向根元类。&lt;br&gt;– 根元类的 isa 指针指向自己。    &lt;/p&gt;
&lt;p&gt;（文章中有一张图直白的说明了 isa 指针的指向）&lt;/p&gt;
&lt;p&gt;##2、Method Swizzling API 说明&lt;br&gt;– &lt;code&gt;class_replaceMethod&lt;/code&gt;, 当需要替换的方法可能有不存在的情况时，可以考虑使用该方法。&lt;br&gt;– &lt;code&gt;method_exchangeImplementations&lt;/code&gt;，当需要交换 2 个方法的实现时使用。&lt;br&gt;– &lt;code&gt;method_setImplementation&lt;/code&gt; 最简单的用法，当仅仅需要为一个方法设置其实现方式时使用。&lt;/p&gt;
&lt;h1 id=&quot;Day-2-谈Objective-C-block的实现&quot;&gt;&lt;a href=&quot;#Day-2-谈Objective-C-block的实现&quot; class=&quot;headerlink&quot; title=&quot;# Day 2 : 谈Objective-C block的实现&quot;&gt;&lt;/a&gt;# Day 2 : &lt;a href=&quot;http://blog.devtang.com/2013/07/28/a-look-inside-blocks/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;谈Objective-C block的实现&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;http://blog.devtang.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;唐巧的博客&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、block 的 struct 结构：&lt;br&gt;&lt;figure class=&quot;highlight arduino&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block_descriptor &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; reserved;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*copy)(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *dst, &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *src);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*dispose)(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block_layout &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *isa; &lt;span class=&quot;comment&quot;&gt;// 所有对象都有该指针，用于实现对象相关的功能。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; flags; &lt;span class=&quot;comment&quot;&gt;// 用于按 bit 位表示一些 block 的附加信息，本文后面介绍 block copy 的实现代码可以看到对该变量的使用。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; reserved; &lt;span class=&quot;comment&quot;&gt;// 保留变量。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*invoke)(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *, ...); &lt;span class=&quot;comment&quot;&gt;// 函数指针，指向具体的 block 实现的函数调用地址。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; Block_descriptor *descriptor; &lt;span class=&quot;comment&quot;&gt;// 表示该 block 的附加描述信息，主要是 size 大小，以及 copy 和 dispose 函数的指针。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/* Imported variables. */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;##2、clang 命令改写 OC 语言下的 block&lt;br&gt;使用 clang 的 &lt;code&gt;clang -rewrite-objc block.c&lt;/code&gt; 命令，可以将 Objetive-C 的源码改写成 c 语言的，生成的 .cpp 文件中有许多关键代码展示了 block 的实现原理。    &lt;/p&gt;
&lt;p&gt;其中，block 中操作未经 &lt;code&gt;__block&lt;/code&gt; 修饰的外部变量时，.cpp 文件中相关代码为：&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; __main_block_func_0(&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; __main_block_impl_0 *__cself) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a = __cself-&amp;gt;a; &lt;span class=&quot;comment&quot;&gt;// bound by copy&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;%d\n&quot;&lt;/span&gt;, a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;block 中操作经 &lt;code&gt;__block&lt;/code&gt; 修饰的外部变量时，.cpp 文件中相关代码为：&lt;br&gt;&lt;figure class=&quot;highlight xl&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;static void __main_block_func_0(struct __main_block_impl_0 *__cself) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  __B&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;lock_byref_a_0&lt;/span&gt; *a = __cself-&amp;gt;&lt;/span&gt;a; &lt;span class=&quot;comment&quot;&gt;// bound by ref&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;printf&lt;/span&gt;(&quot;%d\n&quot;, (a-&amp;gt;&lt;/span&gt;__&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;forwarding&lt;/span&gt;-&amp;gt;&lt;/span&gt;a));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;a&lt;/span&gt;-&amp;gt;&lt;/span&gt;__&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;forwarding&lt;/span&gt;-&amp;gt;&lt;/span&gt;a) = &lt;span class=&quot;number&quot;&gt;1023&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;结论：&lt;br&gt;1、在 block 内部修改变量 a 的内容，不会影响外部的实际变量 a，是因为在 block 内部 copy 了一份变量 a。&lt;br&gt;2、当变量使用 __block 修饰时，block 内部是引用的外部变量的指针，所以可以修改外部的实际变量 a。&lt;/p&gt;
&lt;h1 id=&quot;Day-1-深入理解Objective-C：Category&quot;&gt;&lt;a href=&quot;#Day-1-深入理解Objective-C：Category&quot; class=&quot;headerlink&quot; title=&quot;# Day 1 : 深入理解Objective-C：Category&quot;&gt;&lt;/a&gt;# Day 1 : &lt;a href=&quot;https://tech.meituan.com/DiveIntoCategory.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;深入理解Objective-C：Category&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;由 &lt;a href=&quot;https://tech.meituan.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;美团点评技术团队&lt;/a&gt; 发布&lt;/p&gt;
&lt;p&gt;##1、category 在 runtime 层用结构体 category_t 定义：&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;category_t&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *name; &lt;span class=&quot;comment&quot;&gt;// 类的名字&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;classref_t&lt;/span&gt; cls; &lt;span class=&quot;comment&quot;&gt;// 类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_list_t&lt;/span&gt; *instanceMethods; &lt;span class=&quot;comment&quot;&gt;// category中所有给类添加的实例方法的列表&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;method_list_t&lt;/span&gt; *classMethods; &lt;span class=&quot;comment&quot;&gt;// category中所有添加的类方法的列表&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;protocol_list_t&lt;/span&gt; *protocols; &lt;span class=&quot;comment&quot;&gt;// category实现的所有协议的列表&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;property_list_t&lt;/span&gt; *instanceProperties; &lt;span class=&quot;comment&quot;&gt;// category中添加的所有属性&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;category_t&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;由该结构体可以看出 category 可以动态的添加实例方法，类方法，甚至可以实现协议，添加属性，但无法添加实例变量&lt;br&gt;因为无法添加实例变量，所以当采用 category 为类添加属性时，并不会自动生成带有 &lt;code&gt;_&lt;/code&gt; 的实例变量，所以 &lt;code&gt;setter&lt;/code&gt; 和 &lt;code&gt;getter&lt;/code&gt; 方法也需要自己去实现，在文章末尾有介绍采用关联对象来实现，使用 &lt;code&gt;objc_setAssociatedObject&lt;/code&gt; 和 &lt;code&gt;objc_getAssociatedObject&lt;/code&gt; 方法。&lt;/p&gt;
&lt;p&gt;##2、category 替换原来类已有的方法&lt;br&gt;category 的方法被放到了新方法列表的前面，而原来类的方法被放到了新方法列表的后面，运行时在查找方法的时候是顺着方法列表的顺序查找的，它只要一找到对应名字的方法，就会罢休。&lt;br&gt;所以，category 的方法没有“完全替换掉”原来类已经有的方法。在文章第六节也有介绍可以使用 &lt;code&gt;class_copyMethodList&lt;/code&gt; 方法获取方法列表，顺着方法列表找到最后一个对应名字的方法，就可以调用原来类的方法&lt;/p&gt;
&lt;p&gt;##3、-category 和 +load 方法&lt;br&gt;在类的 +load 方法调用的时候，我们可以调用 category 中声明的方法，因为附加 category 到类的工作会先于 +load 方法的执行&lt;br&gt;+load 的执行顺序是先类，后 category，而 category 的 +load 执行顺序是根据编译顺序决定的（Compile Sources（4 items）里的顺序）&lt;/p&gt;
&lt;h1 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2017/08/09/100days-100blogs&quot;&gt;http://gonghonglou.com/2017/08/09/100days-100blogs&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;一直以来都活跃在微博、简书等各大网站搜罗技术博客，每当看到大牛发布或者转发技术博客都会点进去搂一眼，内容比较好或者比较感兴趣的话就会转发收藏。&lt;br&gt;但这些都是零零碎碎的，大多时候都是路上、睡觉前或者什么间隙看到一篇好文章，简单看一下就收藏了，当时来不及 想着以后细读，但往
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>记环青海湖骑行</title>
    <link href="http://gonghonglou.com/2017/07/29/qinghaihu-cycling/"/>
    <id>http://gonghonglou.com/2017/07/29/qinghaihu-cycling/</id>
    <published>2017-07-29T07:14:22.000Z</published>
    <updated>2017-07-31T06:21:31.000Z</updated>
    
    <content type="html">&lt;p&gt;生活终究按不住远方的躁动&lt;br&gt;骑行将会是你爱上的运动方式&lt;/p&gt;
&lt;p&gt;自去年&lt;a href=&quot;http://gonghonglou.com/2016/05/10/chongming-cycling&quot;&gt;环崇明岛骑行&lt;/a&gt;之后便念念不忘再计划骑行一次，而且最近特别喜好西北远方，虽然在&lt;a href=&quot;http://gonghonglou.com/2016/12/26/saybye2016/&quot;&gt;2016 年的年终总结&lt;/a&gt;里计划了五月份骑行青海湖，不过听网友推荐七月才是青海湖最美骑行季节，由环湖赛就安排在七月份也可见一斑。所以便将这份骑行计划安排在了七月份，只身一人，来一场远方的躁动吧！&lt;/p&gt;
&lt;p&gt;其实青海湖有许多租车服务，只不过我更喜欢骑自己的车子，所以自己带了车子过去。&lt;br&gt;一辆车子，一个满满的驮包，讲真：带起来超费劲。到了西宁住宿洗澡的时候我才发现，两肩已经勒出淤血。。。&lt;br&gt;也正是因为自己带了车子，所以选择了火车出行，因此省下了一笔出行费。&lt;br&gt;二十五个小时的卧铺，这是我坐过的最长时间的火车了，本以为会累成狗，实际上却没有。在车上看一部电影（《神奇女侠》）、看一本书（东野圭吾的《恶意》）、听车厢里的人聊天、看路过的风景。就这些，不知觉的西宁就到了。&lt;/p&gt;
&lt;p&gt;这种，一个人，坐上驶往远方的列车，置身嘈杂的车厢，却有独自宁静的感觉……也让人蛮享受的「摊手」&lt;/p&gt;
&lt;p&gt;经历“短暂”的二十五小时的卧铺，西宁站，到了：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6367.JPG&quot; alt=&quot;西宁站&quot;&gt;&lt;/p&gt;
&lt;p&gt;背一车子，拎一驮包，加持三千多海拔及西北内陆地区的干燥，在从西宁站到宾馆短短不足一公里的路程，休息了无数次，特别容易气喘而且干燥异常，而我…还没带水……（在接下来的四五天了，我留了N次鼻血…因为青海这干燥的天气。五分钟不喝水就感觉要干涸了，然而喝过水之后也不会缓解这种感觉多少💊）    &lt;/p&gt;
&lt;p&gt;总之，历尽辛苦总算到了宾馆！&lt;br&gt;在卸下行李关上房门之后才感觉，一个人，有些太宁静了。突然感觉太空荡了，或者是，空荡荡…&lt;br&gt;打开电视，CCTV1，调大音量，who care 节目是什么…&lt;br&gt;出门买了瓶水，吃了碗面（真tm咸，突然想起来大一时候，南方同学乍来北方说北方的饭啥都咸，我想现在的我稍微能感受一点了）&lt;/p&gt;
&lt;p&gt;回宾馆路上，约晚上十一点，一个人，七月的西宁，凉爽的夜晚，有风，没有身影。&lt;/p&gt;
&lt;p&gt;洗个澡睡个觉，明个早起赶七点半西宁到西海镇的首班客车。&lt;br&gt;环青海湖路线及大事件：西海镇 —- 151基地 —- 黑马河（茶卡盐湖、黑马河日出） —- 刚察县 —- 西海镇&lt;/p&gt;
&lt;p&gt;接下来便是我四天环青海湖骑行的行程，多图预警⚠️⚠️⚠️&lt;/p&gt;
&lt;h1 id=&quot;16号&quot;&gt;&lt;a href=&quot;#16号&quot; class=&quot;headerlink&quot; title=&quot;16号&quot;&gt;&lt;/a&gt;16号&lt;/h1&gt;&lt;p&gt;提前在网上买好了西宁到西海的车票，赶上七点半的班车，发往西海。&lt;br&gt;大约十点钟就抵达了西海镇。终于，携带车子的负担结束了，终于，可以把车子组装起来了：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6376.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6381.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;在开往西海的车上认识了一位也是独自一人来环青海湖骑行的齐子煜，在哈尔滨读书，开学大三，潍坊人，也算遇到老乡了，都是一人，所以就结伴骑行了，就这样，捡到了骑友。&lt;br&gt;我装好了车子，他租好了车子，简单吃了个午饭，约十二点，出发了。&lt;br&gt;坐标：西海，目标：西海！&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6386.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;刚开始便是十五公里的上坡。然后在抵达湖东种羊场之前一直是大上坡大下坡的起伏路，既有日渐荒化的沙漠也有广阔无垠的草原：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6418.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6969.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;过了湖东种羊场，一直到转上109国道之前的这段环湖东路，应该是环青海湖路程中最美的一段路了，怎么能不停下来多拍几张照：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6440.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6461.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6467.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender%2016.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender%2011.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后的路程就是最苦逼的了，不知道是第一天刚开始的不适应，还是的确这段路比较难行，尤其是转上109国道之后，骑起来特别费力，这是一段特别辛苦的路程。&lt;br&gt;但也不差有好的风景：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender14.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;本来是打算骑到江西沟的，然后明天上午只需要骑行五十公里便可以抵达黑马河，但由于这段路的辛苦，速度太慢，而且体力不支，所以只能在151基地（二郎剑景区）附近住宿了。&lt;br&gt;下午七点多，在距离151基地四公里处住了下来。骑友的租车老板介绍的宾馆 —- 牧民之家。一个人骑行，已经做好了住宿青旅的打算，然而现在是两人骑行，所以住宿当然也是选择略舒适的两人间。这几天的住宿都还不错，两人间，160，价格和环境都比预期的满意多了：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6430.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;有意思的是，青海这边大部分只支持微信支付，极少支持支付宝。老板说：支付宝太麻烦，我们也不会用，微信收支付很方便。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;今天骑了约七十公里！&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;17号&quot;&gt;&lt;a href=&quot;#17号&quot; class=&quot;headerlink&quot; title=&quot;17号&quot;&gt;&lt;/a&gt;17号&lt;/h1&gt;&lt;p&gt;休息了一夜，一早七八点钟，吃过早饭再次赶路。&lt;br&gt;所谓“骑行，最重要的是一个坚强的屁股”绝对是一句箴言！一踏上车子，坐上车座，我天，屁股炸裂，即使穿了骑行裤，感觉像垫了姨妈巾，依然没有什么卵用！&lt;/p&gt;
&lt;p&gt;在青海湖，最不缺的就是油菜花：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender6.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6487.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6490.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;所谓油菜花，应该是与美女的连衣裙相配才是，而我也厚着脸皮以头盔加骑行装合了两张照片😂&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;今天，仍旧不轻松。前路漫漫，虽然坡不大，但遇上逆风，骑起来就艰难异常。&lt;br&gt;骑行，最绝望的，就是望不到尽头的上坡。&lt;br&gt;在很长的一段路途中，上坡加逆风会让你脑袋放空，鼻孔大口吸气，嘴巴负责呼气，两腿只需要机械的运动。你能听到的只有你粗重的喘息声，两手扶好车把，两腿只要卖力的蹬、蹬、蹬，直到征服这段上坡！&lt;/p&gt;
&lt;p&gt;接近黑马河的是一段约五到十公里的下坡，约下午一点半抵达黑马河。&lt;br&gt;找了宾馆，放了车子，吃了午饭，和人拼车去茶卡盐湖。&lt;/p&gt;
&lt;p&gt;橡皮山，海拔 3817米，大概是去茶卡盐湖路上的最高海拔点，司机师傅还停车让我们能拍了个照：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;大约两个多小时抵达了茶卡盐湖，又是一波放照：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6974.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6973.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6526.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6550.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;从茶卡盐湖出来，湿过的裤腿又干了，已经变的硬邦邦。。。&lt;/p&gt;
&lt;p&gt;再回到黑马河已经是晚上十点，不知道是这边天黑得晚（将近九点）还是黑马河的旅游旺季，这个点了，所有的店还都开着门呢。&lt;br&gt;黑马河，不像其他地方的旅游景点，这里的人像服务员、包车司机、宾馆老板都特别客气。&lt;br&gt;服务员：要么是中学生大小带着诚挚的表情，要么是二十多岁带着亲和的笑容，让人心情愉悦，感叹这里民风淳朴。&lt;br&gt;包车司机：不知道是汉语不够好还是心地太纯良，他也想多挣点钱，所以对去哪哪的包车价格支吾的报一个略高的价格，然而却是以一种轻易让人听得出来心思的语气表达，又极易被乘客的语言套路。。。乘客和司机都没有恶意，反而觉得这样的关系很轻松。&lt;br&gt;宾馆老板娘：简直好的不要不要的，我需要洗衣盆，洗衣粉，衣架，热水，老板娘都很耐心给找来，更要命的是，第二天一大早我想冲包感冒冲剂，问老板娘有没有一次性纸杯，她说等一会，然后，然后，她就去超市买了一袋纸杯回来。没有的话她完全可以拒绝我啊，我们只是花了160住了个两人间。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;今天骑了约八十公里！&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;18号&quot;&gt;&lt;a href=&quot;#18号&quot; class=&quot;headerlink&quot; title=&quot;18号&quot;&gt;&lt;/a&gt;18号&lt;/h1&gt;&lt;p&gt;2017年7月18日的黑马河，日出时间是06:16:00。&lt;br&gt;五点多钟起床匆匆洗漱，卸下行李，踏上单车，轻装上阵，骑往湖边等待日出。从镇上到湖边观日出的地点大约有五六公里，这段路早已人满为患，有开车的，骑行的，步行的，排满了整段路。&lt;br&gt;还好，我们骑车的比较快，六点之前就赶到了湖边。虽然看日出的人很多，但是湖边的岸线很长，所以并不显得拥挤，大家都有看日出的位置。&lt;br&gt;然后，就是等待日出：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6975.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender2.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender10.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6979.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6978.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender9.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;看完日出，回去吃完午饭，当然是继续赶路，今天有一整天的时间，要赶到刚察县，一百二十公里！&lt;br&gt;不过听司机师傅说接下来两天的路况还都不错，应该是比前两天轻松的。&lt;/p&gt;
&lt;p&gt;征服过一个大上坡之后的路边休息：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6671.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6679.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;骑行青海湖的小朋友：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6655.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6654.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;遇见青藏铁路：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6657.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6664.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;大概在下午七点钟的样子，终于赶到刚察，找到宾馆直接瘫在床上睡了两个小时才休息过来出门吃饭。只不过，青海的饭菜实在是吃不惯，还贵。在青海的这几天，感觉汉堡和士力架就是最合口的了，然而除了西海镇是没有汉堡的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;今天骑了约一百二十公里！&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;19号&quot;&gt;&lt;a href=&quot;#19号&quot; class=&quot;headerlink&quot; title=&quot;19号&quot;&gt;&lt;/a&gt;19号&lt;/h1&gt;&lt;p&gt;今天还有九十公里的路程，路上还要翻越一座绝望坡，因为要赶上西海到西宁的末班车，五点半，而且要早点赶到才能买上车票，所以还是要加紧赶路。&lt;/p&gt;
&lt;p&gt;今天的状态特别好，感觉可以一口气骑到西海着（要不是遇到绝望坡。。。）&lt;br&gt;路过甘子河，状态依然，所以也没有停下来休息：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6688.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;终于遇到绝望坡，这样看起来好像还好，不过实际上还是挺大的坡，而且特别长，忘记了骑了多长时间，好几次想停下了休息，总是想：骑上这个坡头就休息。然而骑过一个坡头又望见一个坡头，就这样最慢以 7-8km/h 的的速度登上了绝望坡，然后再没力气了，只能停下来休息，顺便等一下骑友吃个午饭。&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6691.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;休息了四五十分钟吃了碗泡面，继续赶路，听骑过的骑友讲还剩来两个小坡，随后二十公里全是下坡了，不蹬都能到 30km/h，赶路！&lt;/p&gt;
&lt;p&gt;终于，在下午三点半赶到了西海镇，买上了最后一班车的车票。&lt;br&gt;环青海湖骑行，三百六十公里，完成了！&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/FullSizeRender12.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;每次骑行的时候都累到：骑完这次再不骑了。&lt;br&gt;骑完之后又还想再计划一次骑行。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;今天骑了约九十公里！&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;再见青海&quot;&gt;&lt;a href=&quot;#再见青海&quot; class=&quot;headerlink&quot; title=&quot;再见青海&quot;&gt;&lt;/a&gt;再见青海&lt;/h1&gt;&lt;p&gt;因为休了一周的年假，所以时间还早，计划回济南同学聚一波。顺便爬一爬泰山，弥补一下在济南待了四年喊着要去爬泰山的遗憾。&lt;br&gt;所谓“累成狗”应该是一种比较舒适的状态吧「二哈」&lt;br&gt;在兰州中川机场飞济南遥墙，遇见西北地貌，再见青海！&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6949.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6948.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6951.JPG&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/qinghaihu-cycling/IMG_6950.JPG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h1&gt;&lt;p&gt;这里有一份.gpx文件 👉&lt;a href=&quot;http://image.gonghonglou.com/qinghaihu-cycling/qinghaihu_trajectory.gpx.zip&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击下载&lt;/a&gt; ，记录了环青海湖的骑行轨迹，有兴趣的话可以下载下来看看。&lt;br&gt;将它导入到支持 gpx 格式的软件里就可以了，我用的是「行者」，大家喜欢用什么软件可以自行 Google～&lt;/p&gt;
&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2017/07/29/qinghaihu-cycling/&quot;&gt;http://gonghonglou.com/2017/07/29/qinghaihu-cycling&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;生活终究按不住远方的躁动&lt;br&gt;骑行将会是你爱上的运动方式&lt;/p&gt;
&lt;p&gt;自去年&lt;a href=&quot;http://gonghonglou.com/2016/05/10/chongming-cycling&quot;&gt;环崇明岛骑行&lt;/a&gt;之后便念念不忘再计划骑行一次，而且最近特别喜好西北
    
    </summary>
    
      <category term="Journey" scheme="http://gonghonglou.com/categories/Journey/"/>
    
    
  </entry>
  
  <entry>
    <title>一小时轻松实现科学上网</title>
    <link href="http://gonghonglou.com/2017/07/10/ss-vps/"/>
    <id>http://gonghonglou.com/2017/07/10/ss-vps/</id>
    <published>2017-07-10T02:38:09.000Z</published>
    <updated>2017-07-24T04:11:48.000Z</updated>
    
    <content type="html">&lt;p&gt;自从科学上网这件事越来越成为一门口口相传的手艺的时候，就一直想要亲身实践下自建 VPS。&lt;a href=&quot;https://www.greenjsq.me/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Green VPN&lt;/a&gt; 突然发布了这则「相遇有时，后会无期」的公告，使我又失去了一个科学上网的工具，终于敦促我完成了这次体验。&lt;/p&gt;
&lt;p&gt;我还能说什么，当然是选择原谅她。。。&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/ssvps/Green_VPN.png&quot; alt=&quot;相遇有时，后会无期
&quot;&gt;&lt;/p&gt;
&lt;p&gt;以下是几种服务的对比：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PPTP：&lt;br&gt;  – 优点：网上关于搭建 PPTP 服务的教程最多&lt;br&gt;  – 缺点：可能是因为 PPTP 不够安全，所以苹果禁用了这种服务的连接。就是说 Mac OX 和 iOS 系统上是不能使用这种服务的。 &lt;/li&gt;
&lt;li&gt;L2TP、IKEv2、IPSec：&lt;br&gt;  – 优点：Mac OX 和 iOS 系统上可以使用&lt;br&gt;  – 缺点：使用系统添加此类服务的 VPN 配置无法实现智能分流，也就是 Shadowsocks 里的「自动代理模式」（PPTP 同样存在这个缺点）&lt;/li&gt;
&lt;li&gt;Shadowsocks：&lt;br&gt;  – 优点：可以实现自动代理模式，实现国内国外线路智能分流。&lt;br&gt;  – 缺点：必须下载 Shadowsocks 客户端来使用该服务&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以，为了自动代理，我选择了 Shadowsocks。简单来说就是在自己的服务器上搭建一个 Shadowsocks 服务，对外提供「IP 地址 + 端口号」和「密码」&lt;/p&gt;
&lt;p&gt;实现的功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;服务器开机自动启动 Shadowsocks 服务&lt;/li&gt;
&lt;li&gt;可配置多个账号（即：多个端口号 + 密码）&lt;/li&gt;
&lt;li&gt;实现自动代理模式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以我们需要：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;购买服务器（vps）&lt;/li&gt;
&lt;li&gt;装载 Shadowsocks 服务&lt;/li&gt;
&lt;li&gt;下载 iOS、Mac 客户端连接 vps&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;购买-VPS&quot;&gt;&lt;a href=&quot;#购买-VPS&quot; class=&quot;headerlink&quot; title=&quot;购买 VPS&quot;&gt;&lt;/a&gt;购买 VPS&lt;/h1&gt;&lt;p&gt;在 &lt;a href=&quot;https://bwh1.net/index.php&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;搬瓦工&lt;/a&gt; 购买一款适合你的主机，单纯搭建 Shadowsocks 服务的话「10G VPS」已经完全够用了，一年 19.9 美元，网上搜一个 6% 的优惠码，折合人民币大概 130 块一年。&lt;br&gt;购买过程可以参考：&lt;a href=&quot;http://banwagong.cn/gonglue.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;新手用户搬瓦工VPS购买图文指导教程&lt;/a&gt;&lt;br&gt;我买的是 KVM，关于 KVM 和 OpenVZ的区别可以参考：&lt;a href=&quot;http://banwagong.cn/ovz-kvm.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linux VPS基本常识 - KVM与OpenVZ架构的区别&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;购买成功后，在&lt;a href=&quot;https://bwh1.net/clientarea.php?action=products&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个地址&lt;/a&gt;点击 &lt;code&gt;KiwiVM Control Panel&lt;/code&gt; 跳转至 KiwiVM 可管理你的主机&lt;br&gt;然后就可以看到你主机的详细信息了，并且搬瓦工已经帮你装好了 Centos 系统：&lt;img src=&quot;http://image.gonghonglou.com/ssvps/bwg_%20KiwiVM.png&quot; alt=&quot;KiwiVM&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;装载-Shadowsocks-服务&quot;&gt;&lt;a href=&quot;#装载-Shadowsocks-服务&quot; class=&quot;headerlink&quot; title=&quot;装载 Shadowsocks 服务&quot;&gt;&lt;/a&gt;装载 Shadowsocks 服务&lt;/h1&gt;&lt;p&gt;接下来，你有两种选择：    &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一键安装&lt;br&gt;  – 优点：方便快捷&lt;br&gt;  – 缺点：不能添加账号，不能随意更改密码（只能重新生成）&lt;/li&gt;
&lt;li&gt;自己搭建 Shadowsocks 服务&lt;br&gt;  – 优点：可以添加多个账号（任意增删端口号即可），可以修改密码&lt;br&gt;  – 缺点：ssh 连接服务器，执行一系列命令行命令（不过，这对于想要捣鼓捣鼓服务器的人来说，比如我，这也算是优点）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;一键安装&quot;&gt;&lt;a href=&quot;#一键安装&quot; class=&quot;headerlink&quot; title=&quot;一键安装&quot;&gt;&lt;/a&gt;一键安装&lt;/h2&gt;&lt;p&gt;如下图，点击 &lt;code&gt;Intsall Shadowsocks Server&lt;/code&gt; 即可：&lt;img src=&quot;http://image.gonghonglou.com/ssvps/bwg_Shadowsocks.png&quot; alt=&quot;Intsall Shadowsocks Server&quot;&gt;&lt;/p&gt;
&lt;p&gt;安装成功后如下图，会提供给我们：端口号、加密方式、密码，其中密码只能重新生成，不能更改。&lt;img src=&quot;http://image.gonghonglou.com/ssvps/bwg_ssServer.jpeg&quot; alt=&quot;Shadowsocks Server&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;下载-iOS、Mac-客户端连接-vps&quot;&gt;&lt;a href=&quot;#下载-iOS、Mac-客户端连接-vps&quot; class=&quot;headerlink&quot; title=&quot;下载 iOS、Mac 客户端连接 vps&quot;&gt;&lt;/a&gt;下载 iOS、Mac 客户端连接 vps&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Mac 客户端：&lt;a href=&quot;https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-%E5%B8%AE%E5%8A%A9&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ShadowsocksX&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;iOS 客户端：App Store 搜索「Wingy」或着「Shadowrocket」&lt;/li&gt;
&lt;li&gt;windows 客户端：&lt;a href=&quot;https://github.com/shadowsocks/shadowsocks-windows/wiki/Shadowsocks-Windows-%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Shadowsocks Windows&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如下图为 Shadowsocks Mac 客户端，填入服务器 IP 地址、上图中 Shadowsocks Server 端口号、加密方式、密码确定即可连接 VPS 的 Shadowsocks 服务，iOS 上的软件也是填写这些内容：&lt;img src=&quot;http://image.gonghonglou.com/ssvps/ss_addip.png&quot; alt=&quot;Shadowsocks for Mac&quot;&gt;&lt;/p&gt;
&lt;p&gt;如此，便可以科学上网了，一键安装，就是这么简单～&lt;br&gt;接下来是略微专业一点的做法，需要了解一些 Linux 命令。&lt;/p&gt;
&lt;h2 id=&quot;自己搭建-Shadowsocks-服务&quot;&gt;&lt;a href=&quot;#自己搭建-Shadowsocks-服务&quot; class=&quot;headerlink&quot; title=&quot;自己搭建 Shadowsocks 服务&quot;&gt;&lt;/a&gt;自己搭建 Shadowsocks 服务&lt;/h2&gt;&lt;p&gt;接下来，该是此篇博客最有趣的内容了：操作 Linux 服务器，搭建 Shadowsocks 服务。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;首先如果你使用了上一种方式一键安装了 Shadowsocks，那么，在采用这种方式搭建服务前应当卸载上一个 Shadowsocks 服务，上一张图片所在网页的最下方会有一键卸载：&lt;code&gt;Unintsall Shadowsocks Server&lt;/code&gt;。如果不卸载该服务，会和接下来自己手动安装的 Shadowsocks 服务冲突。&lt;/strong&gt;  &lt;/p&gt;
&lt;p&gt;保险起见，你可以选择从头来过：重装系统。&lt;br&gt;这里又是开始～&lt;br&gt;如下图选择一款操作系统来安装，&lt;strong&gt;墙裂建议选择 centos-7-x86_64-bbr，因为接下来安装 Shadowsocks 要依赖 python2.7 版本，而 Centos-6 默认安装的是 python2.6&lt;/strong&gt;：&lt;img src=&quot;http://image.gonghonglou.com/ssvps/bwg_installnewos.png&quot; alt=&quot;重装系统&quot;&gt;&lt;/p&gt;
&lt;p&gt;重装完成后，你会受到一封告知邮件，并且附有一份临时服务器登录密码。当然，你也可以点击上图中的 &lt;code&gt;Root password modification&lt;/code&gt; 重新生成一份密码。注意：生成密码前需要先 stop 服务器。&lt;/p&gt;
&lt;h3 id=&quot;连接服务器&quot;&gt;&lt;a href=&quot;#连接服务器&quot; class=&quot;headerlink&quot; title=&quot;连接服务器&quot;&gt;&lt;/a&gt;连接服务器&lt;/h3&gt;&lt;p&gt;开启终端，使用 ssh 远程连接服务器：&lt;br&gt;&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;ssh&lt;/span&gt; root&lt;span class=&quot;variable&quot;&gt;@you_server_ip&lt;/span&gt; -p you_server_port&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;you_server_ip：你的服务器 ip 地址，you_server_port：你的服务器端口号，回车输入 root 登录密码即可。&lt;br&gt;如果你之前 ssh 登录过服务器，又重装之后再次登录可能会有以下问题：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&lt;br&gt;@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @&lt;br&gt;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;执行如下命令，将 known_hosts 文件里包含你服务器 ip 地址那一段删掉即可成功连接：&lt;br&gt;&lt;figure class=&quot;highlight crystal&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vim ~&lt;span class=&quot;regexp&quot;&gt;/.ssh/known&lt;/span&gt;_hosts&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;为方便之后 ssh 登录，可执行以下命令修改 root 密码：&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;passwd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;回车输入新密码确认即可。&lt;/p&gt;
&lt;h3 id=&quot;安装-Shadowsocks&quot;&gt;&lt;a href=&quot;#安装-Shadowsocks&quot; class=&quot;headerlink&quot; title=&quot;安装 Shadowsocks&quot;&gt;&lt;/a&gt;安装 Shadowsocks&lt;/h3&gt;&lt;p&gt;安装 setuptools 和 pip ，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; python-setuptools &amp;amp;&amp;amp; easy_install pip&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;安装 Python-Gevent，用于提高性能，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; libevent&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; python-devel&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pip &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gevent&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;安装 M2Crypto，用于加密的第三库，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight mipsasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install &lt;/span&gt;openssl-devel&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;swig&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;yum &lt;span class=&quot;keyword&quot;&gt;install &lt;/span&gt;gcc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pip &lt;span class=&quot;keyword&quot;&gt;install &lt;/span&gt;M2Crypto&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;安装 Shadowsocks 服务端，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;pip &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; shadowsocks&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;配置-Shadowsocks&quot;&gt;&lt;a href=&quot;#配置-Shadowsocks&quot; class=&quot;headerlink&quot; title=&quot;配置 Shadowsocks&quot;&gt;&lt;/a&gt;配置 Shadowsocks&lt;/h3&gt;&lt;p&gt;新建配置文件，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vi &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;shadowsocks.json&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;编辑 shadowsocks.json 文件内容如下：&lt;br&gt;&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;server&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;you_server_ip&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;local_address&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;local_port&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1080&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;port_password&quot;&lt;/span&gt;:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;span class=&quot;attr&quot;&gt;&quot;9000&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;9000password&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;span class=&quot;attr&quot;&gt;&quot;9001&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;9001password&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;span class=&quot;attr&quot;&gt;&quot;9002&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;9002password&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;timeout&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;method&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;rc4-md5&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;fast_open&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;解释一下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Explanation &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;server&lt;/td&gt;
&lt;td&gt;服务器 IP 地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;server_port&lt;/td&gt;
&lt;td&gt;服务器端口号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;local_address&lt;/td&gt;
&lt;td&gt;本地代理地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;local_port&lt;/td&gt;
&lt;td&gt;本地代理端口&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;port_password&lt;/td&gt;
&lt;td&gt;Shadowsocks 服务端口号及密码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;timeout&lt;/td&gt;
&lt;td&gt;超时断开，以秒为单位&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;method&lt;/td&gt;
&lt;td&gt;加密方式，推荐使用 rc4-md5，比 aes-256-cfb 速度快很多&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;fast_open&lt;/td&gt;
&lt;td&gt;是否使用TCP&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;后端开启与停止 Shadowsocks 服务，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssserver -c /etc/shadowsocks&lt;span class=&quot;selector-class&quot;&gt;.json&lt;/span&gt; -d start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssserver -c /etc/shadowsocks&lt;span class=&quot;selector-class&quot;&gt;.json&lt;/span&gt; -d stop&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;或者选择前端开启 Shadowsocks 服务，在终端执行以下命令：&lt;br&gt;执行该命令当连接成功或出错时终端会打印详情信息，建议第一次开启 Shadowsocks 服务时执行该命令：&lt;br&gt;&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssserver -c &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;shadowsocks.json&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;至此，使用 Shadowsocks 客户端就可以科学上网了。  &lt;/p&gt;
&lt;h3 id=&quot;设置服务器开机启动&quot;&gt;&lt;a href=&quot;#设置服务器开机启动&quot; class=&quot;headerlink&quot; title=&quot;设置服务器开机启动&quot;&gt;&lt;/a&gt;设置服务器开机启动&lt;/h3&gt;&lt;p&gt;设置开机启动，在终端执行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vi /etc/rc.&lt;span class=&quot;keyword&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;将以下开启 Shadowsocks 服务命令加入 rc.local 文件：&lt;br&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssserver -c /etc/shadowsocks&lt;span class=&quot;selector-class&quot;&gt;.json&lt;/span&gt; -d start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;保存退出即可。执行命令 &lt;code&gt;reboot&lt;/code&gt; 重启服务器试试看～&lt;/p&gt;
&lt;p&gt;至此，已经可以科学上网，秒开 Youtobe，1080无压力～&lt;/p&gt;
&lt;h2 id=&quot;给安装-Centos-6-的补充&quot;&gt;&lt;a href=&quot;#给安装-Centos-6-的补充&quot; class=&quot;headerlink&quot; title=&quot;给安装  Centos-6 的补充&quot;&gt;&lt;/a&gt;给安装  Centos-6 的补充&lt;/h2&gt;&lt;h3 id=&quot;补充一：&quot;&gt;&lt;a href=&quot;#补充一：&quot; class=&quot;headerlink&quot; title=&quot;补充一：&quot;&gt;&lt;/a&gt;补充一：&lt;/h3&gt;&lt;p&gt;如果你装的系统是 Centos-6 那么执行 &lt;code&gt;pip install ...&lt;/code&gt; 或许会有以下报错：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;DEPRECATION: Python 2.6 is no longer supported by the Python core team, please upgrade your Python. A future version of pip will drop support for Python 2.6&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;说明，你的 Python 版本是 2.6，终端执行命令 &lt;code&gt;Python -V&lt;/code&gt; 查看 Python 版本。&lt;br&gt;你可以执行以下命令简单升级 Python2.7&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; centos-&lt;span class=&quot;keyword&quot;&gt;release&lt;/span&gt;-SCL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; python27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;. /opt/rh/python27/&lt;span class=&quot;keyword&quot;&gt;enable&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后执行命令 &lt;code&gt;Python -V&lt;/code&gt; 验证此时的 Python 版本，注意，此时不要更换操作目录，接下来的安装和启动 Shadowsocks 都需要在这个目录下完成，因为你的 Shadowsocks 就是用这个目录下的 Python2.7 安装的。&lt;br&gt;设置开机自启动时， 也应该在 rc.local 文件里加入以下命令：&lt;br&gt;&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;. &lt;span class=&quot;meta-keyword&quot;&gt;/opt/&lt;/span&gt;rh&lt;span class=&quot;meta-keyword&quot;&gt;/python27/&lt;/span&gt;enable&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ssserver -c &lt;span class=&quot;meta-keyword&quot;&gt;/etc/&lt;/span&gt;shadowsocks.json -d start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;补充二：&quot;&gt;&lt;a href=&quot;#补充二：&quot; class=&quot;headerlink&quot; title=&quot;补充二：&quot;&gt;&lt;/a&gt;补充二：&lt;/h3&gt;&lt;p&gt;然而，当你第二次在 python2.6 环境下执行 &lt;code&gt;pip install shadowsocks&lt;/code&gt; 也许会有如下提示：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;DEPRECATION: Python 2.6 is no longer supported by the Python core team, please upgrade your Python. A future version of pip will drop support for Python 2.6&lt;br&gt;Requirement already stisfied:shadowsocks in /usr/lib/python2.6/site-packages&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;虽然有报错，但你的确已经在 python2.6 环境下安装好了 shadowsocks 服务，那么在任意目录下你都可以执行 &lt;code&gt;ssserver -c /etc/shadowsocks.json&lt;/code&gt; 命令开启 shadowsocks 服务。&lt;/p&gt;
&lt;h3 id=&quot;补充三：&quot;&gt;&lt;a href=&quot;#补充三：&quot; class=&quot;headerlink&quot; title=&quot;补充三：&quot;&gt;&lt;/a&gt;补充三：&lt;/h3&gt;&lt;p&gt;你当然可以自行 Google 完全升级 Python 的方法。&lt;/p&gt;
&lt;h1 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h1&gt;&lt;p&gt;以上便是我搭建个人 VPS，实现科学上网的全过程，希望对大家有所帮助，欢迎吐槽～&lt;/p&gt;
&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2017/07/10/ss-vps&quot;&gt;http://gonghonglou.com/2017/07/10/ss-vps&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h1&gt;&lt;p&gt; &lt;a href=&quot;https://www.linpx.com/p/the-installation-and-configuration-of-ssserver-two.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;安装SSserver和配置(二)&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;自从科学上网这件事越来越成为一门口口相传的手艺的时候，就一直想要亲身实践下自建 VPS。&lt;a href=&quot;https://www.greenjsq.me/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Green VPN&lt;/a&gt; 突然发布了这则「相遇有时，
    
    </summary>
    
      <category term="Technology" scheme="http://gonghonglou.com/categories/Technology/"/>
    
    
  </entry>
  
  <entry>
    <title>UITableViewCell计算行高的几种方式</title>
    <link href="http://gonghonglou.com/2017/07/05/cell-height/"/>
    <id>http://gonghonglou.com/2017/07/05/cell-height/</id>
    <published>2017-07-05T07:03:59.000Z</published>
    <updated>2017-07-24T04:20:58.000Z</updated>
    
    <content type="html">&lt;p&gt;当我还是小白时（比现在更白的时候）对于 UITableViewCell 的行高问题还是比较头疼的，当然这个算是 iOS 开发中相当基础的内容了，但是当时的我就想过，将 UITableViewCell 的行高问题解决了一定写一篇总结博客，所以就有了这篇博客。尽管拖了这。么。久。。。&lt;/p&gt;
&lt;p&gt;iOS 的界面中，UITableView 应该是用的最多的控件之一了吧：微信列表、聊天记录、朋友圈、微博 time line。。。哪哪离不开 UITableView。而 UITableView 则是由 UITableViewCell 组成的，这些 cell 有的行高是固定的，大部分则需要根据内容反计算行高来展示。本篇博客则来介绍 UITableViewCell 计算行高的几种方式。&lt;/p&gt;
&lt;h1 id=&quot;固定行高&quot;&gt;&lt;a href=&quot;#固定行高&quot; class=&quot;headerlink&quot; title=&quot;固定行高&quot;&gt;&lt;/a&gt;固定行高&lt;/h1&gt;&lt;p&gt;有相当一部分 UITableView 的行高是固定的，这种 cell 在代码书写和代码性能上相比而言就简单了许多，有以下两种方式设定行高：&lt;/p&gt;
&lt;h2 id=&quot;统一设定&quot;&gt;&lt;a href=&quot;#统一设定&quot; class=&quot;headerlink&quot; title=&quot;统一设定&quot;&gt;&lt;/a&gt;统一设定&lt;/h2&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.tableView.rowHeight = &lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;; &lt;span class=&quot;regexp&quot;&gt;//&lt;/span&gt; 系统自带的 cell 的行高大概就是 &lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;优点：这种方式最为简单。&lt;/li&gt;
&lt;li&gt;缺点：相对的对 tableView 的可控性也最弱，它会将 tableView 所有的 cell 高度统一设置为 44。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;通过代理设定&quot;&gt;&lt;a href=&quot;#通过代理设定&quot; class=&quot;headerlink&quot; title=&quot;通过代理设定&quot;&gt;&lt;/a&gt;通过代理设定&lt;/h2&gt;&lt;p&gt;通过实现 UITableViewDelegate 方法，同样可以控制 tableView 的行高。&lt;/p&gt;
&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;-&lt;/span&gt; (CGFloat)&lt;span class=&quot;selector-tag&quot;&gt;tableView&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:(UITableView&lt;/span&gt; *)&lt;span class=&quot;selector-tag&quot;&gt;tableView&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;heightForRowAtIndexPath&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:(NSIndexPath&lt;/span&gt; *)&lt;span class=&quot;selector-tag&quot;&gt;indexPath&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 1.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// return 44;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 2.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if (tableView == self.tableView1) &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 	return 44;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// &amp;#125; else &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 	return 88;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 3.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;selector-tag&quot;&gt;if&lt;/span&gt; (indexPath.row == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        return 44;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;selector-tag&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        return 88;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;优点：采用这种实现代理的方法可以对不同的 tableView 、tableView 中不同的 section、row，进行判断分别设置，可控性更强。&lt;/li&gt;
&lt;li&gt;缺点：因为在每次展示 cell 时都会调用了一次该代理方法，所以较于第一种方法一些性能损耗。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这个缺点在苹果介绍  &lt;code&gt;rowHeight&lt;/code&gt; 属性的文档里也有指明：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There are performance implications to using tableView:heightForRowAtIndexPath: instead of rowHeight. Every time a table view is displayed, it calls tableView:heightForRowAtIndexPath: on the delegate for each of its rows, which can result in a significant performance problem with table views having a large number of rows (approximately 1000 or more).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以，如果你的 tableView 的行高是统一的、固定的，那么最好采用第一种方法，直接设置 rowHeight。&lt;/p&gt;
&lt;h1 id=&quot;不定行高&quot;&gt;&lt;a href=&quot;#不定行高&quot; class=&quot;headerlink&quot; title=&quot;不定行高&quot;&gt;&lt;/a&gt;不定行高&lt;/h1&gt;&lt;p&gt;固定行高的 tableView 已经算是小儿科了，但是也属于 UITableViewCell 行高的范畴，所以还是简单提了一下。&lt;br&gt;那么，当 tableView 的行高不固定时，有以下几种计算方式。&lt;/p&gt;
&lt;h2 id=&quot;估算行高&quot;&gt;&lt;a href=&quot;#估算行高&quot; class=&quot;headerlink&quot; title=&quot;估算行高&quot;&gt;&lt;/a&gt;估算行高&lt;/h2&gt;&lt;p&gt;其实，UITableView 的 &lt;code&gt;rowHeight&lt;/code&gt; 可以设置为 &lt;code&gt;UITableViewAutomaticDimension&lt;/code&gt;，顾名思义，cell 可以设置为自动计算行高。然而，仅仅将 rowHeight 设置为 UITableViewAutomaticDimension 对自计算行高是不起效的，这时候就需要另一个属性：&lt;code&gt;estimatedRowHeight&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;iOS8 苹果推出了 self-sizing 的概念。UITableView 在 iOS7 就增加了一个属性： &lt;code&gt;estimatedRowHeight&lt;/code&gt; ，苹果是这样描述的：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Providing a nonnegative estimate of the height of rows can improve the performance of loading the table view. If the table contains variable height rows, it might be expensive to calculate all their heights when the table loads. Using estimation allows you to defer some of the cost of geometry calculation from load time to scrolling time.&lt;br&gt;&lt;code&gt;When you create a self-sizing table view cell, you need to set this property and use constraints to define the cell’s size.&lt;/code&gt;&lt;br&gt;The default value is 0, which means there is no estimate.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;你可以使用这个属性来给 cell 估算行高，但是默认值为 0，不会进行估算。&lt;br&gt;所以如果想开启估算行高的话，必须设置 estimatedRowHeight，如：&lt;/p&gt;
&lt;figure class=&quot;highlight pf&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;literal&quot;&gt;self&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;table&lt;/span&gt;View.estimatedRowHeight = &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;literal&quot;&gt;self&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;table&lt;/span&gt;View.rowHeight = UITableViewAutomaticDimension;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;将 estimatedRowHeight 设置为一个大概的估计行高值即可，没有严格的限制。比如你的 cell 高度大概在 50 到 100 之间，那么你可以将 estimatedRowHeight 设置为 75；&lt;br&gt;rowHeight 的默认值为 UITableViewAutomaticDimension，所以第二行可以省略。&lt;/p&gt;
&lt;p&gt;然后就是对你的 cell 进行布局设置，这里以 &lt;a href=&quot;https://github.com/SnapKit/Masonry&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Masonry&lt;/a&gt; 为例（AutoLayout 的话，这个框架大家应该都在用吧？～）&lt;br&gt;伪代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (instancetype)initWithStyle:(&lt;span class=&quot;built_in&quot;&gt;UITableViewCellStyle&lt;/span&gt;)style reuseIdentifier:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)reuseIdentifier &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; = [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; initWithStyle:style reuseIdentifier:reuseIdentifier];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        __&lt;span class=&quot;keyword&quot;&gt;weak&lt;/span&gt; __&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;)weakSelf = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; *label1 = [&lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.contentView addSubview:label1];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [label1 mas_makeConstraints:^(MASConstraintMaker *make) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            __&lt;span class=&quot;keyword&quot;&gt;strong&lt;/span&gt; __&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(weakSelf)strongSelf = weakSelf;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.top.equalTo(strongSelf.contentView).with.offset(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.left.equalTo(strongSelf.contentView).with.offset(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.right.equalTo(strongSelf.contentView).with.offset(&lt;span class=&quot;number&quot;&gt;-10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.height.mas_equalTo(&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// ①&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; *label2 = [&lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [label2 setNumberOfLines:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.contentView addSubview:label2];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [label2 mas_makeConstraints:^(MASConstraintMaker *make) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            __&lt;span class=&quot;keyword&quot;&gt;strong&lt;/span&gt; __&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(weakSelf)strongSelf = weakSelf;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.top.equalTo(label1.mas_bottom).with.offset(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.left.equalTo(label1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.right.equalTo(label1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            make.bottom.equalTo(strongSelf.contentView.mas_bottom).with.offset(&lt;span class=&quot;number&quot;&gt;-10&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// ②&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注释①：该条约束可以注释掉，然后将 label1 设置为 &lt;code&gt;[label1 setNumberOfLines:0];&lt;/code&gt; 这样 label1 就可以根据内容自动计算高度。&lt;br&gt;注释②：必须设置该条约束。为了确定 cell 的高度，最接近 cell bottom 的控件需要设置一个距离 cell bottom 的约束。&lt;/p&gt;
&lt;p&gt;布局结果大概是这样的效果：&lt;img src=&quot;http://image.gonghonglou.com/CellHeight/cell_label_layout.png&quot; alt=&quot;自动布局结果&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;优点：代码书写简单，页面布局快捷。在 cell 的 &lt;code&gt;initWithStyle:&lt;/code&gt; 方法里就已经新建各个控件并将位置设置好，并且不需要单独计算 cell 的高度。&lt;/li&gt;
&lt;li&gt;缺点：效率低，稍微复杂些的页面就能感觉到 tableView 滑动时的掉帧。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;代理计算行高&quot;&gt;&lt;a href=&quot;#代理计算行高&quot; class=&quot;headerlink&quot; title=&quot;代理计算行高&quot;&gt;&lt;/a&gt;代理计算行高&lt;/h2&gt;&lt;p&gt;首先来执行一波伪代码，用打印来观察各个代理方法的执行顺序：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#pragma mark - UITableViewDataSource&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSInteger&lt;/span&gt;)tableView:(&lt;span class=&quot;built_in&quot;&gt;UITableView&lt;/span&gt; *)tableView numberOfRowsInSection:(&lt;span class=&quot;built_in&quot;&gt;NSInteger&lt;/span&gt;)section &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;---方法 : numberOfRowsInSection: ---section : %ld&quot;&lt;/span&gt;, (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;)section);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UITableViewCell&lt;/span&gt; *)tableView:(&lt;span class=&quot;built_in&quot;&gt;UITableView&lt;/span&gt; *)tableView cellForRowAtIndexPath:(&lt;span class=&quot;built_in&quot;&gt;NSIndexPath&lt;/span&gt; *)indexPath &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;---方法 : cellForRowAtIndexPath: ---row : %ld&quot;&lt;/span&gt;, (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;)indexPath.row);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UITableViewCell&lt;/span&gt; *cell = [tableView dequeueReusableCellWithIdentifier:&lt;span class=&quot;string&quot;&gt;@&quot;cell&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cell;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#pragma mark - UITableViewDelegate&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)tableView:(&lt;span class=&quot;built_in&quot;&gt;UITableView&lt;/span&gt; *)tableView heightForRowAtIndexPath:(&lt;span class=&quot;built_in&quot;&gt;NSIndexPath&lt;/span&gt; *)indexPath &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;---方法 : heightForRowAtIndexPath: ---row : %ld&quot;&lt;/span&gt;, (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;)indexPath.row);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cellHight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;控制台打印结果如下：&lt;img src=&quot;http://image.gonghonglou.com/CellHeight/cell_delegate.png&quot; alt=&quot;代码执行顺序&quot;&gt;&lt;/p&gt;
&lt;p&gt;①：首先执行 &lt;code&gt;numberOfRowsInSection:&lt;/code&gt; 方法，返回 cell 个数为 10。&lt;br&gt;②：其次执行的就是 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 方法，如上图，此时执行该方法会将所有 cell 的高度全部返回。&lt;br&gt;③④⑤：这时候就开始执行 &lt;code&gt;cellForRowAtIndexPath:&lt;/code&gt; 方法，因为当前页面只能布局 3 条 cell，所以该方法会被执行三次。并且，执行一次 &lt;code&gt;cellForRowAtIndexPath:&lt;/code&gt; 方法紧接着就会执行一次 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 方法返回 cell 高度。&lt;/p&gt;
&lt;p&gt;因此，当我们从网络或者本地缓存中获取到所需数据（ &lt;code&gt;array&lt;/code&gt; ）后，可以直接执行代码：&lt;/p&gt;
&lt;figure class=&quot;highlight ini&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;[self.tableView reloadData]&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后就会调用 &lt;code&gt;cellForRowAtIndexPath:&lt;/code&gt; 方法和 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 方法。&lt;/p&gt;
&lt;p&gt;cell 的 &lt;code&gt;initWithStyle:&lt;/code&gt; 方法：&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (instancetype)initWithStyle:(&lt;span class=&quot;built_in&quot;&gt;UITableViewCellStyle&lt;/span&gt;)style reuseIdentifier:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)reuseIdentifier &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; = [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; initWithStyle:style reuseIdentifier:reuseIdentifier];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;) &amp;#123;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; *label1 = [&lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.contentView addSubview:label1];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; *label2 = [&lt;span class=&quot;built_in&quot;&gt;UILabel&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [label2 setNumberOfLines:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.contentView addSubview:label2];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;我们可以在 &lt;code&gt;cellForRowAtIndexPath:&lt;/code&gt; 方法进行 cell 布局，如：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UITableViewCell&lt;/span&gt; *)tableView:(&lt;span class=&quot;built_in&quot;&gt;UITableView&lt;/span&gt; *)tableView cellForRowAtIndexPath:(&lt;span class=&quot;built_in&quot;&gt;NSIndexPath&lt;/span&gt; *)indexPath &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UITableViewCell&lt;/span&gt; *cell = [tableView dequeueReusableCellWithIdentifier:&lt;span class=&quot;string&quot;&gt;@&quot;cell&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!cell) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cell = [[&lt;span class=&quot;built_in&quot;&gt;UITableViewCell&lt;/span&gt; alloc] initWithStyle:&lt;span class=&quot;built_in&quot;&gt;UITableViewCellStyleDefault&lt;/span&gt; reuseIdentifier:&lt;span class=&quot;string&quot;&gt;@&quot;cell&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 内容&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cell.label1.text = &lt;span class=&quot;string&quot;&gt;@&quot;...&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cell.label2.text = &lt;span class=&quot;string&quot;&gt;@&quot;...&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 布局&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; viewWidth = [&lt;span class=&quot;built_in&quot;&gt;UIScreen&lt;/span&gt; mainScreen].bounds.size.width;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cell.label1.fream = &lt;span class=&quot;built_in&quot;&gt;CGRectMake&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, viewWidth&lt;span class=&quot;number&quot;&gt;-20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; label2Height = [text boundingRectWithSize:&lt;span class=&quot;built_in&quot;&gt;CGSizeMake&lt;/span&gt;(viewWidth&lt;span class=&quot;number&quot;&gt;-20&lt;/span&gt;, MAXFLOAT) options:&lt;span class=&quot;built_in&quot;&gt;NSStringDrawingUsesLineFragmentOrigin&lt;/span&gt; attributes:@&amp;#123;&lt;span class=&quot;built_in&quot;&gt;NSFontAttributeName&lt;/span&gt;:font&amp;#125; context:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;].size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cell.label2.fream = &lt;span class=&quot;built_in&quot;&gt;CGRectMake&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, viewWidth&lt;span class=&quot;number&quot;&gt;-20&lt;/span&gt;, label2Height);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cell;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;布局结果大概是这样的效果：&lt;img src=&quot;http://image.gonghonglou.com/CellHeight/cell_label_fream.png&quot; alt=&quot;手动布局结果&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后在 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 方法里根据 array 数据计算 cell 的高度，如：&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)tableView:(&lt;span class=&quot;built_in&quot;&gt;UITableView&lt;/span&gt; *)tableView heightForRowAtIndexPath:(&lt;span class=&quot;built_in&quot;&gt;NSIndexPath&lt;/span&gt; *)indexPath &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; viewWidth = [&lt;span class=&quot;built_in&quot;&gt;UIScreen&lt;/span&gt; mainScreen].bounds.size.width;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; label2Height = [text boundingRectWithSize:&lt;span class=&quot;built_in&quot;&gt;CGSizeMake&lt;/span&gt;(viewWidth&lt;span class=&quot;number&quot;&gt;-20&lt;/span&gt;, MAXFLOAT) options:&lt;span class=&quot;built_in&quot;&gt;NSStringDrawingUsesLineFragmentOrigin&lt;/span&gt; attributes:@&amp;#123;&lt;span class=&quot;built_in&quot;&gt;NSFontAttributeName&lt;/span&gt;:font&amp;#125; context:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;].size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; + label2Height + &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;优点：通过 feram 的方式能够提高布局效率&lt;/li&gt;
&lt;li&gt;缺点：因为每次 cell 将要出现时都去执行一次 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 所以效率还是不够高，而且行高没有得到缓存，造成大量不必要的计算上的浪费。所以就有了下边这种方法。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;提前计算行高&quot;&gt;&lt;a href=&quot;#提前计算行高&quot; class=&quot;headerlink&quot; title=&quot;提前计算行高&quot;&gt;&lt;/a&gt;提前计算行高&lt;/h2&gt;&lt;p&gt;这种方式是出自 MVVM 的产物，因为最近都在使用 MVVM 框架，所有的计算都放到了 viewModel 里，所以在 viewModel 从网络或者本地缓存拿到数据后接着就会处理，将原始数据处理封装成 cell 的 VO（view object） 类对象，该 VO 类里包含着 cell 所需要的展示内容和尺寸，如：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TableViewCellVO&lt;/span&gt; : &lt;span class=&quot;title&quot;&gt;NSObject&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *label1Text;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;copy&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *label2Text;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 尺寸&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;assign&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;CGRect&lt;/span&gt; label1Fream;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;assign&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;CGRect&lt;/span&gt; label2Fream;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 行高&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@property&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;nonatomic&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;assign&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; cellHeight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后将处理好的 cellVOArray 传给 UITableView 的数据源和代理，在 &lt;code&gt;cellForRowAtIndexPath:&lt;/code&gt; 方法直接赋值：&lt;/p&gt;
&lt;figure class=&quot;highlight verilog&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    UITableViewCell *&lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt; = [tableView dequeueReusableCellWithIdentifier:@&lt;span class=&quot;string&quot;&gt;&quot;cell&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt; = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@&lt;span class=&quot;string&quot;&gt;&quot;cell&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TableViewCellVO *cellVO = cellVOArray[indexPath&lt;span class=&quot;variable&quot;&gt;.row&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.label1&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.text&lt;/span&gt; = cellVO&lt;span class=&quot;variable&quot;&gt;.label1Text&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.label2&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.text&lt;/span&gt; = cellVO&lt;span class=&quot;variable&quot;&gt;.label2Text&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 布局&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.label1&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.fream&lt;/span&gt; = cellVO&lt;span class=&quot;variable&quot;&gt;.label1Fream&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.label2&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;.fream&lt;/span&gt; = cellVO&lt;span class=&quot;variable&quot;&gt;.label2Fream&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;cell&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 方法里直接返回行高：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)tableView:(&lt;span class=&quot;built_in&quot;&gt;UITableView&lt;/span&gt; *)tableView heightForRowAtIndexPath:(&lt;span class=&quot;built_in&quot;&gt;NSIndexPath&lt;/span&gt; *)indexPath &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TableViewCellVO *cellVO = cellVOArray[indexPath.row];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cellVO.cellHeight&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;优点：行高与 cell 内的各控件尺寸都提前计算好，在执行 &lt;code&gt;cellForRowAtIndexPath:&lt;/code&gt; 方法和 &lt;code&gt;heightForRowAtIndexPath:&lt;/code&gt; 方法时比较快，且行高得到缓存，避免了冗余的计算。&lt;/li&gt;
&lt;li&gt;缺点：在从网络或者本地缓存拿到数据之后，执行 &lt;code&gt;[self.tableView reloadData];&lt;/code&gt; 之前需要花费时间处理数据及计算 fream。这里需要谨慎处理数据，可以采用多线程等技术缩短数据处理的时间。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因为在数据处理上所花费的时间要远小于页面滚动时所消耗的时间。凡是涉及页面的操作都是相当耗费时间的，相比而言对于 cpu 在处理数据上的时间就可以忽略不计了，毕竟我们所要处理的数据都不会太大，如果数据过多的话可以做分次获取处理（下拉刷新操作），所以这里的缺点相对于上一种方法还是可以忍受的。&lt;/p&gt;
&lt;h1 id=&quot;XIB-方式处理-UITableViewCell-的行高问题&quot;&gt;&lt;a href=&quot;#XIB-方式处理-UITableViewCell-的行高问题&quot; class=&quot;headerlink&quot; title=&quot;XIB 方式处理 UITableViewCell 的行高问题&quot;&gt;&lt;/a&gt;XIB 方式处理 UITableViewCell 的行高问题&lt;/h1&gt;&lt;p&gt;对于纯 Code 和 SB 方式的页面布局问题业界已经相爱相杀了很久，各有各的道理。我的观点是：哪种布局方式适合自己就好了，看个人喜好。相比于 SB 的“所见即所得”，快速布局等，我个人更喜欢纯 Code 的方式，对代码的可控性更强（亦不排除我个人是比较喜欢 Coding 的因素）。&lt;br&gt;不过，如果你是偏好 SB 的布局方式，采用 XIB 方式处理 UITableViewCell，那么你可以看看&lt;a href=&quot;http://blog.sunnyxx.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;sunnyxx&lt;/a&gt; 的 &lt;a href=&quot;https://github.com/forkingdog/UITableView-FDTemplateLayoutCell&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;UITableView-FDTemplateLayoutCell&lt;/a&gt;（点击可查看&lt;a href=&quot;https://github.com/forkingdog/UITableView-FDTemplateLayoutCell&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;）这种解决方案。&lt;br&gt;而且，本文的前一部分也参考了 &lt;a href=&quot;http://blog.sunnyxx.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;sunnyxx&lt;/a&gt; 的这篇博客 &lt;a href=&quot;http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;优化UITableViewCell高度计算的那些事
&lt;/a&gt;，推荐阅读。&lt;/p&gt;
&lt;h1 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2017/07/05/cell-height&quot;&gt;http://gonghonglou.com/2017/07/05/cell-height&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;当我还是小白时（比现在更白的时候）对于 UITableViewCell 的行高问题还是比较头疼的，当然这个算是 iOS 开发中相当基础的内容了，但是当时的我就想过，将 UITableViewCell 的行高问题解决了一定写一篇总结博客，所以就有了这篇博客。尽管拖了这。么。久
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>Say Bye 2016</title>
    <link href="http://gonghonglou.com/2016/12/26/saybye2016/"/>
    <id>http://gonghonglou.com/2016/12/26/saybye2016/</id>
    <published>2016-12-26T10:29:37.000Z</published>
    <updated>2017-03-14T02:28:11.000Z</updated>
    
    <content type="html">&lt;p&gt;嘿，不觉间 2016 马上就要结束了，&lt;br&gt;所以，这一年你都干了啥？&lt;/p&gt;
&lt;p&gt;2016 年，最大的变动就是毕了业，十六年的求学历程 结束了，&lt;br&gt;然后，从一名学生变成了员工！&lt;/p&gt;
&lt;h2 id=&quot;怀念&quot;&gt;&lt;a href=&quot;#怀念&quot; class=&quot;headerlink&quot; title=&quot;怀念&quot;&gt;&lt;/a&gt;怀念&lt;/h2&gt;&lt;p&gt;毕业了，才发现真的会怀念学生时代。&lt;/p&gt;
&lt;p&gt;早晨拖着身子爬起来上课，然而课上少有听讲，就那样浪费着时间蚕食着生命，可那也是我的大学生活啊，不再有的挥霍时光。&lt;br&gt;到学校食堂吃饭，乌泱泱的人群，打饭都要先占座，可以的，那也是我怀念的。&lt;br&gt;每学期的宿舍聚餐、班级聚会、元旦晚会，终究会怀念身处群体中的日子，和身处公司不同。真心希望有一天会在社会团体中找到校园中的集体感，大概就像 Nicholas Tse 描述的 PO 那样的团体吧，如果是自己建立的就最完美了，Fighting ！&lt;br&gt;做学生时没有发现，原来这个社会对于学生的照顾这么多，电话费、住宿费、食堂、车票、景区门票等等等等这些有形的和那些无形的对于「学生」这一称号，每每感受到这一点在小小怀念学生时代之外都会多少感概这个社会还是很美好的，嗯。&lt;br&gt;毕业后每当看到朋友圈有人晒出学校照片都会特别感概真想回去看看，当初吃够了的商业街现在也是很怀念扬州炒饼和如意捞的火锅小料。 &lt;/p&gt;
&lt;p&gt;期待未知年后的大学聚会，我们校园一聚。&lt;/p&gt;
&lt;h2 id=&quot;选择&quot;&gt;&lt;a href=&quot;#选择&quot; class=&quot;headerlink&quot; title=&quot;选择&quot;&gt;&lt;/a&gt;选择&lt;/h2&gt;&lt;p&gt;2016 年 1 月 11 日实习入职，马上我也要工作满一年了呢。当时找工作时收到了几份 offer ，最终选择了卓骥（现在的公司），也很幸运遇到了卓骥： &lt;/p&gt;
&lt;p&gt;1、实习入职的第二天就开始负责写 iPad 项目重构版的网络请求库。&lt;br&gt;2、实习结束回学校前的一个月开始接手整个 iPad 项目的重构版本。&lt;br&gt;3、正式入职后花费了四个月的时间完成了 iPad 项目重构的大部分内容。&lt;br&gt;4、紧接着接手了公司所有 iOS 业务（ iPad 和 iTouch 端）。&lt;br&gt;5、之后很快将会进行 iTouch 项目的重构&lt;/p&gt;
&lt;p&gt;这些都让我觉得：当初的选择没错。     &lt;/p&gt;
&lt;h2 id=&quot;成绩&quot;&gt;&lt;a href=&quot;#成绩&quot; class=&quot;headerlink&quot; title=&quot;成绩&quot;&gt;&lt;/a&gt;成绩&lt;/h2&gt;&lt;p&gt;2016，应该是我技术道路的正式开端，因为这些，所以还不算荒废：&lt;/p&gt;
&lt;p&gt;1、算上这篇，今年该是写了十二篇博客。不像那些大 V 的博客对于求学者有较高的技术学习和参考价值，迄今为止「与佳期的个人博客」的主要内容或者功能应该是给自己的技术总结吧。切身体会对于很多技术，代码实现和博客输出还是有很大差距的，开始写某项技术博客前以为对该项技术已经掌握了，开始后和结束后才发现自己 too young too simple ，每篇技术博客写下来都觉得获益匪浅能学到更多知识，即便这样我也深知还仅是皮毛而已。继续努力吧，希望以后自己的博客输出也能在技术深度上对别人有所帮助和影响。&lt;br&gt;2、顺利完成毕业设计，还要感谢马根老师（我的学术指导老师）我的毕业设计也是做的 iOS 的一款跳蚤市场类软件。&lt;br&gt;3、完成了公司 iPad 项目重构版的网络请求库的开发。熟悉了网络请求、数据解析和部分缓存操作。&lt;br&gt;4、完成了公司 iPad 的重构项目，主要代码成绩就是这个了，花费了约四五个月的时间，大部分的技术成长也都在这里了，从控件使用、页面布局、业务实现到设计模式、工程架构。&lt;br&gt;5、接手公司所有 iOS 业务（ iPad 和 iTouch 端）。主要成长了 Debug 的能力吧以及对公司业务的熟悉。&lt;br&gt;6、上线了一款个人 App：&lt;a href=&quot;https://itunes.apple.com/us/app/rder/id1178545654?l=zh&amp;amp;ls=1&amp;amp;mt=8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RDER&lt;/a&gt;，一款轻量极简的 RSS 订阅软件。大概有七八千行代码，虽然软件简单但是一点一滴都是自己细心雕琢的，因为这款软件也了解了关于一款软件上线的所有流程，而且用到了 relam ，和 sqlite 有了比较。&lt;/p&gt;
&lt;p&gt;以上，今年大概写了有近十万行代码。&lt;/p&gt;
&lt;h2 id=&quot;幸运&quot;&gt;&lt;a href=&quot;#幸运&quot; class=&quot;headerlink&quot; title=&quot;幸运&quot;&gt;&lt;/a&gt;幸运&lt;/h2&gt;&lt;p&gt;一直都觉得自己少有努力，更多是幸运。 &lt;/p&gt;
&lt;p&gt;大一大二浑浑噩噩度过了两年，大二末总觉得该做点什么，所以办了个兼职中心，起名「曙光」。希望更多和我一样在大学迷茫的同学们能够因此看到方向，至少生活不再荒诞。然而最终也没办成个样子，现在看来那种职业生活的确不是我喜欢的，所以没有成样子也是有原因的。可也正因为这个兼职中心才让我遇到了马根老师（还要多谢班主任盛莉老师的引荐），遇到了编程，遇到了 iOS ，遇到了自己真正喜欢的东西。&lt;/p&gt;
&lt;p&gt;大三到大四有近一年的时间都待在马老师的实验室里，机电楼 C 228。这间实验并不是开放实验室，偶尔有班级过来做实验的时间我就会带电脑到图书馆，所以大部分时间实验室只有我一个人在，偶尔晚上马老师也在。早上八九点钟吃过早饭到实验室，然后午饭、晚饭，晚上大概十点半十一点回宿舍，就这样日复一日匆匆过了一年。没有无聊反而一直很充实。那时候打开浏览器真的就感觉“徜徉在（互联网的）知识的海洋里”，那是我上了十几年学第一次有“知识的海洋”的概念。&lt;br&gt;经过物联网 -&amp;gt; 计算机 -&amp;gt; 前端 -&amp;gt; iOS -&amp;gt; Objective-C 这一层层，要学的知识仍然像“海洋”一样望不到头，每天都是鼓足干劲的学习这些编程技术，从最基础的编程基础开始，for 循环、页面布局、多线程、数据库、网络编程、设计模式、开源代码……每阶段都有学不完的技术。当然也不是一直热情高涨，最受打击的应该是在继续学习的路上，对于刚开始一块崭新技术的迷惑，比如多线程和数据库，刚开始接触的时候真的是一脸懵逼，切身体会在那种时候一份基础系统的学习资料有多重要，一份好的技术博客或者技术文档有多重要！&lt;/p&gt;
&lt;p&gt;总感觉自己是幸运的：&lt;br&gt;幸运的在大学快结束的时候找到了自己喜欢的东西；&lt;br&gt;幸运的来到上海在上海海事大学和上海大学秋季招聘会上拿到了几份 offer ；&lt;br&gt;幸运的在这几份 offer 里遇见的现在的公司—卓骥，才有了上边的“这些都让我觉得：当初的选择没错。”     &lt;/p&gt;
&lt;p&gt;幸运的父母都在上海可以住在一起；&lt;br&gt;幸运的和父母住在一起不必负担房租；&lt;br&gt;幸运的和父母住在一起连生活费都省了。&lt;br&gt;因为这接连的三个幸运才能把钱攒起来一分不剩的花在了自己任性花的地方。而且我一直觉得迈入社会的第一年是我们人生负担最小收入最低的一年，如果说是要轻奢生活不虑积蓄，那这一年应该是最合适的时间了，所以我做了一名合格的月光族，有（了）钱任性所以真的是一分不剩。。。 &lt;/p&gt;
&lt;h2 id=&quot;遗憾&quot;&gt;&lt;a href=&quot;#遗憾&quot; class=&quot;headerlink&quot; title=&quot;遗憾&quot;&gt;&lt;/a&gt;遗憾&lt;/h2&gt;&lt;p&gt;1、生活上，以往的宿舍聚餐。&lt;/p&gt;
&lt;p&gt;离开学校的前一天晚上宿舍最后一次聚餐，我们拿着班里分得的班费找了一家烧烤狠搓了一顿，胡吃海喝侃天侃地。那天说了好多话，而以往的宿舍聚餐因为酒量原因和吃货基因大家很少喝酒只顾吃吃吃，这应该就是最遗憾的了。&lt;br&gt;只有喝了酒大家才能推心置腹吧，所以那晚喝了很多酒，带着怀念和不舍，口口声声说着我们再聚再聚。曾经你让我不爽我让你不快的事如今都成了加深我们情义的助力。我们吹牛打屁的时候顿顿默默带了一波节奏，人高马大的他竟然落了几滴猫尿，我看到后立马大笑指着他：“卧槽，你竟然…” 然后突然哽咽，同样泪流不止。&lt;br&gt;那天喝的很真心。&lt;/p&gt;
&lt;p&gt;小插曲：第二天起床就吐了还带着块块“血色”，肠胃一直不好上次喝酒吐了一夜胆汁，这次竟然吐了血，吓坏了。可是毕业离校不想让室友们担心所以装作无事。此事过了个把月知乎上看到那个笑话才会回忆起，那晚喝过酒回宿舍好像顺便买了个西瓜。&lt;br&gt;哈，哈哈哈哈……&lt;/p&gt;
&lt;p&gt;2、技术上，遇到编程的时间太晚。&lt;/p&gt;
&lt;p&gt;在大三初开始接触编程，上学期一直在入门 Java ，因为是刚入门所以进度很慢。看了一学期的 Java 大概熟悉了编程语言基础，对于移动端有 iOS 和 Android 两大阵营，都想学可是显然时间来不及，所以选择了逼格略高且逼格高就是我所爱的 iOS 。即便如此，学习 iOS 的时间也只有大三下学期到大四上学期，15 年大约十月底十一月就开始找工作了。&lt;br&gt;所以大学里学习 iOS 的时间太短，编程生涯开始的太晚。如果可以早一年甚至两年的话至少在毕业时对于应聘这件事会游刃有余的多吧。&lt;/p&gt;
&lt;h2 id=&quot;计划&quot;&gt;&lt;a href=&quot;#计划&quot; class=&quot;headerlink&quot; title=&quot;计划&quot;&gt;&lt;/a&gt;计划&lt;/h2&gt;&lt;p&gt;有了大学技术起步晚的遗憾，现在怎么能不早点做打算。&lt;/p&gt;
&lt;p&gt;年初的时候大概有了自己的第一个“五年计划”：两年上海，两年北京，2020 年的时候稳定于杭州。至于届时是买房买车平淡安稳的上班生活还是破釜沉舟不甘平庸的技术创业，就在下一个“五年计划”里决定吧，无论哪种，对这五年来说主要目的就是技术积累。然而在毕业的那段时间还是感觉又落入了类大学迷茫期的循环，接下来的五年除了积累技术还应该往什么方向思考。&lt;br&gt;大学：除了学习学习还能干嘛？&lt;br&gt;毕业：除了技术技术还能干嘛？&lt;br&gt;在接下来的五年能否像大学末期幸运的找到兴趣职业那样也幸运的找到兴趣事业呢？而且既然有了上边的技术遗憾当然是想越早发现越早准备的好。&lt;/p&gt;
&lt;p&gt;现在，马上就到年底了心里也大概有了底，虽然不够坚信但至少有了大致的方向。我们都很脆弱当然想尽量避免事业的打击，还好还有一段时间可以慢慢谋取，还好这一点在技术上是有优势的。&lt;br&gt;16 年就要结束了，接下来就是 “1+2”，此处省略三年的时间……&lt;/p&gt;
&lt;p&gt;总要有一些更实际有生活的计划：        &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;旅行：&lt;br&gt;（或）1、三月份去趟黄山，2、五月份骑行青海湖，3、十月份去趟拉萨&lt;/li&gt;
&lt;li&gt;读书：&lt;br&gt;1、技术书籍，2、龙应台的书， 3、其他一些小说&lt;/li&gt;
&lt;li&gt;技术：&lt;br&gt;1、维护更新 &lt;a href=&quot;https://itunes.apple.com/us/app/rder/id1178545654?l=zh&amp;amp;ls=1&amp;amp;mt=8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RDER&lt;/a&gt; ，2、写一款第三方微博客户端，3、更新技术博客，4、写一款牛逼的工具类 App（如果来得及）        &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;呼～工作量还真不小，时间真的蛮紧张，撸开袖子，干吧！ &lt;/p&gt;
&lt;p&gt;相信天空和大海，对于你，全是未来！&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/saybye2016/FullSizeRender.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;嘿，不觉间 2016 马上就要结束了，&lt;br&gt;所以，这一年你都干了啥？&lt;/p&gt;
&lt;p&gt;2016 年，最大的变动就是毕了业，十六年的求学历程 结束了，&lt;br&gt;然后，从一名学生变成了员工！&lt;/p&gt;
&lt;h2 id=&quot;怀念&quot;&gt;&lt;a href=&quot;#怀念&quot; class=&quot;headerl
    
    </summary>
    
      <category term="Life" scheme="http://gonghonglou.com/categories/Life/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS应用程序语言本地化及应用内语言设置</title>
    <link href="http://gonghonglou.com/2016/10/29/set-language/"/>
    <id>http://gonghonglou.com/2016/10/29/set-language/</id>
    <published>2016-10-29T14:18:38.000Z</published>
    <updated>2017-07-24T04:12:54.000Z</updated>
    
    <content type="html">&lt;p&gt;Xcode 新建一个工程的默认语言是英文，所以你在 app 里粘贴复制都是显示的 &lt;code&gt;copy&lt;/code&gt; &lt;code&gt;paste&lt;/code&gt;，你可以通过在 &lt;code&gt;info.plst&lt;/code&gt; 文件里选择 &lt;code&gt;Localization native development region&lt;/code&gt; 来设置不同语言。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/setlanguage/info_language.png&quot; alt=&quot;info.plst&quot;&gt;&lt;/p&gt;
&lt;p&gt;可是如果你想在软件内选择设置语言，为软件添加多语言选择功能就需要一番折腾了，倒也简单，只不过还是有几个坑的。以下是一篇详细介绍为软件配置多语言选项的博客，走起 ➜ ➜ ➜&lt;/p&gt;
&lt;h2 id=&quot;关于-NSBundle&quot;&gt;&lt;a href=&quot;#关于-NSBundle&quot; class=&quot;headerlink&quot; title=&quot;关于 NSBundle&quot;&gt;&lt;/a&gt;关于 NSBundle&lt;/h2&gt;&lt;p&gt;在开始正式文章之前你或许应当先搞明白 &lt;code&gt;NSBundle&lt;/code&gt; 是什么东西。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Bundle&lt;/code&gt; 是一个目录，其中包含了在程序会使用到的资源，包含了如图像、声音、程序中需要用到的文件，甚至是编译好的代码等等。而在实现软件内配置语言的时候就是通过 &lt;code&gt;Bundle&lt;/code&gt; 的路径去获取配置文件，根据这个配置文件取出对应的字体渲染到 view 上。&lt;/p&gt;
&lt;p&gt;当然，配置程序语言只是 &lt;code&gt;Bundle&lt;/code&gt; 的一种用途。还可以用 &lt;code&gt;Bundle&lt;/code&gt; 去获取工程中 &lt;code&gt;info.plist&lt;/code&gt; 的详细信息，比如：&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取版本号：Bundle Short Version&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *shortVersion = [[[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] infoDictionary] objectForKey:&lt;span class=&quot;string&quot;&gt;@&quot;CFBundleShortVersionString&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取版本号：Bundle version&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *version = [[[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] infoDictionary] objectForKey:&lt;span class=&quot;string&quot;&gt;@&quot;CFBundleVersion&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取应用标识：Bundle identifier&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *bundleIdentifier = [[[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] infoDictionary] objectForKey:&lt;span class=&quot;string&quot;&gt;@&quot;CFBundleIdentifier&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取应用名称：Bundle display name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *bundleDisplayName = [[[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] infoDictionary] objectForKey:&lt;span class=&quot;string&quot;&gt;@&quot;CFBundleDisplayName&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取Bundle name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *bundleName = [[[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] infoDictionary] objectForKey:&lt;span class=&quot;string&quot;&gt;@&quot;CFBundleDisplayName&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取 app 包路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *path = [[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] bundlePath];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取 app 资源目录路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *resPath = [[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] resourcePath];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;大概明白 &lt;code&gt;NSBundle&lt;/code&gt; 是怎么回事了吧，接下来就正式开始应用程序语言本地化及应用内语言设置。&lt;/p&gt;
&lt;h2 id=&quot;配置-Project&quot;&gt;&lt;a href=&quot;#配置-Project&quot; class=&quot;headerlink&quot; title=&quot;配置 Project&quot;&gt;&lt;/a&gt;配置 Project&lt;/h2&gt;&lt;h3 id=&quot;添加语言&quot;&gt;&lt;a href=&quot;#添加语言&quot; class=&quot;headerlink&quot; title=&quot;添加语言&quot;&gt;&lt;/a&gt;添加语言&lt;/h3&gt;&lt;p&gt;如下图，点击 &lt;code&gt;PROJECT&lt;/code&gt; -&amp;gt; &lt;code&gt;info&lt;/code&gt; -&amp;gt; &lt;code&gt;Localizations&lt;/code&gt; 这里默认只有 &lt;code&gt;English&lt;/code&gt; 点击下方的加号可以添加你想要的语言，比如这里添加的中文 Chinese(Simplifid) 。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意： &lt;code&gt;zh-Hans&lt;/code&gt; 是简体中文， &lt;code&gt;zh-Hant&lt;/code&gt; 是繁体中文。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/setlanguage/set_project.png&quot; alt=&quot;配置Project&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;新建-strings-配置文件&quot;&gt;&lt;a href=&quot;#新建-strings-配置文件&quot; class=&quot;headerlink&quot; title=&quot;新建 .strings 配置文件&quot;&gt;&lt;/a&gt;新建 .strings 配置文件&lt;/h3&gt;&lt;p&gt;1、&lt;code&gt;Command + N&lt;/code&gt; 新建 &lt;code&gt;Strings File&lt;/code&gt; 文件，命令为 &lt;code&gt;RDLocalizable&lt;/code&gt; ，会生成一份 &lt;code&gt;RDLocalizable.strings&lt;/code&gt; 文件。 &lt;/p&gt;
&lt;p&gt;2、选中&lt;code&gt;RDLocalizable.strings&lt;/code&gt; 文件，如下图操作，点击  &lt;code&gt;Localize...&lt;/code&gt; 按钮，左侧弹框中选择语言。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/setlanguage/localizable.png&quot; alt=&quot;Localize...&quot;&gt;&lt;/p&gt;
&lt;p&gt;3、之后右侧会如下图显示，勾选上你想要的语言即可（&lt;code&gt;Base&lt;/code&gt; 无用）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/setlanguage/Localization.png&quot; alt=&quot;Localization&quot;&gt;&lt;/p&gt;
&lt;p&gt;4、当勾选两门语言后，会发现&lt;code&gt;RDLocalizable.strings&lt;/code&gt; 文件可以展开并存在两个配置文件，一份英文，一份中文。&lt;br&gt;分别在两个文件内输入对应的语言，比如在英文文件里输入：&lt;br&gt;&lt;figure class=&quot;highlight mipsasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;收录&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;Collection&quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;订阅&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;Subscription&quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;我的&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;Mine&quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;中文文件里输入：&lt;br&gt;&lt;figure class=&quot;highlight mipsasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;收录&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;收录&quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;订阅&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;订阅&quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;我的&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;我的&quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;前边对应 键(key) ，后边对各个语言的 值(value)。看后面的  &lt;strong&gt; 使用方法 &lt;/strong&gt;  就会明白了。&lt;/p&gt;
&lt;p&gt;至此，对工程的配置已经完成。接下来要做的就是获取软件语言、设置语言、监听语言改变。。。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/cheaptalk.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;创建多语言设置工具类&quot;&gt;&lt;a href=&quot;#创建多语言设置工具类&quot; class=&quot;headerlink&quot; title=&quot;创建多语言设置工具类&quot;&gt;&lt;/a&gt;创建多语言设置工具类&lt;/h2&gt;&lt;p&gt;因为该工具类比较简单，直接将代码贴出来吧，后面会介绍一些坑。因为是一个继承于 &lt;code&gt;NSObject&lt;/code&gt; 的工具类，都是使用类方法实现功能，以便类名直接调用。&lt;/p&gt;
&lt;p&gt;头文件.h&lt;br&gt;&lt;figure class=&quot;highlight arduino&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  RDLocalizableController.h&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  rder&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  Created by gonghonglou on 2016/10/29.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  Copyright © 2016年 gonghonglou. All rights reserved.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#import &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;Foundation/Foundation.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; RDLanguageKey @&lt;span class=&quot;string&quot;&gt;&quot;userLanguage&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; RDCHINESE @&lt;span class=&quot;string&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; RDENGLISH @&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; RDNotificationLanguageChanged @&lt;span class=&quot;string&quot;&gt;&quot;rdLanguageChanged&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; RDLocalizedString(key)  [[RDLocalizableController bundle] localizedStringForKey:(key) value:@&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; table:@&lt;span class=&quot;string&quot;&gt;&quot;RDLocalizable&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@interface RDLocalizableController : NSObject&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *  获取当前资源文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (NSBundle *)bundle;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *  初始化语言文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)initUserLanguage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *  获取应用当前语言&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (NSString *)userLanguage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *  设置当前语言&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setUserlanguage:(NSString *)language;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@&lt;span class=&quot;built_in&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;实现文件.m&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  RDLocalizableController.m&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  rder&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  Created by gonghonglou on 2016/10/29.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//  Copyright © 2016年 gonghonglou. All rights reserved.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#import &lt;span class=&quot;meta-string&quot;&gt;&quot;RDLocalizableController.h&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; RDLocalizableController *currentLanguage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;RDLocalizableController&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; *bundle = &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取当前资源文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; *)bundle&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; bundle;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 初始化语言文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)initUserLanguage&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *languageString = [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] valueForKey:RDLanguageKey];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(languageString.length == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 获取系统当前语言版本&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *languagesArray = [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] objectForKey:&lt;span class=&quot;string&quot;&gt;@&quot;AppleLanguages&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        languageString = languagesArray.firstObject;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] setValue:languageString forKey:&lt;span class=&quot;string&quot;&gt;@&quot;userLanguage&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] synchronize];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 避免缓存会出现 zh-Hans-CN 及其他语言的的情况&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([[RDLocalizableController chinese] containsObject:languageString]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        languageString = [[RDLocalizableController chinese] firstObject]; &lt;span class=&quot;comment&quot;&gt;// 中文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([[RDLocalizableController english] containsObject:languageString]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        languageString = [[RDLocalizableController english] firstObject]; &lt;span class=&quot;comment&quot;&gt;// 英文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        languageString = [[RDLocalizableController chinese] firstObject]; &lt;span class=&quot;comment&quot;&gt;// 其他默认为中文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 获取文件路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *path = [[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] pathForResource:languageString ofType:&lt;span class=&quot;string&quot;&gt;@&quot;lproj&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 生成bundle&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    bundle = [&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; bundleWithPath:path];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 英文类型数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *)english &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; @[&lt;span class=&quot;string&quot;&gt;@&quot;en&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 中文类型数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *)chinese&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; @[&lt;span class=&quot;string&quot;&gt;@&quot;zh-Hans&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;@&quot;zh-Hant&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取应用当前语言&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)userLanguage &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *languageString = [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] valueForKey:RDLanguageKey];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; languageString;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 设置当前语言&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setUserlanguage:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)language &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;([[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; userLanguage] isEqualToString:language]) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 改变bundle的值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *path = [[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] pathForResource:language ofType:&lt;span class=&quot;string&quot;&gt;@&quot;lproj&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    bundle = [&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; bundleWithPath:path];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 持久化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] setValue:language forKey:RDLanguageKey];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [[&lt;span class=&quot;built_in&quot;&gt;NSUserDefaults&lt;/span&gt; standardUserDefaults] synchronize];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [[&lt;span class=&quot;built_in&quot;&gt;NSNotificationCenter&lt;/span&gt; defaultCenter] postNotificationName:RDNotificationLanguageChanged object:currentLanguage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;使用方法：&lt;/p&gt;
&lt;p&gt;1、在 &lt;code&gt;AppDelegate&lt;/code&gt; 的 &lt;code&gt;- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&lt;/code&gt; 方法里初始化该工具类，并监听通知：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 语言初始化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-attr&quot;&gt;[RDLocalizableController initUserLanguage]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 监控语言切换&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-attr&quot;&gt;[[NSNotificationCenter defaultCenter]&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;addObserver&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:self&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;selector&lt;/span&gt;:@&lt;span class=&quot;selector-tag&quot;&gt;selector&lt;/span&gt;(&lt;span class=&quot;attribute&quot;&gt;languageChange&lt;/span&gt;:) &lt;span class=&quot;selector-tag&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:RDNotificationLanguageChanged&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;2、记得在 &lt;code&gt;- (void)applicationWillTerminate:(UIApplication *)application&lt;/code&gt;方法里删除通知：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-attr&quot;&gt;[[NSNotificationCenter defaultCenter]&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;removeObserver&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:self&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:RDNotificationLanguageChanged&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;3、实现通知方法：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;-&lt;/span&gt; (void)&lt;span class=&quot;selector-tag&quot;&gt;languageChange&lt;/span&gt;&lt;span class=&quot;selector-pseudo&quot;&gt;:(NSNotification&lt;/span&gt; *)&lt;span class=&quot;selector-tag&quot;&gt;note&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 在该方法里实现重新初始化 rootViewController 的行为，并且所有带有文字的页面都要重新渲染&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 比如：[UIApplication sharedApplication].keyWindow.rootViewController = ...;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;4、使用 &lt;code&gt;RDLocalizedString(&amp;lt;#key#&amp;gt;)&lt;/code&gt;方法 给所有文字添加本地化语言方法：&lt;br&gt;&lt;figure class=&quot;highlight mipsasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;label&lt;span class=&quot;meta&quot;&gt;.text&lt;/span&gt; = RDLocalizedString(@&lt;span class=&quot;string&quot;&gt;&quot;收录&quot;&lt;/span&gt;)&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;button &lt;/span&gt;setTitle:RDLocalizedString(@&lt;span class=&quot;string&quot;&gt;&quot;订阅&quot;&lt;/span&gt;) forState:UIControlStateNormal]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;5、更改语言方法：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 设置中文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-attr&quot;&gt;[RDLocalizableController setUserlanguage:RDCHINESE]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 设置英文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-attr&quot;&gt;[RDLocalizableController setUserlanguage:RDENGLISH]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;至此，对于应用程序语言本地化及应用内语言设置的功能就已经可以实现了。接下来是对遇到的几个坑的说明。&lt;/p&gt;
&lt;h2 id=&quot;多语言设置的「坑」&quot;&gt;&lt;a href=&quot;#多语言设置的「坑」&quot; class=&quot;headerlink&quot; title=&quot;多语言设置的「坑」&quot;&gt;&lt;/a&gt;多语言设置的「坑」&lt;/h2&gt;&lt;h3 id=&quot;关于更改语言后重新初始化页面&quot;&gt;&lt;a href=&quot;#关于更改语言后重新初始化页面&quot; class=&quot;headerlink&quot; title=&quot;关于更改语言后重新初始化页面&quot;&gt;&lt;/a&gt;关于更改语言后重新初始化页面&lt;/h3&gt;&lt;p&gt;语言更改后，要重新渲染view，所以应该在更改语言之后回到根目录。不仅页面需要初始化，如果页面数据在 &lt;code&gt;viewModel&lt;/code&gt; 里，那么该 &lt;code&gt;viewModel&lt;/code&gt; 也应当初始化，因为字体是 &lt;code&gt;RDLocalizedString(&amp;lt;#key#&amp;gt;)&lt;/code&gt; 这个方法从 &lt;code&gt;.strings&lt;/code&gt; 配置文件里取出来的，更改语言后必须重新取一次。&lt;/p&gt;
&lt;p&gt;当然也不是一定要留在根目录，有几种页面友好的解决方案：&lt;/p&gt;
&lt;p&gt;1、更改语言功能一般会放在「我的」页面 &lt;code&gt;push&lt;/code&gt; 出来的某一级页面，可以初始化 &lt;code&gt;rootViewController&lt;/code&gt; 并且将之前 &lt;code&gt;push&lt;/code&gt; 出来的几级 &lt;code&gt;viewController&lt;/code&gt; 手动添加到 &lt;code&gt;mineViewController.navigationController.viewControllers&lt;/code&gt; 这个数组中。这样页面就不会产生太大的错落感。&lt;/p&gt;
&lt;p&gt;2、在每一个页面写一个检测语言改变的通知的方法。当接受到通知后就将该页面重新布局一次以更改字体。&lt;/p&gt;
&lt;p&gt;PS：在这个问题上，感觉支付宝比微信做的界面跳转友好的多。。。&lt;/p&gt;
&lt;h3 id=&quot;关于本地化语言的宏定义-RDLocalizedString-lt-key-gt&quot;&gt;&lt;a href=&quot;#关于本地化语言的宏定义-RDLocalizedString-lt-key-gt&quot; class=&quot;headerlink&quot; title=&quot;关于本地化语言的宏定义 RDLocalizedString(&amp;lt;#key#&amp;gt;)&quot;&gt;&lt;/a&gt;关于本地化语言的宏定义 &lt;code&gt;RDLocalizedString(&amp;lt;#key#&amp;gt;)&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;系统自带的方法是：&lt;code&gt;NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;)&lt;/code&gt;，这也是一份宏定义：&lt;br&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;#def&lt;/span&gt;ine NSLocalizedString(key, comment) \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	    [NSBundle&lt;span class=&quot;selector-class&quot;&gt;.mainBundle&lt;/span&gt; localizedStringForKey:(key) value:@&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;table&lt;/span&gt;:nil]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;能看到它调用的是 &lt;code&gt;NSBundle.mainBundle&lt;/code&gt; ，而我们在更改语言的工具类里的 &lt;code&gt;bundle&lt;/code&gt; 已经更改了。&lt;br&gt;所以系统的 &lt;code&gt;NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;)&lt;/code&gt; 已经失效，必须重写一份宏定义：&lt;br&gt;&lt;figure class=&quot;highlight q&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#define RDLocalizedString(&lt;span class=&quot;built_in&quot;&gt;key&lt;/span&gt;)  [[RDLocalizableController bundle] localizedStringForKey:(&lt;span class=&quot;built_in&quot;&gt;key&lt;/span&gt;) &lt;span class=&quot;built_in&quot;&gt;value&lt;/span&gt;:@&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; table:@&lt;span class=&quot;string&quot;&gt;&quot;RDLocalizable&quot;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;1、必须使用自己的类名来调用类方法 &lt;code&gt;[RDLocalizableController bundle]&lt;/code&gt; 以获取自己的  &lt;code&gt;bundle&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2、&lt;code&gt;table&lt;/code&gt; 后的参数为 &lt;code&gt;.strings&lt;/code&gt; 文件的文件名，若你创建的文件名为 &lt;code&gt;Localizable.strings&lt;/code&gt; ，则该参数可为 &lt;code&gt;nil&lt;/code&gt; ，系统默认按 &lt;code&gt;Localizable.strings&lt;/code&gt; 查找。否则必须配置文件名，且只是文件名，不加 &lt;code&gt;.stringd&lt;/code&gt; 后缀。&lt;/p&gt;
&lt;h3 id=&quot;关于初始化语言-RDLocalizableController-initUserLanguage&quot;&gt;&lt;a href=&quot;#关于初始化语言-RDLocalizableController-initUserLanguage&quot; class=&quot;headerlink&quot; title=&quot;关于初始化语言 [RDLocalizableController initUserLanguage]&quot;&gt;&lt;/a&gt;关于初始化语言 &lt;code&gt;[RDLocalizableController initUserLanguage]&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;在 &lt;code&gt;initUserLanguage&lt;/code&gt; 方法中有这样一段代码来做判断&lt;/p&gt;
&lt;figure class=&quot;highlight inform7&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;if (&lt;span class=&quot;comment&quot;&gt;[&lt;span class=&quot;comment&quot;&gt;[RDLocalizableController chinese]&lt;/span&gt; containsObject:languageString]&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    languageString = &lt;span class=&quot;comment&quot;&gt;[&lt;span class=&quot;comment&quot;&gt;[RDLocalizableController chinese]&lt;/span&gt; firstObject]&lt;/span&gt;; // 中文&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; else if (&lt;span class=&quot;comment&quot;&gt;[&lt;span class=&quot;comment&quot;&gt;[RDLocalizableController english]&lt;/span&gt; containsObject:languageString]&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    languageString = &lt;span class=&quot;comment&quot;&gt;[&lt;span class=&quot;comment&quot;&gt;[RDLocalizableController english]&lt;/span&gt; firstObject]&lt;/span&gt;; // 英文&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    languageString = &lt;span class=&quot;comment&quot;&gt;[&lt;span class=&quot;comment&quot;&gt;[RDLocalizableController chinese]&lt;/span&gt; firstObject]&lt;/span&gt;; // 其他默认为中文&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;各位可能会对这个判断比较疑惑，在这之前已经有判断了：先获取用户设置的语言，有则使用用户设置的语言，没有则使用系统语言。&lt;/p&gt;
&lt;p&gt;然而因为某些原因用户设置过的语言（如：&lt;code&gt;zh-Hans&lt;/code&gt;）会在另一个相同工程运行之后将该语言更改为&lt;code&gt;zh-Hans-CZ&lt;/code&gt;；或者用户将系统语言设置为日本语或其他语言。&lt;/p&gt;
&lt;p&gt;出现以上情况时 &lt;code&gt;RDLocalizedString(&amp;lt;#key#&amp;gt;)&lt;/code&gt; 这个方法从 &lt;code&gt;.strings&lt;/code&gt; 配置文件里是去不到对应的字体，就会返回空。&lt;br&gt;后果轻则页面一片空白了，重则直接 crash ，如：&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;NSArray *&lt;span class=&quot;built_in&quot;&gt;array&lt;/span&gt; = @[RDLocalizedString(@&lt;span class=&quot;string&quot;&gt;&quot;收录&quot;&lt;/span&gt;), RDLocalizedString(@&lt;span class=&quot;string&quot;&gt;&quot;订阅&quot;&lt;/span&gt;), RDLocalizedString(@&lt;span class=&quot;string&quot;&gt;&quot;我的&quot;&lt;/span&gt;)]; &lt;span class=&quot;comment&quot;&gt;// 数组不能存空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;就想使用-NSLocalizedString-lt-key-gt-lt-comment-gt-方法&quot;&gt;&lt;a href=&quot;#就想使用-NSLocalizedString-lt-key-gt-lt-comment-gt-方法&quot; class=&quot;headerlink&quot; title=&quot;就想使用 NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;) 方法&quot;&gt;&lt;/a&gt;就想使用 NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;) 方法&lt;/h2&gt;&lt;p&gt;1、有一种极端情况，比如：软件需要配置多国语言，很多很多的那一种。。。在 &lt;code&gt;.strings&lt;/code&gt; 文件里配置了许多国家的语言。然而在软件内部只提供中文、英文等某几种语言，其他语言根据系统语言自适应。不想在 &lt;code&gt;initUserLanguage&lt;/code&gt; 方法里做一大堆的乱七八糟的判断。只要在 &lt;code&gt;initUserLanguage&lt;/code&gt; 的判断方法 &lt;code&gt;else&lt;/code&gt; 里使用系统语言：&lt;br&gt;&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	languageString = [[NSUserDefaults standardUserDefaults] &lt;span class=&quot;string&quot;&gt;objectForKey:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;AppleLanguages&quot;&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;// 其他默认为系统语言&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;2、另一种情况，比如：每次使用 &lt;code&gt;RDLocalizedString(&amp;lt;#key#&amp;gt;)&lt;/code&gt; 方法都要做引用 &lt;code&gt;#import &amp;quot;RDLocalizableController.h&amp;quot;&lt;/code&gt; 好麻烦。&lt;br&gt;当然你可以把 &lt;code&gt;#import &amp;quot;RDLocalizableController.h&amp;quot;&lt;/code&gt; 放到 &lt;code&gt;.pch&lt;/code&gt; 文件里，哦，顺便提一下 &lt;code&gt;.pch&lt;/code&gt; 文件会拖慢启动时间 &lt;/p&gt;
&lt;p&gt;3、还有一种情况，比如：就想使用 &lt;code&gt;NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;)&lt;/code&gt; 方法，还可以解决以上两种情况&lt;/p&gt;
&lt;p&gt;还是有方法使用 &lt;code&gt;NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;)&lt;/code&gt; 的。&lt;br&gt;使用 &lt;code&gt;Category&lt;/code&gt; 为 &lt;code&gt;NSBundle&lt;/code&gt; 类扩展一个设置语言的方法，并且使用 &lt;code&gt;runtime&lt;/code&gt; 为 &lt;code&gt;NSBundle&lt;/code&gt; 动态添加一个关于 &lt;code&gt;bundle&lt;/code&gt; 的属性，重载 &lt;code&gt;NSBundle.mainBundle&lt;/code&gt; 的 &lt;code&gt;localizedStringForKey&lt;/code&gt; 方法。目的就是将更改的字体传给 &lt;code&gt;NSLocalizedString(&amp;lt;#key#&amp;gt;, &amp;lt;#comment#&amp;gt;)&lt;/code&gt; 映射的 &lt;code&gt;localizedStringForKey&lt;/code&gt; 方法返回的 &lt;code&gt;bundle&lt;/code&gt; ，使得更改的字体应用到系统上。 &lt;/p&gt;
&lt;p&gt;好吧，show you the code:&lt;br&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#import &lt;span class=&quot;meta-string&quot;&gt;&quot;NSBundle+RDLanguage.h&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#import &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;objc/runtime.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *RDBundleKey = &lt;span class=&quot;string&quot;&gt;@&quot;RDLanguageKey&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;BundleEx&lt;/span&gt; : &lt;span class=&quot;title&quot;&gt;NSBundle&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;BundleEx&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)localizedStringForKey:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)key value:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)value table:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)tableName &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; *bundle = objc_getAssociatedObject(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, &amp;amp;RDBundleKey);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (bundle) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [bundle localizedStringForKey:key value:value table:tableName];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; localizedStringForKey:key value:value table:tableName];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;NSBundle&lt;/span&gt; (&lt;span class=&quot;title&quot;&gt;RDLanguage&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)setLanguage:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)language &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;dispatch_once_t&lt;/span&gt; onceToken;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;dispatch_once&lt;/span&gt;(&amp;amp;onceToken, ^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        object_setClass([&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle], [BundleEx class]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; value = language ? [&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; bundleWithPath:[[&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle] pathForResource:language ofType:&lt;span class=&quot;string&quot;&gt;@&quot;lproj&quot;&lt;/span&gt;]] : &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    objc_setAssociatedObject([&lt;span class=&quot;built_in&quot;&gt;NSBundle&lt;/span&gt; mainBundle], &amp;amp;RDBundleKey, value, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;@end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;以上代码是 &lt;code&gt;NSBundle&lt;/code&gt; 的 &lt;code&gt;Category&lt;/code&gt;。&lt;br&gt;解释一下哈：&lt;br&gt;1、&lt;code&gt;objc_getAssociatedObject&lt;/code&gt; 和 &lt;code&gt;objc_setAssociatedObject&lt;/code&gt; 是一对 &lt;code&gt;getter、setter&lt;/code&gt; 方法，目的是为了给 &lt;code&gt;NSBundle&lt;/code&gt; 类动态添加一个属性。&lt;br&gt;2、&lt;code&gt;object_setClass&lt;/code&gt;：在 &lt;code&gt;BundleEx&lt;/code&gt; 里实现一个 &lt;code&gt;localizedStringForKey&lt;/code&gt; 方法，然后将 &lt;code&gt;BundleEx&lt;/code&gt; 这个类设置给 &lt;code&gt;[NSBundle mainBundle]&lt;/code&gt; 。目的就是相当于重载 &lt;code&gt;[NSBundle mainBundle]&lt;/code&gt; 的 &lt;code&gt;localizedStringForKey&lt;/code&gt; 方法。&lt;/p&gt;
&lt;p&gt;说明：&lt;br&gt;&lt;code&gt;runtime&lt;/code&gt; 的具体用法和原理，由于在下才疏学浅就不多做讲解了，免得误人子弟。关于更多 &lt;code&gt;runtime&lt;/code&gt; 的知识可以学习 &lt;a href=&quot;http://www.jianshu.com/users/12201cdd5d7a/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;一缕殇流化隐半边冰霜
&lt;/a&gt; 写的 &lt;a href=&quot;http://www.jianshu.com/p/9d649ce6d0b8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;神经病院Objective-C Runtime入院
&lt;/a&gt; 系列文章。&lt;/p&gt;
&lt;p&gt;再说本篇文章，该类别新增方法的使用：&lt;br&gt;在 &lt;code&gt;RDLocalizableController&lt;/code&gt; 类的 &lt;code&gt;+ (void)setUserlanguage:(NSString *)language&lt;/code&gt; 方法里，本地化存储语言之后，发送通知之前调用如下方法：&lt;br&gt;&lt;figure class=&quot;highlight ini&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;section&quot;&gt;[NSBundle setLanguage:language]&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;之后，关于 &lt;code&gt;RDLocalizableController&lt;/code&gt; 类里边关于 &lt;code&gt;bundle&lt;/code&gt; 的操作就可以舍弃了。&lt;/p&gt;
&lt;p&gt;注意：使用这种方法要确保你的 &lt;code&gt;.strings&lt;/code&gt; 的文件名为 &lt;code&gt;Localizable.strings&lt;/code&gt;&lt;br&gt;否则还是要重新设置宏定义：&lt;br&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;#def&lt;/span&gt;ine NSLocalizedString(key, comment) \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	    [NSBundle&lt;span class=&quot;selector-class&quot;&gt;.mainBundle&lt;/span&gt; localizedStringForKey:(key) value:@&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;table&lt;/span&gt;:@“RDLocalizable”]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这样的话该宏定义会有一个警告，毕竟系统已经定义过了的，而且你还要到处重定义。。。又犯了上面第二种情况的尴尬。&lt;/p&gt;
&lt;p&gt;到这里，该篇博客就结尾了，希望能帮助到各位一二&lt;br&gt;祝大家生活愉快，勤勉Coding&lt;/p&gt;
&lt;h2 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/10/29/set-language&quot;&gt;http://gonghonglou.com/2016/10/29/set-language&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Xcode 新建一个工程的默认语言是英文，所以你在 app 里粘贴复制都是显示的 &lt;code&gt;copy&lt;/code&gt; &lt;code&gt;paste&lt;/code&gt;，你可以通过在 &lt;code&gt;info.plst&lt;/code&gt; 文件里选择 &lt;code&gt;Localization nati
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS中关于二维码的识别与生成</title>
    <link href="http://gonghonglou.com/2016/07/24/QRCode/"/>
    <id>http://gonghonglou.com/2016/07/24/QRCode/</id>
    <published>2016-07-24T07:44:57.000Z</published>
    <updated>2017-07-03T08:44:07.000Z</updated>
    
    <content type="html">&lt;p&gt;提起二维码 &lt;a href=&quot;https://en.wikipedia.org/wiki/QR_code&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;QR Code&lt;/a&gt; 想必大家都不再陌生，“扫一扫加好友”、“扫一扫付款”等已是我们日常生活中司空见惯的情形。   &lt;/p&gt;
&lt;p&gt;以这篇博客来讲述在iOS中关于二维码的识别与生成，会尽可能周全的将二维码识别与生成相关的操作讲述清楚。&lt;/p&gt;
&lt;p&gt;关于二维码生成的原理，感兴趣的话各位可以移驾 &lt;a href=&quot;http://7xn9bi.com1.z0.glb.clouddn.com/QRCode/mineqrcode.jpeg&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;二维码的生成细节和原理&lt;/a&gt; 以做参考。&lt;/p&gt;
&lt;p&gt;注：文中识别与生成二维码的方法同样适用于条形码。&lt;/p&gt;
&lt;p&gt;先上几张二维码压压惊……&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/QRCode/creatcode.png&quot; alt=&quot;我的二维码&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;识别二维码&quot;&gt;&lt;a href=&quot;#识别二维码&quot; class=&quot;headerlink&quot; title=&quot;识别二维码&quot;&gt;&lt;/a&gt;识别二维码&lt;/h1&gt;&lt;h2 id=&quot;摄像头扫描二维码&quot;&gt;&lt;a href=&quot;#摄像头扫描二维码&quot; class=&quot;headerlink&quot; title=&quot;摄像头扫描二维码&quot;&gt;&lt;/a&gt;摄像头扫描二维码&lt;/h2&gt;&lt;p&gt;iOS7之后苹果推出系统原生API来支持通过扫描获取二维码的功能，较其它 &lt;a href=&quot;https://github.com/ZBar/ZBar&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ZBar&lt;/a&gt;、&lt;a href=&quot;https://github.com/zxing/zxing&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ZXing&lt;/a&gt; 等第三方库有明显的性能优势。&lt;/p&gt;
&lt;p&gt;首先，你需要弄清楚要用到的以下对象分别起到什么作用：&lt;/p&gt;
&lt;p&gt;1、 &lt;code&gt;AVCaptureDevice&lt;/code&gt;：&lt;br&gt;捕获数据的物理设备，如：摄像机、麦克风。 开关灯属性&lt;code&gt;torchMode&lt;/code&gt;就是由它管理的。&lt;/p&gt;
&lt;p&gt;2、 &lt;code&gt;AVCaptureSession&lt;/code&gt;：&lt;br&gt;会话，管理输入流、输出流之间的数据传递。&lt;/p&gt;
&lt;p&gt;3、 &lt;code&gt;AVCaptureDeviceInput&lt;/code&gt;：&lt;br&gt;输入流，从物理设备获取数据。&lt;/p&gt;
&lt;p&gt;4、 &lt;code&gt;AVCaptureMetadataOutput&lt;/code&gt;：&lt;br&gt;输出流，需要设置输出流代理及所在线程，由代理对象处理输出流数据。     &lt;/p&gt;
&lt;p&gt;需要说明的是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;需要将输出流添加到会话后，才能指定元数据类型，否则会报错。&lt;/li&gt;
&lt;li&gt;将输出流设置在主线程中，其代理方法会执行一次。设置在其他线程的话，代理会执行多次且次数不可控制。&lt;/li&gt;
&lt;li&gt;可以通过设置&lt;code&gt;AVFoundation&lt;/code&gt;的&lt;code&gt;rectOfInterest&lt;/code&gt;属性来设定扫描区域，该属性默认取值是&lt;code&gt;CGRectMake(0, 0, 1, 1)&lt;/code&gt;即全屏扫描&lt;br&gt;&lt;code&gt;x&lt;/code&gt;、&lt;code&gt;y&lt;/code&gt;、&lt;code&gt;width&lt;/code&gt;、&lt;code&gt;height&lt;/code&gt;的取值范围都是&lt;code&gt;0～1&lt;/code&gt;，且原点在屏幕右上角，所以和我们正常理解的&lt;code&gt;CGRect&lt;/code&gt;相比&lt;code&gt;x&lt;/code&gt;和&lt;code&gt;y&lt;/code&gt;对调，&lt;code&gt;width&lt;/code&gt;和&lt;code&gt;height&lt;/code&gt;对调。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如图：&lt;img src=&quot;http://image.gonghonglou.com/QRCode/rectOfInterest.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;5、 &lt;code&gt;AVCaptureVideoPreviewLayerCALayer&lt;/code&gt;：&lt;br&gt;预览图层，显示相机拍摄到的画面。正因为它是&lt;code&gt;CALayer&lt;/code&gt;的子类，为了将它添加到屏幕上，我们需要额外添加一个&lt;code&gt;UIView&lt;/code&gt;，在这个&lt;code&gt;UIView&lt;/code&gt;的&lt;code&gt;layer上&lt;/code&gt;添加&lt;code&gt;AVCaptureVideoPreviewLayerCALayer&lt;/code&gt;，否则它会覆盖住所有的控件（除非你把所有的控件都在添加这个视图之后添加）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/cheaptalk.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;AVCaptureSession&lt;/code&gt; 设置开始与结束扫描&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 开始会话&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession startRunning];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 停止会话&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession stopRunning];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession = &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;获取AVCaptureDevice实例&lt;/li&gt;
&lt;li&gt;初始化输入流&lt;/li&gt;
&lt;li&gt;初始化输出流&lt;br&gt; 3.1.设置代理及所在线程&lt;br&gt; 3.2设置扫描区域&lt;/li&gt;
&lt;li&gt;创建会话&lt;br&gt; 4.1添加输入流&lt;br&gt; 4.2添加输出流&lt;br&gt; *3.3指定元数据类型&lt;/li&gt;
&lt;li&gt;创建预览图层&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 1.获取AVCaptureDevice实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureDevice = [&lt;span class=&quot;built_in&quot;&gt;AVCaptureDevice&lt;/span&gt; defaultDeviceWithMediaType:&lt;span class=&quot;built_in&quot;&gt;AVMediaTypeVideo&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 2.初始化输入流&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSError&lt;/span&gt; * error;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;AVCaptureDeviceInput&lt;/span&gt; *input = [&lt;span class=&quot;built_in&quot;&gt;AVCaptureDeviceInput&lt;/span&gt; deviceInputWithDevice:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureDevice error:&amp;amp;error];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!input) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, [error localizedDescription]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3.初始化输出流&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;AVCaptureMetadataOutput&lt;/span&gt; *captureMetadataOutput = [&lt;span class=&quot;built_in&quot;&gt;AVCaptureMetadataOutput&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3.1设置代理及所在线程&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[captureMetadataOutput setMetadataObjectsDelegate:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; queue:dispatch_get_main_queue()];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3.2设置扫描区域&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[captureMetadataOutput setRectOfInterest:[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; scanPlace]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 4.创建会话&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession = [&lt;span class=&quot;built_in&quot;&gt;AVCaptureSession&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 4.1添加输入流&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession addInput:input];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession canAddInput:input]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession addInput:input];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 4.2添加输出流&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession canAddOutput:captureMetadataOutput]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession addOutput:captureMetadataOutput];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3.3指定元数据类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;captureMetadataOutput.metadataObjectTypes = @[&lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeUPCECode&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeCode39Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeCode39Mod43Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeEAN13Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeEAN8Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeCode93Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeCode128Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypePDF417Code&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeQRCode&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// 二维码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             &lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeAztecCode&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 5创建预览图层&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureVideoPreviewLayer = [[&lt;span class=&quot;built_in&quot;&gt;AVCaptureVideoPreviewLayer&lt;/span&gt; alloc] initWithSession:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureSession];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureVideoPreviewLayer setVideoGravity:&lt;span class=&quot;built_in&quot;&gt;AVLayerVideoGravityResizeAspectFill&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureVideoPreviewLayer setFrame:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.scanView.layer.bounds];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.scanView.layer addSublayer:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.captureVideoPreviewLayer];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;AVCaptureMetadataOutput&lt;/code&gt; 的代理方法处理输出流，返回扫描结果&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#pragma mark - 代理方法处理输出流&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)captureOutput:(&lt;span class=&quot;built_in&quot;&gt;AVCaptureOutput&lt;/span&gt; *)captureOutput didOutputMetadataObjects:(&lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *)metadataObjects fromConnection:(&lt;span class=&quot;built_in&quot;&gt;AVCaptureConnection&lt;/span&gt; *)connection &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (metadataObjects != &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; &amp;amp;&amp;amp; [metadataObjects count] &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;AVMetadataMachineReadableCodeObject&lt;/span&gt; *metadataObj = [metadataObjects objectAtIndex:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *result = metadataObj.stringValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;result:%@&quot;&lt;/span&gt;, result);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([[metadataObj type] isEqualToString:&lt;span class=&quot;built_in&quot;&gt;AVMetadataObjectTypeQRCode&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;二维码&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; closeScanQRCode];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;开灯&quot;&gt;&lt;a href=&quot;#开灯&quot; class=&quot;headerlink&quot; title=&quot;开灯&quot;&gt;&lt;/a&gt;开灯&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;给开关灯按钮调用以下 &lt;code&gt;AVCaptureDevice&lt;/code&gt; 方法，轻松实现开灯效果&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)turnLight &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// 判断允许设置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device hasTorch]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device lockForConfiguration:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device.torchMode == &lt;span class=&quot;built_in&quot;&gt;AVCaptureTorchModeOff&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device setTorchMode:&lt;span class=&quot;built_in&quot;&gt;AVCaptureTorchModeOn&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;// 开灯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device.torchMode == &lt;span class=&quot;built_in&quot;&gt;AVCaptureTorchModeOn&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device setTorchMode:&lt;span class=&quot;built_in&quot;&gt;AVCaptureTorchModeOff&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;// 关灯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.device unlockForConfiguration];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;总结下来就是：&lt;br&gt;&lt;code&gt;AVCaptureSession&lt;/code&gt;管理从物理设备&lt;code&gt;AVCaptureDevice&lt;/code&gt;那里获取的输入流&lt;code&gt;AVCaptureDeviceInput&lt;/code&gt;数据&lt;br&gt;通过输出流&lt;code&gt;AVCaptureMetadataOutput&lt;/code&gt;显示到预览图层&lt;code&gt;AVCaptureVideoPreviewLayerCALayer&lt;/code&gt;上&lt;br&gt;并且由代理方法&lt;code&gt;-(void)captureOutput:(AVCaptureOutput*)captureOutput didOutputMetadataObjects:(NSArray*)metadataObjects fromConnection:(AVCaptureConnection*)connection;&lt;/code&gt;处理捕获到的数据。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;相册识别二维码&quot;&gt;&lt;a href=&quot;#相册识别二维码&quot; class=&quot;headerlink&quot; title=&quot;相册识别二维码&quot;&gt;&lt;/a&gt;相册识别二维码&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;iOS8之后系统提供的识别二维码图片的方法相当简单&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 读取二维码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *sourceImage ＝ ...;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;CIContext&lt;/span&gt; *context = [&lt;span class=&quot;built_in&quot;&gt;CIContext&lt;/span&gt; contextWithOptions:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;CIDetector&lt;/span&gt; *detector = [&lt;span class=&quot;built_in&quot;&gt;CIDetector&lt;/span&gt; detectorOfType:&lt;span class=&quot;built_in&quot;&gt;CIDetectorTypeQRCode&lt;/span&gt; context:context options:@&amp;#123;&lt;span class=&quot;built_in&quot;&gt;CIDetectorAccuracy&lt;/span&gt;:&lt;span class=&quot;built_in&quot;&gt;CIDetectorAccuracyHigh&lt;/span&gt;&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *image = [&lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; imageWithCGImage:sourceImage.CGImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *array = [detector featuresInImage:image];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;CIQRCodeFeature&lt;/span&gt; *feature = [array firstObject];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *result = feature.messageString;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;result:%@&quot;&lt;/span&gt;, result);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;UIImagePickerController&lt;/code&gt; 打开系统相册，选择图片识别：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)openPhotoLibrary &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIImagePickerController&lt;/span&gt; *photoPicker = [&lt;span class=&quot;built_in&quot;&gt;UIImagePickerController&lt;/span&gt; new];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    photoPicker.delegate = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 打开的相册类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    photoPicker.sourceType = &lt;span class=&quot;built_in&quot;&gt;UIImagePickerControllerSourceTypePhotoLibrary&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; presentViewController:photoPicker animated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;UIImagePickerController&lt;/code&gt; 的代理方法识别相册中选中的二维码：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#pragma mark - UIImagePickerControllerDelegate&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)imagePickerController:(&lt;span class=&quot;built_in&quot;&gt;UIImagePickerController&lt;/span&gt; *)picker didFinishPickingMediaWithInfo:(&lt;span class=&quot;built_in&quot;&gt;NSDictionary&lt;/span&gt; *)info &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; dismissViewControllerAnimated:&lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt; completion:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 读取二维码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *sourceImage = [info objectForKey:&lt;span class=&quot;built_in&quot;&gt;UIImagePickerControllerOriginalImage&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;CIContext&lt;/span&gt; *context = [&lt;span class=&quot;built_in&quot;&gt;CIContext&lt;/span&gt; contextWithOptions:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;CIDetector&lt;/span&gt; *detector = [&lt;span class=&quot;built_in&quot;&gt;CIDetector&lt;/span&gt; detectorOfType:&lt;span class=&quot;built_in&quot;&gt;CIDetectorTypeQRCode&lt;/span&gt; context:context options:@&amp;#123;&lt;span class=&quot;built_in&quot;&gt;CIDetectorAccuracy&lt;/span&gt;:&lt;span class=&quot;built_in&quot;&gt;CIDetectorAccuracyHigh&lt;/span&gt;&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *image = [&lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; imageWithCGImage:sourceImage.CGImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSArray&lt;/span&gt; *array = [detector featuresInImage:image];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;CIQRCodeFeature&lt;/span&gt; *feature = [array firstObject];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *result = feature.messageString;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;result:%@&quot;&lt;/span&gt;, result);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;生成二维码&quot;&gt;&lt;a href=&quot;#生成二维码&quot; class=&quot;headerlink&quot; title=&quot;生成二维码&quot;&gt;&lt;/a&gt;生成二维码&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;使用系统提供的&lt;code&gt;CIFilter&lt;/code&gt;可以方便简单的生成二维码&lt;/p&gt;
&lt;p&gt;生成二维码方法&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *)generateQRCode:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)code width:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)width height:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)height &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *qrcodeImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSData&lt;/span&gt; *data = [code dataUsingEncoding:&lt;span class=&quot;built_in&quot;&gt;NSUTF8StringEncoding&lt;/span&gt; allowLossyConversion:&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; *filter = [&lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; filterWithName:&lt;span class=&quot;string&quot;&gt;@&quot;CIQRCodeGenerator&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [filter setValue:data forKey:&lt;span class=&quot;string&quot;&gt;@&quot;inputMessage&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [filter setValue:&lt;span class=&quot;string&quot;&gt;@&quot;H&quot;&lt;/span&gt; forKey:&lt;span class=&quot;string&quot;&gt;@&quot;inputCorrectionLevel&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    qrcodeImage = [filter outputImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 消除模糊&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; scaleX = width / qrcodeImage.extent.size.width; &lt;span class=&quot;comment&quot;&gt;// extent 返回图片的frame&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; scaleY = height / qrcodeImage.extent.size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *transformedImage = [qrcodeImage imageByApplyingTransform:&lt;span class=&quot;built_in&quot;&gt;CGAffineTransformScale&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;CGAffineTransformIdentity&lt;/span&gt;, scaleX, scaleY)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; imageWithCIImage:transformedImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 &lt;code&gt;CIFilter&lt;/code&gt; 生成带背景色的二维码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *)gaveColor:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)code width:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)width height:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)height &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSData&lt;/span&gt; *data = [code dataUsingEncoding:&lt;span class=&quot;built_in&quot;&gt;NSUTF8StringEncoding&lt;/span&gt; allowLossyConversion:&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; *filter = [&lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; filterWithName:&lt;span class=&quot;string&quot;&gt;@&quot;CIQRCodeGenerator&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [filter setValue:data forKey:&lt;span class=&quot;string&quot;&gt;@&quot;inputMessage&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [filter setValue:&lt;span class=&quot;string&quot;&gt;@&quot;H&quot;&lt;/span&gt; forKey:&lt;span class=&quot;string&quot;&gt;@&quot;inputCorrectionLevel&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//上色&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; *colorFilter = [&lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; filterWithName:&lt;span class=&quot;string&quot;&gt;@&quot;CIFalseColor&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                       keysAndValues:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;string&quot;&gt;@&quot;inputImage&quot;&lt;/span&gt;,filter.outputImage,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;string&quot;&gt;@&quot;inputColor0&quot;&lt;/span&gt;,[&lt;span class=&quot;built_in&quot;&gt;CIColor&lt;/span&gt; colorWithCGColor:[&lt;span class=&quot;built_in&quot;&gt;UIColor&lt;/span&gt; purpleColor].CGColor], &lt;span class=&quot;comment&quot;&gt;// 前景色&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;string&quot;&gt;@&quot;inputColor1&quot;&lt;/span&gt;,[&lt;span class=&quot;built_in&quot;&gt;CIColor&lt;/span&gt; colorWithCGColor:[&lt;span class=&quot;built_in&quot;&gt;UIColor&lt;/span&gt; cyanColor].CGColor], &lt;span class=&quot;comment&quot;&gt;// 背景色&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *qrcodeImage = colorFilter.outputImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 消除模糊&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; scaleX = width / qrcodeImage.extent.size.width; &lt;span class=&quot;comment&quot;&gt;// extent 返回图片的frame&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; scaleY = height / qrcodeImage.extent.size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *transformedImage = [qrcodeImage imageByApplyingTransform:&lt;span class=&quot;built_in&quot;&gt;CGAffineTransformScale&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;CGAffineTransformIdentity&lt;/span&gt;, scaleX, scaleY)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; imageWithCIImage:transformedImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;通过遍历图片的像素给二维码个性化上色  &lt;/p&gt;
&lt;p&gt;这里需要指出的是，如果你在下边方法中传入的 &lt;code&gt;image&lt;/code&gt; 是通过 &lt;code&gt;CIFilter&lt;/code&gt; 方法直接生成的，那么该方法是没法工作的。同理，下一节中保存图片时仍然不能用 &lt;code&gt;CIFilter&lt;/code&gt; 方法直接生成的 &lt;code&gt;image&lt;/code&gt;，而采用 &lt;code&gt;CGContextRef&lt;/code&gt; 获取图片。（参见下一节：&lt;strong&gt;保存二维码&lt;/strong&gt;）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 颜色变化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; ProviderReleaseData (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *info, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *data, size_t size) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    free((&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *)data);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *)imageBlackToTransparent:(&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *)image &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 分配内存&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; imageWidth = image.size.width;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; imageHeight = image.size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    size_t bytesPerRow = imageWidth * &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    uint32_t *rgbImageBuf = (uint32_t *)malloc(bytesPerRow * imageHeight);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 创建context&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGColorSpaceRef&lt;/span&gt; colorSpace = &lt;span class=&quot;built_in&quot;&gt;CGColorSpaceCreateDeviceRGB&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGContextRef&lt;/span&gt; context = &lt;span class=&quot;built_in&quot;&gt;CGBitmapContextCreate&lt;/span&gt;(rgbImageBuf, imageWidth, imageHeight, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, bytesPerRow, colorSpace,kCGBitmapByteOrder32Little | kCGImageAlphaNoneSkipLast);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGContextDrawImage&lt;/span&gt;(context, &lt;span class=&quot;built_in&quot;&gt;CGRectMake&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, imageWidth, imageHeight), image.CGImage);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 遍历像素&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pixelNum = imageWidth * imageHeight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    uint32_t *pCurPtr = rgbImageBuf;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; pixelNum; i++, pCurPtr++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((*pCurPtr &amp;amp; &lt;span class=&quot;number&quot;&gt;0xFFFFFF00&lt;/span&gt;) &amp;lt; &lt;span class=&quot;number&quot;&gt;0x99999900&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 改变下面的代码，将图片转成想要的颜色&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            uint8_t *ptr = (uint8_t *)pCurPtr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i&amp;lt;pixelNum/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ptr[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;//0~255&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ptr[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ptr[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ptr[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;//0~255&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ptr[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ptr[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 白色 255,255,255&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            uint8_t *ptr = (uint8_t *)pCurPtr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ptr[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 将内存转成image&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGDataProviderRef&lt;/span&gt; dataProvider = &lt;span class=&quot;built_in&quot;&gt;CGDataProviderCreateWithData&lt;/span&gt;(&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, rgbImageBuf, bytesPerRow * imageHeight,ProviderReleaseData);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGImageRef&lt;/span&gt; imageRef = &lt;span class=&quot;built_in&quot;&gt;CGImageCreate&lt;/span&gt;(imageWidth, imageHeight, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, bytesPerRow, colorSpace,kCGImageAlphaLast | kCGBitmapByteOrder32Little, dataProvider, &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, kCGRenderingIntentDefault);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGDataProviderRelease&lt;/span&gt;(dataProvider);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *resultUIImage = [&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; imageWithCGImage:imageRef];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 释放&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGImageRelease&lt;/span&gt;(imageRef);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGContextRelease&lt;/span&gt;(context);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGColorSpaceRelease&lt;/span&gt;(colorSpace);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; resultUIImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;生成条码图片&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *)generateBarCode:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)code width:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)width height:(&lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;)height &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *barcodeImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSData&lt;/span&gt; *data = [code dataUsingEncoding:&lt;span class=&quot;built_in&quot;&gt;NSISOLatin1StringEncoding&lt;/span&gt; allowLossyConversion:&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; *filter = [&lt;span class=&quot;built_in&quot;&gt;CIFilter&lt;/span&gt; filterWithName:&lt;span class=&quot;string&quot;&gt;@&quot;CICode128BarcodeGenerator&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [filter setValue:data forKey:&lt;span class=&quot;string&quot;&gt;@&quot;inputMessage&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    barcodeImage = [filter outputImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 消除模糊&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; scaleX = width / barcodeImage.extent.size.width; &lt;span class=&quot;comment&quot;&gt;// extent 返回图片的frame&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt; scaleY = height / barcodeImage.extent.size.height;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;CIImage&lt;/span&gt; *transformedImage = [barcodeImage imageByApplyingTransform:&lt;span class=&quot;built_in&quot;&gt;CGAffineTransformScale&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;CGAffineTransformIdentity&lt;/span&gt;, scaleX, scaleY)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; imageWithCIImage:transformedImage];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;保存二维码&quot;&gt;&lt;a href=&quot;#保存二维码&quot; class=&quot;headerlink&quot; title=&quot;保存二维码&quot;&gt;&lt;/a&gt;保存二维码&lt;/h1&gt;&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 开启位图上下文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIGraphicsBeginImageContextWithOptions&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.imageView.bounds.size, &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取绘图上下文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;CGContextRef&lt;/span&gt; context = &lt;span class=&quot;built_in&quot;&gt;UIGraphicsGetCurrentContext&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 将图片渲染的上下文中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.imageView.layer renderInContext:context];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取上下文中的图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *image = &lt;span class=&quot;built_in&quot;&gt;UIGraphicsGetImageFromCurrentImageContext&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 关闭位图上下文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIGraphicsEndImageContext&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 保存图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;UIImageWriteToSavedPhotosAlbum&lt;/span&gt;(image, &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(image:didFinishSavingWithError:contextInfo:), &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;UIImageWriteToSavedPhotosAlbum&lt;/code&gt; 方法的指定回调，监测保存是否成功&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#pragma mark -  指定回调方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)image:(&lt;span class=&quot;built_in&quot;&gt;UIImage&lt;/span&gt; *)image didFinishSavingWithError:(&lt;span class=&quot;built_in&quot;&gt;NSError&lt;/span&gt; *)error contextInfo:(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *)contextInfo &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *string;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!error)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;save success&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;save failed&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看一哈效果图&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/QRCode/QRCodeSacn.png&quot; alt=&quot;二维码的识别与生成&quot;&gt;&lt;/p&gt;
&lt;p&gt;ok，就这些吧。&lt;br&gt;Demo地址：&lt;a href=&quot;https://github.com/gonghonglou/QRCodeDemo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/gonghonglou/QRCodeDemo&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;写到这里估计涉及了二维码操作的大部分内容，期望对诸君有所帮助。&lt;/p&gt;
&lt;p&gt;祝大家敲码愉快！&lt;/p&gt;
&lt;h1 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/07/24/QRCode&quot;&gt;http://gonghonglou.com/2016/07/24/QRCode&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;提起二维码 &lt;a href=&quot;https://en.wikipedia.org/wiki/QR_code&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;QR Code&lt;/a&gt; 想必大家都不再陌生，“扫一扫加好友”、“扫一扫付款”等已是我们日常生活中司空见惯
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>丽江之行</title>
    <link href="http://gonghonglou.com/2016/05/19/lijiang/"/>
    <id>http://gonghonglou.com/2016/05/19/lijiang/</id>
    <published>2016-05-19T14:43:02.000Z</published>
    <updated>2017-01-09T12:44:20.000Z</updated>
    
    <content type="html">&lt;p&gt;本来就打算一场毕业旅行啊，只是因为没有找到小伙伴同行所以迟迟未定。&lt;br&gt;某日夜，Yu小Rong同学突出奇想打工换宿邀游丽江。&lt;br&gt;一拍而和！&lt;/p&gt;
&lt;p&gt;最初的想法是打工换宿二十天左右，然而丽江客栈招义工大都要女孩子啊。&lt;br&gt;搞不懂看看客栈家门而已喽，身强力壮的小伙子就这么受歧视吗。。。&lt;/p&gt;
&lt;p&gt;所以Yu小Rong同学顺利找到一家暖暖的客栈做义工，而我…放弃吗？&lt;br&gt;NO！&lt;br&gt;苦寻义工无果之后果断选择住宿青旅，也算穷游丽江啦！&lt;/p&gt;
&lt;p&gt;有意思的是在某团上订房间时某青旅有三种房间：混住房间、男生房间、女生房间，价格相同。&lt;br&gt;不明白该青旅是报以什么样的想法加入了混住房间的呢（坏笑）&lt;br&gt;当我把这件事告知Yu小Rong同学并得知我订的是男生房间而非混住房间时竟然吐槽我：注孤生！&lt;br&gt;额，好像错过了什么，活该单身狗啊哈哈哈&lt;/p&gt;
&lt;h2 id=&quot;12号－－出发丽江&quot;&gt;&lt;a href=&quot;#12号－－出发丽江&quot; class=&quot;headerlink&quot; title=&quot;12号－－出发丽江&quot;&gt;&lt;/a&gt;12号－－出发丽江&lt;/h2&gt;&lt;p&gt;十点出门从浦东奔赴上海虹桥，十二点动车开往杭州，下午两点机场大巴从杭州东站开往萧山机场。六点四十起飞，时间还是挺充足的！&lt;/p&gt;
&lt;p&gt;萧山机场&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/airplane.jpeg&quot; alt=&quot;萧山机场&quot;&gt;&lt;/p&gt;
&lt;p&gt;三小时后三义机场和某个傻傻女孩&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/sanyiAirplane.jpeg&quot; alt=&quot;三义机场&quot;&gt;&lt;/p&gt;
&lt;p&gt;一翻奔波，安顿了Yu小Rong同学在客栈，然后赶到青旅已是十二点多。青旅虽说是六张床却是我一人住还是棒棒哒！可能现在是旅游淡季的缘故吧。&lt;/p&gt;
&lt;h2 id=&quot;13号－－束河古镇&quot;&gt;&lt;a href=&quot;#13号－－束河古镇&quot; class=&quot;headerlink&quot; title=&quot;13号－－束河古镇&quot;&gt;&lt;/a&gt;13号－－束河古镇&lt;/h2&gt;&lt;p&gt;今天是休闲的一天。而且感觉丽江是一个慢节奏的古镇，好多人来旅游度假，也有很多人来旅行休憩。相比上海的快节奏生活突然到这里还是有些稍稍不适应的，是那种没有从心底完全放松的感觉。不过好不容易来这一趟还是非常享受这里惬意、舒适、休闲的慢节奏生活的。想想有半月多的这种旅行生活还是蛮激动的😄&lt;/p&gt;
&lt;p&gt;早晨起来才看清住的院子的真面目，不错哦。&lt;br&gt; &lt;img src=&quot;http://image.gonghonglou.com/lijinag/qinglv2.jpeg&quot; alt=&quot;客栈院子&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/qinglv3.jpeg&quot; alt=&quot;客栈院子&quot;&gt;&lt;/p&gt;
&lt;p&gt;上午就悠闲地待在小伙伴在的客栈里，大大的院子。&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/kezhan.jpeg&quot; alt=&quot;客栈院子&quot;&gt;&lt;/p&gt;
&lt;p&gt;午饭后漫步于束河古镇的各条街道里，房屋大多都是木质的&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/shuhe2.jpeg&quot; alt=&quot;&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/shuhe3.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;好多手鼓店，而且都放着那首由 &lt;a href=&quot;http://www.tudou.com/programs/view/99iuXqPqV2o/?bid=03&amp;amp;pid=2&amp;amp;resourceId=0_03_05_02&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;最美丽江手鼓女孩&lt;/a&gt; 火起来的欢快的《我的小宝贝》&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/WeChat_1463590780.jpeg&quot; alt=&quot;手鼓店&quot;&gt;&lt;/p&gt;
&lt;p&gt;回青旅休息的路上路过一家叫喜鹊的小酒吧，好像很热闹的样子，就到上边坐了一会。&lt;br&gt;深夜，点一杯饮料听几首歌……&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/jiuba.jpeg&quot; alt=&quot;喜鹊酒吧&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;14号－－拉市海&quot;&gt;&lt;a href=&quot;#14号－－拉市海&quot; class=&quot;headerlink&quot; title=&quot;14号－－拉市海&quot;&gt;&lt;/a&gt;14号－－拉市海&lt;/h2&gt;&lt;p&gt;在纳西族中，“拉”为荒坝，“市”为新。“拉市”意为新的荒坝。拉市海在当地人口中也称为老市海。&lt;br&gt;上午十点半包车前往拉市海马场，这边真的有好多马场，会有很多游客来骑马。这里的马个头比较矮，不过据马夫讲这里的马脚力特别好，擅负重。&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/P60514-115216.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;茶马古道上捕获软妹子一只，这么美好想上前搭讪呀😏&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_2891.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;中午到拉市海海上会所吃过午饭后就开始划船了嘛。可惜今天阴天，不然就能看到拉市海清澈美丽的湖面上倒映着蔚蓝的天空和天空里洁白的棉花糖  &lt;/p&gt;
&lt;p&gt;仗桨天涯！&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/WeChat_1463236839.jpeg&quot; alt=&quot;仗桨天涯&quot;&gt;&lt;/p&gt;
&lt;p&gt;美丽湖畔&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3012.jpg&quot; alt=&quot;拉市海&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;15号－－雨&quot;&gt;&lt;a href=&quot;#15号－－雨&quot; class=&quot;headerlink&quot; title=&quot;15号－－雨&quot;&gt;&lt;/a&gt;15号－－雨&lt;/h2&gt;&lt;p&gt;一整天都在下雨，不知是因为还没适应丽江的慢节奏还是因为一个人的孤独，今天清晰的感觉到对这里 我没有归属感。美丽的丽江。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;－: I’m sorry.&lt;br&gt;－: For what?&lt;br&gt;－:&lt;br&gt;－: For this.You’re so beautiful,i can’t control myself.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;16号－－丽江古城&quot;&gt;&lt;a href=&quot;#16号－－丽江古城&quot; class=&quot;headerlink&quot; title=&quot;16号－－丽江古城&quot;&gt;&lt;/a&gt;16号－－丽江古城&lt;/h2&gt;&lt;p&gt;万幸今天没下雨，可以去古城逛一逛。来丽江已有几天了，今天才去古城玩了。尤其想去看看大冰的小屋。对于大冰，相比读者粉丝我想我更是《阳光快车道》的观众，那是儿时的记忆，每周六的精彩节目，陪伴大冰在《阳光快车道》里从外景主持人到节目扛把子😄&lt;/p&gt;
&lt;p&gt;丽江古城&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3120.jpg&quot; alt=&quot;丽江古城&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3094.jpg&quot; alt=&quot;&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3131.jpg&quot; alt=&quot;大冰的小屋&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3130.jpg&quot; alt=&quot;老兵火塘&quot;&gt;&lt;/p&gt;
&lt;p&gt;晚上回青旅路过没有名字的手鼓店，美美的老板娘 暖暖的土家族妹子。&lt;br&gt;待了好长时间，手鼓没打几下倒是聊了好久，基本都是老板娘在讲：&lt;br&gt;讲来丽江前做装修设计时的嗨翻生活；&lt;br&gt;讲妈妈没有文采却有道理的生意之道；&lt;br&gt;讲算是“前男友”的刻骨经历；&lt;br&gt;讲快要结婚的男朋友的习性和她们之间相识经历生活小事还有老板娘爱吃醋的小性子。&lt;br&gt;燕姐，一个有故事的手鼓老板娘，不由得让人感觉亲近。下文有照片哦～&lt;/p&gt;
&lt;h2 id=&quot;17号－－再游古城&quot;&gt;&lt;a href=&quot;#17号－－再游古城&quot; class=&quot;headerlink&quot; title=&quot;17号－－再游古城&quot;&gt;&lt;/a&gt;17号－－再游古城&lt;/h2&gt;&lt;p&gt;今天是个好天气，怎么舍得不出去。在丽江的这几天晴朗的天空就是最稀有美丽的风景。&lt;/p&gt;
&lt;p&gt;专门到大冰的小屋里去坐了坐，一瓶风花雪月，一下午。&lt;br&gt;小屋里都是来自五湖四海的朋友，而且大都是女孩子呢。&lt;br&gt;驻唱歌手问大家想听什么歌，大家点了一圈，他只答：不会、没听过。他说不点歌的，只是那么随口问问233，想起什么唱什么。&lt;br&gt;他想起了甜蜜蜜，大家鼓掌期待那首经典老歌，只是第二句便唱得小屋里的女孩们红透了脸，这个歌手好污😄&lt;br&gt;大多都是流浪歌手的民谣之类的歌曲，也好多他自己的原创歌曲。    &lt;/p&gt;
&lt;p&gt;一把吉他弹起，旁边手鼓伴奏，轻声慢语，辽亢高歌。&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/WeChat_1463640994.jpeg&quot; alt=&quot;&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/%E5%B0%8F%E5%B1%8B.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;丽江古城很大，昨天只逛了一部份而已。今天去的时候发现好多手鼓店里的女孩都贴别漂亮啊，所以忍不住挨个拍下照片，打算做一合辑，就叫 &lt;a href=&quot;http://m.weibo.cn/3126314295/3976265180470944&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;最美丽江手鼓女孩&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;18号－－束河鼓缘&quot;&gt;&lt;a href=&quot;#18号－－束河鼓缘&quot; class=&quot;headerlink&quot; title=&quot;18号－－束河鼓缘&quot;&gt;&lt;/a&gt;18号－－束河鼓缘&lt;/h2&gt;&lt;p&gt;原本是打算在这里待二十天左右的，奈何天天下雨还特别冷，加之Yu小Rong同学男票不来了，所以打算提前回去喽。&lt;/p&gt;
&lt;p&gt;因为好多地方没去，倒是剩下了许多费用，看到束河街道上好多手鼓店，买个手鼓玩玩也是极好的。其实已经在燕姐那看了好几天了，大概有了个相中的手鼓，在今天买定的。&lt;/p&gt;
&lt;p&gt;漂亮的老板娘－－燕姐：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/%E7%87%95%E7%8E%B2.jpeg&quot; alt=&quot;燕姐&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;19号－－离开你时才爱上你&quot;&gt;&lt;a href=&quot;#19号－－离开你时才爱上你&quot; class=&quot;headerlink&quot; title=&quot;19号－－离开你时才爱上你&quot;&gt;&lt;/a&gt;19号－－离开你时才爱上你&lt;/h2&gt;&lt;p&gt;今天就要滚回上海了，恰好就在今天才是来丽江这么多天天气最好的一天。&lt;/p&gt;
&lt;p&gt;坐在机场大巴上，望着头顶上的广袤的蔚蓝的天空和那些大块大块的棉花糖简直美哭了&lt;br&gt;远方的雪山美的心都要化了&lt;br&gt;来丽江这么久从没像这一刻觉得丽江原来可以这么美。&lt;br&gt;可惜了了手机并不能拍出那样的美景。&lt;/p&gt;
&lt;p&gt;美丽的天空，美的都不舍得离开了。 &lt;/p&gt;
&lt;p&gt;当离开你时，才发现爱上了你。&lt;br&gt;－－－－丽江。&lt;/p&gt;
&lt;p&gt;最后附束河傍晚天空图一张&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3314.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;最后的最后分享阳光下的小花一组：(拍摄者：Yu小Rong)&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3335.jpg&quot; alt=&quot;&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3337.jpg&quot; alt=&quot;&quot;&gt;&lt;img src=&quot;http://image.gonghonglou.com/lijinag/IMG_3336.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;后-记-未-经-允-许-请-勿-转-载&quot;&gt;&lt;a href=&quot;#后-记-未-经-允-许-请-勿-转-载&quot; class=&quot;headerlink&quot; title=&quot;后  记  :   未  经  允  许  请  勿  转  载  !  !  !&quot;&gt;&lt;/a&gt;后  记  :   未  经  允  许  请  勿  转  载  !  !  !&lt;/h4&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;本来就打算一场毕业旅行啊，只是因为没有找到小伙伴同行所以迟迟未定。&lt;br&gt;某日夜，Yu小Rong同学突出奇想打工换宿邀游丽江。&lt;br&gt;一拍而和！&lt;/p&gt;
&lt;p&gt;最初的想法是打工换宿二十天左右，然而丽江客栈招义工大都要女孩子啊。&lt;br&gt;搞不懂看看客栈家门而已喽，身强力壮的小伙
    
    </summary>
    
      <category term="Journey" scheme="http://gonghonglou.com/categories/Journey/"/>
    
    
  </entry>
  
  <entry>
    <title>记环崇明岛骑行</title>
    <link href="http://gonghonglou.com/2016/05/10/chongming-cycling/"/>
    <id>http://gonghonglou.com/2016/05/10/chongming-cycling/</id>
    <published>2016-05-10T03:06:35.000Z</published>
    <updated>2017-07-31T06:23:18.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;strong&gt;事件：&lt;/strong&gt;环崇明岛骑行&lt;br&gt;&lt;strong&gt;人物：&lt;/strong&gt;博主、博主的小伙伴&lt;br&gt;&lt;strong&gt;时间：&lt;/strong&gt;五一小假&lt;br&gt;&lt;strong&gt;地点：&lt;/strong&gt;崇明岛&lt;br&gt;&lt;strong&gt;正文：&lt;/strong&gt;现在发是不有点晚了？ 闭嘴！&lt;/p&gt;
&lt;p&gt;列位权当是篇环崇明岛骑行的攻略来看也未尝不可。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/ChongmingCycling/IMG_2370.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;博主的车子，算是一款入门级的山地车－－捷安特 ATX 850，油压碟刹还是蛮爽的😄&lt;/p&gt;
&lt;h1 id=&quot;30号&quot;&gt;&lt;a href=&quot;#30号&quot; class=&quot;headerlink&quot; title=&quot;30号&quot;&gt;&lt;/a&gt;30号&lt;/h1&gt;&lt;p&gt;早上约八点半左右从浦东出发至石洞口码头，45km/2h。坐十一点的轮渡（每小时一航班）到崇明岛南门码头，拍了几张照吃过午饭大概有一点钟正式开始了环崇明岛的骑行。&lt;/p&gt;
&lt;p&gt;直接上陈海公路，一条宽阔的省道。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/ChongmingCycling/IMG_2575.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;不过骑起来并不舒服，因为路特别宽所以不挡风，骑行中稍微有些风都会明显感觉到阻力，且经常有上坡。大约一直在22km/h～25km/h之间的速度巡航。&lt;/p&gt;
&lt;p&gt;其实陈海公路相当长一段距离都是不允许非机动车行驶的。当然可以选择团城公路来走，只不过团成公路车辆要多一些难免提不起速度来。&lt;/p&gt;
&lt;p&gt;距离南门港大概有三四十公里的地方到了堡镇，休息了半个小时，再上车的时候。。。那个屁股。。。那个疼。。。。&lt;/p&gt;
&lt;p&gt;所以说骑行最重要的是坚强的屁股啊！！！&lt;/p&gt;
&lt;p&gt;在这条路上出了个小状况，有一段路小伙伴在前面破风，我跟的比较近而且没有太关心前方路况，小伙伴的车子突然躲过一辆停在路边的三轮车时我没来得急反应一车撞翻过去。。。不过还好只是一些擦伤不算太严重🤕️ 只是膝盖的碰伤导致那个下午剩下的路程骑起来比较吃力。&lt;strong&gt;&lt;em&gt;所以要告诫骑友们骑行中尽量保持精力集中，注意前方路况尤其是在有伙伴在前破风时。&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;五点钟左右抵达陈家镇，因为到的略早一点所以很快就找到了旅馆。&lt;strong&gt;&lt;em&gt;提醒骑友们留宿的话尽量到镇中心、县中心且稍早一点找宾馆，节假日房源还是挺紧张的。&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;1号&quot;&gt;&lt;a href=&quot;#1号&quot; class=&quot;headerlink&quot; title=&quot;1号&quot;&gt;&lt;/a&gt;1号&lt;/h1&gt;&lt;p&gt;早晨八点左右吃过早饭赶往东滩湿地，路上又到三个同行的骑友，其中一个还是骑过川藏，环过海南岛的前辈呢。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/ChongmingCycling/IMG_2649.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;十几公里的路程，从陈家镇半小时就能到东滩。拍了几张照：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/ChongmingCycling/IMG_2610.jpg&quot; alt=&quot;&quot;&gt;小湖边的座驾&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/ChongmingCycling/IMG_2639.jpg&quot; alt=&quot;&quot;&gt;天空下的兄弟俩&lt;/p&gt;
&lt;p&gt;最遗憾的便是我们绕了一大圈的路就为了去海边一看，结果到了海边大坝的地方却被野生自然保护区的门卫拦住了，距离海边不过几百米。。。大坝还挡住了我们远眺的视线。。。&lt;/p&gt;
&lt;p&gt;继续环岛的路程，从东滩赶往北沿公路，剩下的便是一直沿着北沿公路骑直到陈海公路回南门港了。因为天气预报说2号早上有雨，所以我们决定直接骑到南门港留宿，1号一天便骑了140公里！&lt;/p&gt;
&lt;p&gt;北沿公路骑起来还是相当爽的，上午大概在25km/h～30km/h巡航，下午因为要赶到南门港加上北沿公路路况相当好所以一直在35km/h左右巡航，简直酸爽！&lt;/p&gt;
&lt;p&gt;不过当拐到陈海公路后因为逆风、上坡再加上已经连续骑了一百多公里，所以这段路就苦逼了。。。&lt;/p&gt;
&lt;p&gt;这是我们环岛的轨迹：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/ChongmingCycling/IMG_26611.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;环岛总路线：&lt;br&gt;从南门港沿陈海公路一路向东南方向到陈家镇，&lt;br&gt;住一晚第二天到都东滩狂了一圈，&lt;br&gt;然后沿北沿公路向西北方向拐到陈海公路，&lt;br&gt;再沿陈海公路到南门港。&lt;/p&gt;
&lt;h1 id=&quot;2号&quot;&gt;&lt;a href=&quot;#2号&quot; class=&quot;headerlink&quot; title=&quot;2号&quot;&gt;&lt;/a&gt;2号&lt;/h1&gt;&lt;p&gt;早上坐十点半的轮渡回上海，再经约45km/2h的路程到家。&lt;/p&gt;
&lt;p&gt;五一环崇明岛骑行，第一次远途骑行正式结束，感觉良好！&lt;/p&gt;
&lt;h1 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h1&gt;&lt;p&gt;什么，你说这当一篇攻略来看的话也太逊了？&lt;br&gt;作为一名码农出身的骑行手，不能忍你！   &lt;/p&gt;
&lt;p&gt;这里有一份.gpx文件 👉&lt;a href=&quot;http://7xn9bi.com1.z0.glb.clouddn.com/ChongmingCycling/%20cycling_trajectory.gpx.zip&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击下载&lt;/a&gt;&lt;br&gt;记录了环崇明岛的骑行轨迹，将它导入到支持 gpx 格式的软件里就可以了，我用的是「行者」，大家喜欢用什么软件可以自行 Google～&lt;/p&gt;
&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/05/10/chongming-cycling/&quot;&gt;http://gonghonglou.com/2016/05/10/chongming-cycling&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;事件：&lt;/strong&gt;环崇明岛骑行&lt;br&gt;&lt;strong&gt;人物：&lt;/strong&gt;博主、博主的小伙伴&lt;br&gt;&lt;strong&gt;时间：&lt;/strong&gt;五一小假&lt;br&gt;&lt;strong&gt;地点：&lt;/strong&gt;崇明岛&lt;br&gt;&lt;strong&gt;正文：&lt;/strong
    
    </summary>
    
      <category term="Journey" scheme="http://gonghonglou.com/categories/Journey/"/>
    
    
  </entry>
  
  <entry>
    <title>Mac上搭建Apache Tomcat ＋ MySQL</title>
    <link href="http://gonghonglou.com/2016/04/01/build-tomcat/"/>
    <id>http://gonghonglou.com/2016/04/01/build-tomcat/</id>
    <published>2016-04-01T08:27:06.000Z</published>
    <updated>2017-07-24T04:14:43.000Z</updated>
    
    <content type="html">&lt;p&gt;因连接公司项目的测试服务器各种不便所以搭了个本地服务器Apache Tomcat，数据库用的MySQL。写下过程一来总结，二来分享，希望能帮到诸位一二，来介绍需要下载用到的工具吧。&lt;/p&gt;
&lt;h3 id=&quot;Java环境&quot;&gt;&lt;a href=&quot;#Java环境&quot; class=&quot;headerlink&quot; title=&quot;Java环境&quot;&gt;&lt;/a&gt;Java环境&lt;/h3&gt;&lt;p&gt;点击下载：&lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jdk-7u79-macosx-x64.dmg&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载之后一路点击安装即可&lt;/p&gt;
&lt;h3 id=&quot;MySQL数据库&quot;&gt;&lt;a href=&quot;#MySQL数据库&quot; class=&quot;headerlink&quot; title=&quot;MySQL数据库&quot;&gt;&lt;/a&gt;MySQL数据库&lt;/h3&gt;&lt;p&gt;点击下载：&lt;a href=&quot;https://dev.mysql.com/downloads/file/?id=461482&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;mysql-5.6.29-osx10.8-x86_64&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;下载之后同样一路点击安装即可，默认的安装路径为 &lt;code&gt;/usr/local/mysql-5.6.29-osx10.8-x86_64&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;此时，在系统偏好设置的最下方如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/apachetomcat/mysql.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;p&gt;点击MySQL，然后点击 &lt;code&gt;Start MySQL Server&lt;/code&gt; 开启数据库服务&lt;/p&gt;
&lt;p&gt;/Users/user/Desktop/BuildTomcat:mysql.png&lt;/p&gt;
&lt;h3 id=&quot;阿帕奇服务器&quot;&gt;&lt;a href=&quot;#阿帕奇服务器&quot; class=&quot;headerlink&quot; title=&quot;阿帕奇服务器&quot;&gt;&lt;/a&gt;阿帕奇服务器&lt;/h3&gt;&lt;p&gt;点击下载：&lt;a href=&quot;http://tomcat.apache.org/download-70.cgi&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;apache-tomcat-7.0.68.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载解压后放到任一目录中，我选择的是MySQL的默认安装目录下 &lt;code&gt;/usr/local/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;终端 &lt;code&gt;cd&lt;/code&gt; 到阿帕奇服务器所在目录的 &lt;code&gt;bin&lt;/code&gt; 目录下，执行如下命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ./startup.sh        // 开启服务器/Users/user/Desktop/mysql.png

$ ./shutdown.sh       // 关闭服务器
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;新下载的tomcat在启动时会报错：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./startup.sh: Permission denied
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这是因为权限问题，执行如下命令即可解决：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ chmod u+x *.sh    //表示对当前目录下的*.sh文件的所有者增加可执行权限
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;再次执行开启服务器命令即可。成功开启服务器后，浏览器打开 &lt;a href=&quot;http://localhost:8080&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost:8080&lt;/a&gt; 出现如下界面表示开启成功：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/apachetomcat/localhost.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;如上图点击&lt;code&gt;Manager App&lt;/code&gt;登录需要账号密码，点击&lt;code&gt;取消&lt;/code&gt;会有解释。&lt;br&gt;即打开&lt;code&gt;/usr/local/apache-tomcat-7.0.68/conf&lt;/code&gt;目录下的&lt;code&gt;tomcat-users.xml&lt;/code&gt;文件，在下方添加配置用户名密码如：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;role rolename=&amp;quot;manager-gui&amp;quot;/&amp;gt;
&amp;lt;user username=&amp;quot;tomcat_name&amp;quot; password=&amp;quot;tomcat_password&amp;quot; roles=&amp;quot;manager-gui&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;Sequel-Pro&quot;&gt;&lt;a href=&quot;#Sequel-Pro&quot; class=&quot;headerlink&quot; title=&quot;Sequel Pro&quot;&gt;&lt;/a&gt;Sequel Pro&lt;/h3&gt;&lt;p&gt;点击下载mysql的图形化工具：&lt;a href=&quot;http://sequelpro.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;sequel-pro-1.1.1.dmg&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;安装成功后打开，设置如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/apachetomcat/sequel.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Name&lt;/code&gt;随意，MySQL初始用户名为&lt;code&gt;root&lt;/code&gt; 密码为空，因为初始并没有数据库所以&lt;code&gt;Database&lt;/code&gt;也为空。&lt;/p&gt;
&lt;p&gt;点击&lt;code&gt;Connect&lt;/code&gt;进入后&lt;/p&gt;
&lt;p&gt;1：左上角选择&lt;code&gt;Add Database...&lt;/code&gt;，填入一个名字如&lt;code&gt;troy&lt;/code&gt;，点击&lt;code&gt;add&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2：&lt;code&gt;Sequel Pro&lt;/code&gt;菜单栏选择&lt;code&gt;Database&lt;/code&gt;–&amp;gt;&lt;code&gt;User Accounts...&lt;/code&gt;,给 root 用户添加用户名密码，点击&lt;code&gt;Apply&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这样在下次登录时就要把&lt;code&gt;Password&lt;/code&gt;和&lt;code&gt;Database&lt;/code&gt;填上再连接&lt;/p&gt;
&lt;h3 id=&quot;添加数据&quot;&gt;&lt;a href=&quot;#添加数据&quot; class=&quot;headerlink&quot; title=&quot;添加数据&quot;&gt;&lt;/a&gt;添加数据&lt;/h3&gt;&lt;p&gt;将自己的&lt;code&gt;.sql&lt;/code&gt;文件用&lt;code&gt;Sequel Pro&lt;/code&gt;打开并运行，这样在数据库中就有了数据&lt;/p&gt;
&lt;p&gt;将自己的&lt;code&gt;.war&lt;/code&gt;的&lt;code&gt;jar&lt;/code&gt;包添加到&lt;code&gt;/usr/local/apache-tomcat-7.0.68/webapps&lt;/code&gt;目录下，这样就有了执行程序&lt;/p&gt;
&lt;p&gt;终端 &lt;code&gt;cd&lt;/code&gt; 到阿帕奇服务器所在目录的 &lt;code&gt;bin&lt;/code&gt; 目录下，开启服务器可执行如下任一命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ./startup.sh         // 单纯开启服务器

$ ./catalina.sh run    // 开启服务器，控制台可打印服务器数据
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;到这里本地服务器就开启了&lt;/p&gt;
&lt;p&gt;执行如下命令，查看服务器在局域网中的地址：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ifconfig
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这样你的手机等设备也可以连接到本地服务器了&lt;/p&gt;
&lt;h3 id=&quot;总结一下&quot;&gt;&lt;a href=&quot;#总结一下&quot; class=&quot;headerlink&quot; title=&quot;总结一下&quot;&gt;&lt;/a&gt;总结一下&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;jdk-7u79-macosx-x64.dmg&lt;br&gt; java环境&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mysql-5.6.29-osx10.9-x86_64.dmg&lt;br&gt; mysql数据库&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;apache-tomcat-7.0.68.zip&lt;br&gt; 阿帕奇服务器&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;sequel-pro-1.1.1.dmg&lt;br&gt; mysql的图形化工具&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;troy_2016-03-25.sql&lt;br&gt; sql语句，放在 Sequel Pro中执行，生成数据）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rest.war&lt;br&gt; 运行程序，放在 apache-tomcat-7.0.68/webapps 目录下&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;开启服务器&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;愉快的玩耍&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h3&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/04/01/build-tomcat&quot;&gt;http://gonghonglou.com/2016/04/01/build-tomcat&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;因连接公司项目的测试服务器各种不便所以搭了个本地服务器Apache Tomcat，数据库用的MySQL。写下过程一来总结，二来分享，希望能帮到诸位一二，来介绍需要下载用到的工具吧。&lt;/p&gt;
&lt;h3 id=&quot;Java环境&quot;&gt;&lt;a href=&quot;#Java环境&quot; class=&quot;h
    
    </summary>
    
      <category term="Technology" scheme="http://gonghonglou.com/categories/Technology/"/>
    
    
  </entry>
  
  <entry>
    <title>解决OS X 10.11之后CocoaPods的升级问题</title>
    <link href="http://gonghonglou.com/2016/04/01/update-pods-que/"/>
    <id>http://gonghonglou.com/2016/04/01/update-pods-que/</id>
    <published>2016-04-01T07:24:10.000Z</published>
    <updated>2017-07-24T04:15:16.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;问题描述：&quot;&gt;&lt;a href=&quot;#问题描述：&quot; class=&quot;headerlink&quot; title=&quot;问题描述：&quot;&gt;&lt;/a&gt;问题描述：&lt;/h3&gt;&lt;p&gt;OS X 10.11之后升级CocoaPods，执行命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo gem update cocoapods           // 更新至最新版
$ sudo gem update cocoapods --pre     // 或者 更新至测试版
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;报如下错误：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ERROR: While executing gem ... (Errno::EPERM)
Operation not permitted - /usr/bin/pod
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;解决方案一：&quot;&gt;&lt;a href=&quot;#解决方案一：&quot; class=&quot;headerlink&quot; title=&quot;解决方案一：&quot;&gt;&lt;/a&gt;解决方案一：&lt;/h3&gt;&lt;p&gt;使用如下命令更新：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo gem install -n /usr/local/bin cocoapods         // 更新至最新版
$ sudo gem install -n /usr/local/bin cocoapods --pre    // 或者 更新至预览版
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这种解决方法最开始的&lt;code&gt;sudo gem update cocoapods&lt;/code&gt; 和 &lt;code&gt;sudo gem update cocoapods --pre&lt;/code&gt;升级命令是不能用的，若想一切恢复正常请尝试解决方案二。&lt;/p&gt;
&lt;h3 id=&quot;解决方案二：&quot;&gt;&lt;a href=&quot;#解决方案二：&quot; class=&quot;headerlink&quot; title=&quot;解决方案二：&quot;&gt;&lt;/a&gt;解决方案二：&lt;/h3&gt;&lt;p&gt;推倒重来。。。&lt;br&gt;安装Homebrew&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ruby -e &amp;quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;安装Ruby：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;brew install ruby
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;升级CocoaPods，执行命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo gem install cocoapods           // 更新至最新版
$ sudo gem install cocoapods --pre     // 或者 更新至测试版
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;此后，一切OK～&lt;/p&gt;
&lt;h3 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;上一篇文章关于CocoaPods的详细介绍：&lt;a href=&quot;http://gonghonglou.com/2016/04/01/CocoaPods&quot;&gt;iOS的库依赖管理工具CocoaPods&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/04/01/update-pods-que&quot;&gt;http://gonghonglou.com/2016/04/01/update-pods-que&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;问题描述：&quot;&gt;&lt;a href=&quot;#问题描述：&quot; class=&quot;headerlink&quot; title=&quot;问题描述：&quot;&gt;&lt;/a&gt;问题描述：&lt;/h3&gt;&lt;p&gt;OS X 10.11之后升级CocoaPods，执行命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo gem up
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS的库依赖管理工具CocoaPods</title>
    <link href="http://gonghonglou.com/2016/04/01/CocoaPods/"/>
    <id>http://gonghonglou.com/2016/04/01/CocoaPods/</id>
    <published>2016-04-01T07:17:10.000Z</published>
    <updated>2017-08-28T17:07:22.000Z</updated>
    
    <content type="html">&lt;p&gt;工欲善其事，必先利其器！在iOS开发中 &lt;a href=&quot;https://github.com/CocoaPods/CocoaPods&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CocoaPods&lt;/a&gt; 作为库依赖管理工具就是一把利器。&lt;/p&gt;
&lt;p&gt;有了CocoaPods你再也不需要手动将需要的第三方库拖进你的工程、添加第三方库所依赖的framework、设置如&lt;code&gt;-fno-objc-arc&lt;/code&gt;等编译参数、手动管理这些库的更新，当某个第三方库有依赖其他的库还要继续拖、拖、拖……&lt;/p&gt;
&lt;p&gt;我们只需要将所需要的第三方库声明到一个名为&lt;code&gt;Podfile&lt;/code&gt;文件中，然后执行&lt;code&gt;Pod install&lt;/code&gt;命令就OK了，CocoaPods就会自动去下载我们所需要库，并为我的工程设置好相应的系统依赖和编译参数。 &lt;/p&gt;
&lt;p&gt;只能说，好用到哭～&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/cocoapods/cocoapods-icon.png&quot; alt=&quot;CocoaPods&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;安装CocoaPods&quot;&gt;&lt;a href=&quot;#安装CocoaPods&quot; class=&quot;headerlink&quot; title=&quot;安装CocoaPods&quot;&gt;&lt;/a&gt;安装CocoaPods&lt;/h2&gt;&lt;p&gt;CocoaPods依赖于Ruby环境，刚好Mac下自带Ruby，使用Ruby的gem命令即可安装CocoaPods。&lt;br&gt;为防止因gem太老而引发问题，建议执行如下命令先更新gem：&lt;/p&gt;
&lt;figure class=&quot;highlight gams&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; sudo gem update --&lt;span class=&quot;keyword&quot;&gt;system&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行如下命令安装CocoaPods：&lt;/p&gt;
&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo gem &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; cocoapods&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果执行上述命令后没有反应，那是因为Ruby的软件源 &lt;a href=&quot;https://rubygems.org&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://rubygems.org&lt;/a&gt; 使用的是亚马逊的云服务而被墙了（GFW的伟大。。。）&lt;br&gt;可以用淘宝的Ruby镜像来访问cocoapods，依次执行如下命令将官方的Ruby源替换成国内淘宝的源&lt;/p&gt;
&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# $ gem sources --remove https:&lt;span class=&quot;comment&quot;&gt;//rubygems.org/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# $ gem sources -a https:&lt;span class=&quot;comment&quot;&gt;//ruby.taobao.org/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行如下命令验证Ruby镜像的确是taobao的：&lt;/p&gt;
&lt;figure class=&quot;highlight vala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# $ gem sources -l&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;出现如下文字才说明上面的命令是执行成功的：&lt;/p&gt;
&lt;figure class=&quot;highlight vala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# *** CURRENT SOURCES ***&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# https://ruby.taobao.org/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;此时，再次执行gem命令安装CocoaPods：&lt;/p&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;sudo gem install cocoapods&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;pod setup&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;稍等片刻 即可安装成功。    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注： &lt;a href=&quot;http://guides.cocoapods.org/terminal/commands.html#pod_setup&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;pod setup&lt;/code&gt;&lt;/a&gt; 是Cocoapods将它的信息下载到 &lt;code&gt;~/.cocoapods/repos&lt;/code&gt; 目录下。即使在安装时不执行此命令，在初次执行 &lt;code&gt;pod install&lt;/code&gt; 命令时，系统也会自动执行 &lt;code&gt;pod setup&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;——10-27更新-以下————————————————&quot;&gt;&lt;a href=&quot;#——10-27更新-以下————————————————&quot; class=&quot;headerlink&quot; title=&quot;——10.27更新 以下————————————————&quot;&gt;&lt;/a&gt;——10.27更新 以下————————————————&lt;/h4&gt;&lt;p&gt;ruby.taobao.org 停止更新了，使用 cocoapods 的同学，请更新到 &lt;a href=&quot;https://gems.ruby-china.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ruby china&lt;/a&gt; 的源。更新方法：&lt;br&gt;使用如下命令查看镜像源：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ gem sources &lt;span class=&quot;_&quot;&gt;-l&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;更改镜像源：&lt;/p&gt;
&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ gem sources --&lt;span class=&quot;built_in&quot;&gt;add&lt;/span&gt; http&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;//gems.&lt;span class=&quot;keyword&quot;&gt;ruby&lt;/span&gt;-china.org/ --&lt;span class=&quot;built_in&quot;&gt;remove&lt;/span&gt; http&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;//rubygems.org/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;or&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ gem sources --&lt;span class=&quot;built_in&quot;&gt;add&lt;/span&gt; http&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;//gems.&lt;span class=&quot;keyword&quot;&gt;ruby&lt;/span&gt;-china.org/ --&lt;span class=&quot;built_in&quot;&gt;remove&lt;/span&gt; http&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;//&lt;span class=&quot;keyword&quot;&gt;ruby&lt;/span&gt;.taobao.org/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;——10-27更新-以上————————————————&quot;&gt;&lt;a href=&quot;#——10-27更新-以上————————————————&quot; class=&quot;headerlink&quot; title=&quot;——10.27更新 以上————————————————&quot;&gt;&lt;/a&gt;——10.27更新 以上————————————————&lt;/h4&gt;&lt;h2 id=&quot;升级CocoaPods&quot;&gt;&lt;a href=&quot;#升级CocoaPods&quot; class=&quot;headerlink&quot; title=&quot;升级CocoaPods&quot;&gt;&lt;/a&gt;升级CocoaPods&lt;/h2&gt;&lt;p&gt;升级CocoaPods非常简单，使用Ruby的gem命令：&lt;/p&gt;
&lt;figure class=&quot;highlight gams&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; sudo gem update cocoapods           &lt;span class=&quot;comment&quot;&gt;// 更新至最新版&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;or&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; sudo gem update cocoapods --pre     &lt;span class=&quot;comment&quot;&gt;// 更新至预览版&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当然执行如下命令也可以更新：&lt;/p&gt;
&lt;figure class=&quot;highlight gams&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; sudo gem install cocoapods           &lt;span class=&quot;comment&quot;&gt;// 更新至最新版&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;or&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; sudo gem install cocoapods --pre     &lt;span class=&quot;comment&quot;&gt;// 更新至预览版&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;注：OS X 10.11之后升级CocoaPods会有问题。解决方案参见下一篇博客：&lt;a href=&quot;http://gonghonglou.com/2016/04/01/UpdatePodsQue&quot;&gt;解决OS X 10.11之后CocoaPods的升级问题&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;降级CocoaPods&quot;&gt;&lt;a href=&quot;#降级CocoaPods&quot; class=&quot;headerlink&quot; title=&quot;降级CocoaPods&quot;&gt;&lt;/a&gt;降级CocoaPods&lt;/h2&gt;&lt;p&gt;有时我们需要降低CocoaPods版本来解决某些第三方库的兼容问题，例如&lt;a href=&quot;https://github.com/RestKit/RestKit&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RestKit&lt;/a&gt;不兼容CocoaPods的&lt;code&gt;0.39.0&lt;/code&gt;版本，降级到&lt;code&gt;0.38.2&lt;/code&gt;就OK了。&lt;/p&gt;
&lt;h4 id=&quot;移除RubyGems中的Cocoapods程序包&quot;&gt;&lt;a href=&quot;#移除RubyGems中的Cocoapods程序包&quot; class=&quot;headerlink&quot; title=&quot;移除RubyGems中的Cocoapods程序包&quot;&gt;&lt;/a&gt;移除RubyGems中的Cocoapods程序包&lt;/h4&gt;&lt;p&gt;查看&lt;a href=&quot;http://baike.baidu.com/view/1772268.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gems&lt;/a&gt;中本地程序包，执行如下命令：&lt;br&gt;&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ gem &lt;span class=&quot;built_in&quot;&gt;list&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;输出如下：&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;*** &lt;span class=&quot;selector-tag&quot;&gt;LOCAL&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;GEMS&lt;/span&gt; ***&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;activesupport&lt;/span&gt; (4&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;bigdecimal&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.8&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;claide&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.9&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.39&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-core&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.39&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-deintegrate&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-downloader&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.9&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-plugins&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-search&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-stats&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.6&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-trunk&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.6&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods-try&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;colored&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;did_you_mean&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;escape&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;fourflusher&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;fuzzy_match&lt;/span&gt; (2&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;i18n&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.7&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;io-console&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.5&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;json&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.8&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;minitest&lt;/span&gt; (5&lt;span class=&quot;selector-class&quot;&gt;.8&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;molinillo&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;nap&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;net-telnet&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;netrc&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.7&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.8&lt;/span&gt;)     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;power_assert&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.6&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;psych&lt;/span&gt; (2&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.17&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;rake&lt;/span&gt; (10&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;rdoc&lt;/span&gt; (4&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;rubygems-update&lt;/span&gt; (2&lt;span class=&quot;selector-class&quot;&gt;.6&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;test-unit&lt;/span&gt; (3&lt;span class=&quot;selector-class&quot;&gt;.1&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.5&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;thread_safe&lt;/span&gt; (0&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.5&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;tzinfo&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;xcodeproj&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.3&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.28&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中包含的CocoaPods版本：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;cocoapods&lt;/span&gt; (1&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;, 0&lt;span class=&quot;selector-class&quot;&gt;.39&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;移除指定版本cocoapods如1.0.0.beta.4，执行如下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight gams&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; sudo gem uninstall cocoapods -v &lt;span class=&quot;number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;.&lt;span class=&quot;built-in&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;成功删除则输出：&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;Successfully&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;uninstalled&lt;/span&gt; &lt;span class=&quot;selector-tag&quot;&gt;cocoapods-1&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.beta&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;还有一个0.39.0版本，移除程序包，执行如下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;sudo gem uninstall cocoapods -v &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;39.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当移除最后一个版本时，询问：&lt;/p&gt;
&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Remove &lt;span class=&quot;built_in&quot;&gt;executable&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pod, &lt;span class=&quot;keyword&quot;&gt;sandbox&lt;/span&gt;-pod&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  in addition &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; the gem? [Yn]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;按下回车键删除pod。查看CocoaPods组件的安装目录，执行命令&lt;code&gt;$ which pod&lt;/code&gt;所得目录下的&lt;code&gt;pod&lt;/code&gt;文件随即删除。    &lt;/p&gt;
&lt;h4 id=&quot;安装指定版本的Cocoapods程序包&quot;&gt;&lt;a href=&quot;#安装指定版本的Cocoapods程序包&quot; class=&quot;headerlink&quot; title=&quot;安装指定版本的Cocoapods程序包&quot;&gt;&lt;/a&gt;安装指定版本的Cocoapods程序包&lt;/h4&gt;&lt;p&gt;安装指定版本的CocoaPods 如0.39.0，执行如下命令：&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo gem &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; cocoapods -v &lt;span class=&quot;number&quot;&gt;0.39&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：若不指定版本，即命令如&lt;code&gt;sudo gem install cocoapods&lt;/code&gt;则默认安装最新版。    &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;安装成功后，执行命令查看版本号：&lt;/p&gt;
&lt;figure class=&quot;highlight ada&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod &lt;span class=&quot;comment&quot;&gt;--version&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;输出：&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0&lt;span class=&quot;selector-class&quot;&gt;.39&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;使用CocoaPods&quot;&gt;&lt;a href=&quot;#使用CocoaPods&quot; class=&quot;headerlink&quot; title=&quot;使用CocoaPods&quot;&gt;&lt;/a&gt;使用CocoaPods&lt;/h2&gt;&lt;h4 id=&quot;搜索第三方库&quot;&gt;&lt;a href=&quot;#搜索第三方库&quot; class=&quot;headerlink&quot; title=&quot;搜索第三方库&quot;&gt;&lt;/a&gt;搜索第三方库&lt;/h4&gt;&lt;p&gt;为判断某第三方库（如AFNetworking）是否支持CocoaPods，执行如下命令来搜索：&lt;/p&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;pod search AFNetworking&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;若如下图所示，则可用CocoaPods管理AFNetworking&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/CocoaPods/searchAFNetworking.png&quot; alt=&quot;searchAFNetworking&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;创建Podfile的文件&quot;&gt;&lt;a href=&quot;#创建Podfile的文件&quot; class=&quot;headerlink&quot; title=&quot;创建Podfile的文件&quot;&gt;&lt;/a&gt;创建&lt;code&gt;Podfile&lt;/code&gt;的文件&lt;/h4&gt;&lt;p&gt;CocoaPods就可以根据&lt;code&gt;Podfile&lt;/code&gt;文件里的内容来帮你下载你所需要的库。&lt;a href=&quot;https://guides.cocoapods.org/using/the-podfile.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击前往&lt;/a&gt;CocoaPods官方对&lt;code&gt;Podfile&lt;/code&gt;文件的介绍。&lt;br&gt;终端&lt;code&gt;cd&lt;/code&gt;到你的项目所在目录下，创建&lt;code&gt;Podfile&lt;/code&gt;文件：&lt;/p&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;vim Podfile&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;按下&lt;code&gt;i&lt;/code&gt;键进入输入状态，在&lt;code&gt;Podfile&lt;/code&gt;文件里输入以下文字：&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;platform &lt;span class=&quot;symbol&quot;&gt;:ios&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;8.0&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;target &lt;span class=&quot;string&quot;&gt;&#39;Your_App_Name&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pod &lt;span class=&quot;string&quot;&gt;&#39;AFNetworking&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;~&amp;gt; 3.0&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;按下&lt;code&gt;esc&lt;/code&gt;键退出输入。然后保存退出，命令是&lt;code&gt;:wq&lt;/code&gt;。你当然可以使用&lt;code&gt;vim&lt;/code&gt;之外的编辑软件来编辑&lt;code&gt;Podfile&lt;/code&gt;文件。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：cocoapods-1.0.0.beta版本后规定&lt;code&gt;Podfile&lt;/code&gt;文件必须如上所示格式（加上&lt;code&gt;target&lt;/code&gt;）&lt;/p&gt;
&lt;p&gt;当然，采用创建&lt;code&gt;Podfile&lt;/code&gt;文件的另一种方式，终端&lt;code&gt;cd&lt;/code&gt;到你的项目所在目录下执行命令 &lt;code&gt;pod init&lt;/code&gt; 会自动生成格式，自己试一下你会喜欢的～&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;终端&lt;code&gt;cd&lt;/code&gt;到你的项目所在目录下执行如下命令来利用CocoPods下载第三方库：&lt;/p&gt;
&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如下图所示则下载成功：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/CocoaPods/podInstall.png&quot; alt=&quot;pod install&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;提示：[!] Please close any current Xcode sessions and use &lt;code&gt;Your_App_Name.xcworkspace&lt;/code&gt; for this project from now on.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;打开&lt;code&gt;Your_App_Name.xcworkspace&lt;/code&gt; 工程之后会看到 &lt;code&gt;Pods&lt;/code&gt; 文件，&lt;code&gt;AFNetwoking&lt;/code&gt;已经成功导入项目了。 &lt;/p&gt;
&lt;p&gt;你或许应当&lt;a href=&quot;https://guides.cocoapods.org/using/pod-install-vs-update.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击前往&lt;/a&gt;CocoaPods官网查看对&lt;code&gt;pod install vs. pod update&lt;/code&gt;的介绍。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：当你 &lt;code&gt;clone&lt;/code&gt; 别人的项目到本地后也需要终端&lt;code&gt;cd&lt;/code&gt;到项目所在目录下执行命令 &lt;code&gt;$ pod install&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;关于Podfile-lock的文件&quot;&gt;&lt;a href=&quot;#关于Podfile-lock的文件&quot; class=&quot;headerlink&quot; title=&quot;关于Podfile.lock的文件&quot;&gt;&lt;/a&gt;关于&lt;code&gt;Podfile.lock&lt;/code&gt;的文件&lt;/h4&gt;&lt;p&gt;执行&lt;code&gt;pod install&lt;/code&gt;之后，CocoaPods会生成一个名为&lt;code&gt;Podfile.lock&lt;/code&gt;的文件。并锁定当前各依赖库的版本，之后如果多次执行&lt;code&gt;pod install&lt;/code&gt;或者团队中的其它人check下来这份包含&lt;code&gt;Podfile.lock&lt;/code&gt;文件的工程后再执行&lt;code&gt;pod install&lt;/code&gt;命令时，获取下来的Pods依赖库的版本就和最开始用户获取到的版本一致。如果没有&lt;code&gt;Podfile.lock&lt;/code&gt;文件，执行&lt;code&gt;pod install&lt;/code&gt;命令会获取第三方库的最新版本，这就有可能造成同一个团队使用的依赖库版本不一致，这对团队协作的危害无疑是灾难性的！&lt;br&gt;在这种情况下，如果团队想使用当前最新版本的依赖库，有两种方案可修改&lt;code&gt;Podfile.lock&lt;/code&gt;的纪录：    &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;更改&lt;code&gt;Podfile&lt;/code&gt;中各依赖库的版本&lt;/li&gt;
&lt;li&gt;执行&lt;code&gt;pod update&lt;/code&gt;命令&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;鉴于&lt;code&gt;Podfile.lock&lt;/code&gt;文件对团队协作如此重要，我们应该将它添加到版本控制里。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://guides.cocoapods.org/using/using-cocoapods.html#should-i-ignore-the-pods-directory-in-source-control&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击前往&lt;/a&gt;CocoaPods官网查看对&lt;code&gt;Podfile.lock&lt;/code&gt;的介绍。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;补充：有时执行&lt;code&gt;pod update&lt;/code&gt;命令会特别慢，可以尝试使用如下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod &lt;span class=&quot;keyword&quot;&gt;update&lt;/span&gt; --&lt;span class=&quot;keyword&quot;&gt;verbose&lt;/span&gt; --&lt;span class=&quot;keyword&quot;&gt;no&lt;/span&gt;-repo-&lt;span class=&quot;keyword&quot;&gt;update&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;pod install&lt;/code&gt;命令同理：&lt;br&gt;&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod install --&lt;span class=&quot;keyword&quot;&gt;verbose&lt;/span&gt; --&lt;span class=&quot;keyword&quot;&gt;no&lt;/span&gt;-repo-&lt;span class=&quot;keyword&quot;&gt;update&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;发布自己的开源框架到CocoaPods&quot;&gt;&lt;a href=&quot;#发布自己的开源框架到CocoaPods&quot; class=&quot;headerlink&quot; title=&quot;发布自己的开源框架到CocoaPods&quot;&gt;&lt;/a&gt;发布自己的开源框架到CocoaPods&lt;/h2&gt;&lt;p&gt;你需要如下图创建一个Framework来打造你自己的开源框架&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/CocoaPods/Framework.png&quot; alt=&quot;Framework&quot;&gt;&lt;/p&gt;
&lt;p&gt;在工程目录下添加一份开源协议文件，一般为“LICENSE”，在 github 上新建仓库时可以同时新建 README.md 文件及 LICENSE 文件。&lt;/p&gt;
&lt;p&gt;在开始之前你应当使用邮箱账号&lt;a href=&quot;https://guides.cocoapods.org/making/getting-setup-with-trunk.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;注册 CocoaPods&lt;/a&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;pod trunk register my_name&lt;span class=&quot;variable&quot;&gt;@example&lt;/span&gt;.com &lt;span class=&quot;string&quot;&gt;&#39;my_name&#39;&lt;/span&gt; --description=&lt;span class=&quot;string&quot;&gt;&#39;macbook pro&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;随后会收到一份验证邮件，点击链接进行验证，之后通过以下命令查看注册结果：&lt;/p&gt;
&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod trunk &lt;span class=&quot;keyword&quot;&gt;me&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;结果应为：&lt;/p&gt;
&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;attribute&quot;&gt;Name&lt;/span&gt;:     my_name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;attribute&quot;&gt;Email&lt;/span&gt;:    my_name&lt;span class=&quot;variable&quot;&gt;@example&lt;/span&gt;.com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;attribute&quot;&gt;Since&lt;/span&gt;:    August &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;th, &lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;attribute&quot;&gt;Pods&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  - my_framework_name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;attribute&quot;&gt;Sessions&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  - August &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;th, &lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;45&lt;/span&gt; - January &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;rd, &lt;span class=&quot;number&quot;&gt;2018&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;. &lt;span class=&quot;attribute&quot;&gt;IP&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;116.226&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;129.252&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;Description&lt;/span&gt;: macbook pro&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;加下来就是正式开始推送自己的框架到 CocoaPods，&lt;br&gt;发布自己的开源框架到CocoaPods同样需要一个类似&lt;code&gt;Podfile&lt;/code&gt;的文件来告诉CocoaPods我们开源库的名称、版本、作者、描述、地址、所需的framework、依赖库等，这个文件叫&lt;code&gt;my_framework_name.podspec&lt;/code&gt;，开始创建这个文件&lt;/p&gt;
&lt;p&gt;终端&lt;code&gt;cd&lt;/code&gt;到工程目录下，执行如下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight crmsh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod &lt;span class=&quot;keyword&quot;&gt;spec&lt;/span&gt; create my_framework_name&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样在你的工程目录下会生成一个&lt;code&gt;my_framework_name.podspec&lt;/code&gt;文件，大概内容为（将对应名称修改为你自己的）：&lt;/p&gt;
&lt;figure class=&quot;highlight ruby&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Pod::Spec.new &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;|s|&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.name         = &lt;span class=&quot;string&quot;&gt;&quot;DJLSplitCollectionView&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.summary      = &lt;span class=&quot;string&quot;&gt;&quot;It is my first framework.&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.version      = &lt;span class=&quot;string&quot;&gt;&quot;0.0.1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.license      = &amp;#123; &lt;span class=&quot;symbol&quot;&gt;:type&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;MIT&#39;&lt;/span&gt;, &lt;span class=&quot;symbol&quot;&gt;:file&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&#39;LICENSE&#39;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.author       = &amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;gonghonglou&quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;gonghonglou@gmail.com&quot;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.social_media_url = &lt;span class=&quot;string&quot;&gt;&#39;http://gonghonglou.com&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.homepage     = &lt;span class=&quot;string&quot;&gt;&quot;https://github.com/gonghonglou/DJLSplitCollectionView&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.platform     = &lt;span class=&quot;symbol&quot;&gt;:ios&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;8.0&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.ios.deployment_target = &lt;span class=&quot;string&quot;&gt;&#39;8.0&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.source       = &amp;#123; &lt;span class=&quot;symbol&quot;&gt;:git&lt;/span&gt; =&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;https://github.com/gonghonglou/DJLSplitCollectionView.git&quot;&lt;/span&gt;, &lt;span class=&quot;symbol&quot;&gt;:tag&lt;/span&gt; =&amp;gt; s.version.to_s &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.requires_arc = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.source_files = &lt;span class=&quot;string&quot;&gt;&#39;DJLSplitCollectionView/*.&amp;#123;h,m&amp;#125;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.public_header_files = &lt;span class=&quot;string&quot;&gt;&#39;DJLSplitCollectionView/*.&amp;#123;h&amp;#125;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  s.framework  = &lt;span class=&quot;string&quot;&gt;&quot;UIKit&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后执行如下命令&lt;/p&gt;
&lt;figure class=&quot;highlight crmsh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ git &lt;span class=&quot;keyword&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt;	// 给框架打上 &lt;span class=&quot;keyword&quot;&gt;tag&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;$&lt;/span&gt; git push origin --tags	// 将 &lt;span class=&quot;keyword&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;推送到 github&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;检查 podspec 语法和项目是否正常编译，执行如下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight crmsh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod &lt;span class=&quot;keyword&quot;&gt;spec&lt;/span&gt; lint my_framework_name.podspec&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;确保没有任何 error 和 warning ，然后推送 podspec 到 CocoaPods 的主仓库就可以了&lt;/p&gt;
&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pod trunk push my_framework_name&lt;span class=&quot;selector-class&quot;&gt;.podspec&lt;/span&gt;    &lt;span class=&quot;comment&quot;&gt;// 提交到 CocoaPods 中心仓库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;成功后结果应该为：&lt;/p&gt;
&lt;figure class=&quot;highlight asciidoc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Updating spec repo &lt;span class=&quot;code&quot;&gt;`master`&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Validating podspec&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;code&quot;&gt; -&amp;gt; DJLSplitCollectionView (0.0.1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Updating spec repo &lt;span class=&quot;code&quot;&gt;`master`&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;code&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 🎉  Congrats&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 🚀  DJLSplitCollectionView (0.0.1) successfully published&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 📅  August 28th, 09:39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 🌎  https://cocoapods.org/pods/DJLSplitCollectionView&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 👍  Tell your friends!&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如图：&lt;img src=&quot;http://image.gonghonglou.com/CocoaPods/cocoapods_push.png&quot; alt=&quot;pod trunk push&quot;&gt;&lt;/p&gt;
&lt;p&gt;大功告成，几秒或者几分钟后 &lt;code&gt;pod search my_framework_name&lt;/code&gt; 搜索一下吧～&lt;br&gt;如果搜不到的话，建议执行如下方法：&lt;br&gt;&lt;figure class=&quot;highlight gradle&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;rm ~&lt;span class=&quot;regexp&quot;&gt;/Library/&lt;/span&gt;Caches&lt;span class=&quot;regexp&quot;&gt;/CocoaPods/&lt;/span&gt;search_index.json&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pod search my_framework_name&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/04/01/CocoaPods&quot;&gt;http://gonghonglou.com/2016/04/01/CocoaPods&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://guides.cocoapods.org/using/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Using CocoaPods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.superqq.com/blog/2014/10/16/cocoapodsan-zhuang-he-shi-yong-jiao-cheng/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CocoaPods安装和使用教程&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.devtang.com/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;用CocoaPods做iOS程序的依赖管理&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://onevcat.com/2016/01/create-framework/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;如何打造一个让人愉快的框架&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;工欲善其事，必先利其器！在iOS开发中 &lt;a href=&quot;https://github.com/CocoaPods/CocoaPods&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CocoaPods&lt;/a&gt; 作为库依赖管理工具就是一把利器。&lt;/p&gt;
&lt;p
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>初识ReactiveCocoa</title>
    <link href="http://gonghonglou.com/2016/03/17/meet-ReactiveCocoa/"/>
    <id>http://gonghonglou.com/2016/03/17/meet-ReactiveCocoa/</id>
    <published>2016-03-17T15:12:45.000Z</published>
    <updated>2017-07-24T04:16:18.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa&lt;/a&gt; 是一个Objective-C 框架，受 &lt;a href=&quot;https://en.wikipedia.org/wiki/Functional_reactive_programming&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Functional Reactive Programming&lt;/a&gt;的启发。它提供了一系列用来&lt;strong&gt;组合和转换值流&lt;/strong&gt;的API。&lt;/p&gt;
&lt;p&gt;如果你早已熟悉了函数响应式编程或者知道ReactiveCocoa的基本前提，看看&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa/tree/v2.5/Documentation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Documentation&lt;/a&gt;这个文件夹里的framework overview等文件更深一步来了解它是怎样在实践中工作的。&lt;/p&gt;
&lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;p&gt;ReactiveCocoa受&lt;a href=&quot;http://blog.maybeapps.com/post/42894317939/input-and-output&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;functional reactive programming&lt;/a&gt;的启发。在那些能被替换和修改的地方，RAC提供信号(由&lt;code&gt;RACSignal&lt;/code&gt;代表)来捕获当前和将来的值而不是使用可变的变量。&lt;/p&gt;
&lt;p&gt;通过链接，组合，和反馈的信号，软件可以不需要写那些持续观察和更新value的代码。&lt;/p&gt;
&lt;p&gt;例如，一个文本框能够根据它的改变被绑定到最后一次的值，而不是使用额外的代码每秒去监控时钟和更新文本框。这点跟KVO很像，不过是使用了block，而非&lt;code&gt;-observeValueForKeyPath:ofObject:change:context:&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;信号也可以进行异步操作，就像&lt;a href=&quot;https://en.wikipedia.org/wiki/Futures_and_promises&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;futures and promises&lt;/a&gt;。这极大的简化了异步软件中网络连接的代码。&lt;/p&gt;
&lt;p&gt;RAC的重大优势之一就是它提供信号(&lt;code&gt;signal&lt;/code&gt;)这种方式来统一的处理所有异步的行为，包括代理方法、block 回调、target-action 机制、通知和KVO。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/cheaptalk.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;p&gt;这里是简单的例子：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 当self.username改变时，打印新的名字到控制台&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// RACObserve(self, username)创建一个新的RACSignal，当前self.username的值发生改变时，发送新值给newName&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -subscribeNext: 当信号发送值时将触发block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[RACObserve(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, username) subscribeNext:^(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *newName) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, newName);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;与KVO 通知不同的是信号能够进行统一的链式操作：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 只有当名字的开头为&quot;j&quot;时才打印&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -filter 只有当block返回YES时才会创建一个新的RACSignal发送一个新值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[[RACObserve(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, username)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	filter:^(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *newName) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [newName hasPrefix:&lt;span class=&quot;string&quot;&gt;@&quot;j&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	subscribeNext:^(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *newName) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;%@&quot;&lt;/span&gt;, newName);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;信号也能被用来派生状态。在响应新值中RAC代替观察属性和设置其他的属性，能够在信号和运行周期内传达属性：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 当self.password 和 self.passwordConfirmation相同时创建一个单向的binding使得self.createEnabled为true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// RAC() 是一个宏指令使得binding看起来nicer&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// +combineLatest:reduce: 建一个信号数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 当任一个信号的最后一个值发生改变时触发这个block，返回一个新的RACSignal，将block返回的值作为values发送出去&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;RAC(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, createEnabled) = [RACSignal &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	combineLatest:@[ RACObserve(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, password), RACObserve(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, passwordConfirmation) ] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	reduce:^(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *password, &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *passwordConfirm) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; @([passwordConfirm isEqualToString:password]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;信号不仅是在KVO上，还能在建立在随着时间而改变的值流上。例如，它们可以代表按钮点击：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 当按钮被点击时打印信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// RACCommand创建信号去表示UI行为。例如，每一个信号可以表示一个按钮的点击、与它相关联的附加工作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -rac_command是封装的NSButton方法. 当按钮被点击时触发该命令&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.button.rac_command = [[RACCommand alloc] initWithSignalBlock:^(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; _) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;button was pressed!&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [RACSignal empty];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或者是异步网络操作：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 连接&quot;Log in&quot;按钮给网络登录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 当登录命令执行时运行block，开始登录进度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loginCommand = [[RACCommand alloc] initWithSignalBlock:^(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; sender) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// 假设当网络请求完成时 -logIn 方法返回一个信号发送一个value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [client logIn];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -executionSignals 每次执行该命令时，这个方法返回一个信号，包括以前的block返回的信号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loginCommand.executionSignals subscribeNext:^(RACSignal *loginSignal) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// 成功登录时打印信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[loginSignal subscribeCompleted:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;Logged in successfully!&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 按钮被点击时执行登录命令&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loginButton.rac_command = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loginCommand;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;信号也可以代表定时器，其他的UI事件，或者别的什么随时间而改变的事件。&lt;/p&gt;
&lt;p&gt;在异步操作方面，通过链接和转换信号可以建立更复杂的行为。在一组完整的操作之后更简单的来执行工作：&lt;/p&gt;
&lt;figure class=&quot;highlight axapta&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 执行2个网络操作，当它们都完成时打印信息到控制台&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// +merge: 当数组里的所有信号完成时，返回一个新的RACSignal&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -subscribeCompleted: 当信号完成时将执行这个block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[[RACSignal &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	merge:@[ [&lt;span class=&quot;keyword&quot;&gt;client&lt;/span&gt; fetchUserRepos], [&lt;span class=&quot;keyword&quot;&gt;client&lt;/span&gt; fetchOrgRepos] ]] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	subscribeCompleted:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;They&#39;re both done!&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;信号可以被链接到顺序执行异步操作，而不是使用一堆block回调。通常这样简单的来使用&lt;a href=&quot;https://en.wikipedia.org/wiki/Futures_and_promises&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;futures and promises&lt;/a&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 用户登录，下载缓存信息，获取服务器信息。都完成后将信息打印到控制台&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 假设登录之后 -logInUser 方法返回一个信号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -flattenMap: 当信号发送一个value时触发这个block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 并且返回一个新的RACSignal来整合从block返回的所有的信号到一个单一信号中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-attr&quot;&gt;[[[[client &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	logInUser]&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;selector-tag&quot;&gt;flattenMap&lt;/span&gt;:^(User *user) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;// 下载缓存信息，给用户返回一个信号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		return &lt;span class=&quot;selector-attr&quot;&gt;[client loadCachedMessagesForUser:user]&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;attribute&quot;&gt;flattenMap&lt;/span&gt;:^(NSArray *messages) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;// Return a signal that fetches any remaining messages.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		return [client &lt;span class=&quot;attribute&quot;&gt;fetchMessagesAfterMessage&lt;/span&gt;:messages.lastObject];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;attribute&quot;&gt;subscribeNext&lt;/span&gt;:^(NSArray *newMessages) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;New messages: %@&quot;&lt;/span&gt;, newMessages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125; &lt;span class=&quot;attribute&quot;&gt;completed&lt;/span&gt;:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;Fetched all messages.&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;RAC甚至可以简单的建立在一个异步操作的结果上：&lt;/p&gt;
&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建一个单向的binding，让 self.imageView.image 来放置下载下来的user的头像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 假设 -fetchUserWithUsername: 方法返回一个信号发送给user&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -deliverOn: 创建新的信号在其他的队列中进行他们的工作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 在这个例子中，此方法被用来将工作转移到后台队列和回到主线程&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// -map: 每个user调用这个block，获取并且返回一个新的RACSignal，并且将从block返回的值发送出去&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;RAC(self.imageView, image) = [[[[client &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	fetchUserWithUsername:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;joshaber&quot;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	deliverOn:&lt;/span&gt;[RACScheduler scheduler]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	map:&lt;/span&gt;^(User *user) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;// 下载头像 (在后台队列中进行).&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		return [[NSImage alloc] initWithContentsOfURL:user.avatarURL];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// 此时这个任务将在主线程中执行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	deliverOn:&lt;/span&gt;RACScheduler.mainThreadScheduler];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这是一些使用RAC的示范操作，但是它并不能说明RAC为什么如此强大。&lt;br&gt;更多示例代码参见&lt;a href=&quot;https://github.com/AshFurrow/C-41&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;C-41&lt;/a&gt; 或 &lt;a href=&quot;https://github.com/jspahrsummers/GroceryList&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GroceryList&lt;/a&gt;,这些是使用ReactiveCocoa编写的iOS APP。在这个文件夹&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa/tree/v2.5/Documentation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Documentation&lt;/a&gt;中可以查到更多的关于RAC的信息。&lt;/p&gt;
&lt;h2 id=&quot;使用ReactiveCocoa&quot;&gt;&lt;a href=&quot;#使用ReactiveCocoa&quot; class=&quot;headerlink&quot; title=&quot;使用ReactiveCocoa&quot;&gt;&lt;/a&gt;使用ReactiveCocoa&lt;/h2&gt;&lt;p&gt;乍一看ReactiveCocoa是非常抽象的，很难理解该怎样将它应用到具体的问题上。&lt;/p&gt;
&lt;p&gt;这有一些示例来展示RAC的优势&lt;/p&gt;
&lt;h3 id=&quot;处理异步或事件驱动的数据源&quot;&gt;&lt;a href=&quot;#处理异步或事件驱动的数据源&quot; class=&quot;headerlink&quot; title=&quot;处理异步或事件驱动的数据源&quot;&gt;&lt;/a&gt;处理异步或事件驱动的数据源&lt;/h3&gt;&lt;p&gt;许多Cocoa编程的重点是对用户事件的反应或应用状态的变化。处理这些事件的代码很快变得非常复杂的就像意大利面一样，伴随着许多回调函数和状态变量处理顺序的问题。&lt;/p&gt;
&lt;p&gt;表面上看起来模式不同，比如UI回调，网络响应和KVO通知，实际上有很多共同之处。&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa/blob/v2.5/ReactiveCocoa/RACSignal.h&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RACSignal&lt;/a&gt;统一了所有的这些不同的API，使他们可以组合在一起，并以同样的方式操纵。&lt;/p&gt;
&lt;p&gt;例如这样的代码：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *ObservationContext = &amp;amp;ObservationContext;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidLoad &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidLoad];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[LoginManager.sharedManager addObserver:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; forKeyPath:&lt;span class=&quot;string&quot;&gt;@&quot;loggingIn&quot;&lt;/span&gt; options:&lt;span class=&quot;built_in&quot;&gt;NSKeyValueObservingOptionInitial&lt;/span&gt; context:&amp;amp;ObservationContext];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;built_in&quot;&gt;NSNotificationCenter&lt;/span&gt;.defaultCenter addObserver:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; selector:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(loggedOut:) name:UserDidLogOutNotification object:LoginManager.sharedManager];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.usernameTextField addTarget:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; action:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(updateLogInButton) forControlEvents:&lt;span class=&quot;built_in&quot;&gt;UIControlEventEditingChanged&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.passwordTextField addTarget:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; action:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(updateLogInButton) forControlEvents:&lt;span class=&quot;built_in&quot;&gt;UIControlEventEditingChanged&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.logInButton addTarget:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; action:&lt;span class=&quot;keyword&quot;&gt;@selector&lt;/span&gt;(logInPressed:) forControlEvents:&lt;span class=&quot;built_in&quot;&gt;UIControlEventTouchUpInside&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)dealloc &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[LoginManager.sharedManager removeObserver:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; forKeyPath:&lt;span class=&quot;string&quot;&gt;@&quot;loggingIn&quot;&lt;/span&gt; context:ObservationContext];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;built_in&quot;&gt;NSNotificationCenter&lt;/span&gt;.defaultCenter removeObserver:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)updateLogInButton &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; textFieldsNonEmpty = &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.usernameTextField.text.length &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.passwordTextField.text.length &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;BOOL&lt;/span&gt; readyToLogIn = !LoginManager.sharedManager.isLoggingIn &amp;amp;&amp;amp; !&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loggedIn;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.logInButton.enabled = textFieldsNonEmpty &amp;amp;&amp;amp; readyToLogIn;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;IBAction&lt;/span&gt;)logInPressed:(&lt;span class=&quot;built_in&quot;&gt;UIButton&lt;/span&gt; *)sender &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[[LoginManager sharedManager]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		logInWithUsername:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.usernameTextField.text&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		password:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.passwordTextField.text&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		success:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loggedIn = &lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125; failure:^(&lt;span class=&quot;built_in&quot;&gt;NSError&lt;/span&gt; *error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; presentError:error];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)loggedOut:(&lt;span class=&quot;built_in&quot;&gt;NSNotification&lt;/span&gt; *)notification &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loggedIn = &lt;span class=&quot;literal&quot;&gt;NO&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)observeValueForKeyPath:(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *)keyPath ofObject:(&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)object change:(&lt;span class=&quot;built_in&quot;&gt;NSDictionary&lt;/span&gt; *)change context:(&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; *)context &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (context == ObservationContext) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; updateLogInButton];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; observeValueForKeyPath:keyPath ofObject:object change:change context:context];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;… 可以用RAC这样的表示：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)viewDidLoad &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt; viewDidLoad];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	@weakify(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	RAC(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.logInButton, enabled) = [RACSignal&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		combineLatest:@[&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.usernameTextField.rac_textSignal,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.passwordTextField.rac_textSignal,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			RACObserve(LoginManager.sharedManager, loggingIn),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			RACObserve(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, loggedIn)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		] reduce:^(&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *username, &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *password, &lt;span class=&quot;built_in&quot;&gt;NSNumber&lt;/span&gt; *loggingIn, &lt;span class=&quot;built_in&quot;&gt;NSNumber&lt;/span&gt; *loggedIn) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; @(username.length &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; password.length &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; !loggingIn.boolValue &amp;amp;&amp;amp; !loggedIn.boolValue);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.logInButton rac_signalForControlEvents:&lt;span class=&quot;built_in&quot;&gt;UIControlEventTouchUpInside&lt;/span&gt;] subscribeNext:^(&lt;span class=&quot;built_in&quot;&gt;UIButton&lt;/span&gt; *sender) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		@strongify(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		RACSignal *loginSignal = [LoginManager.sharedManager&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			logInWithUsername:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.usernameTextField.text&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			password:&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.passwordTextField.text];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			[loginSignal subscribeError:^(&lt;span class=&quot;built_in&quot;&gt;NSError&lt;/span&gt; *error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				@strongify(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				[&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt; presentError:error];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&amp;#125; completed:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				@strongify(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;.loggedIn = &lt;span class=&quot;literal&quot;&gt;YES&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	RAC(&lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, loggedIn) = [[&lt;span class=&quot;built_in&quot;&gt;NSNotificationCenter&lt;/span&gt;.defaultCenter&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		rac_addObserverForName:UserDidLogOutNotification object:&lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		mapReplace:@NO];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;链接依赖操作&quot;&gt;&lt;a href=&quot;#链接依赖操作&quot; class=&quot;headerlink&quot; title=&quot;链接依赖操作&quot;&gt;&lt;/a&gt;链接依赖操作&lt;/h3&gt;&lt;p&gt;依赖在网络请求中是常见的，在下一个请求建立之前，需要完成当前对服务器的请求，比如：&lt;/p&gt;
&lt;figure class=&quot;highlight scheme&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;name&quot;&gt;client&lt;/span&gt; logInWithSuccess:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;name&quot;&gt;client&lt;/span&gt; loadCachedMessagesWithSuccess:^(&lt;span class=&quot;name&quot;&gt;NSArray&lt;/span&gt; *messages) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[&lt;span class=&quot;name&quot;&gt;client&lt;/span&gt; fetchMessagesAfterMessage:messages.lastObject success:^(&lt;span class=&quot;name&quot;&gt;NSArray&lt;/span&gt; *nextMessages) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			NSLog(&lt;span class=&quot;name&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;Fetched all messages.&quot;&lt;/span&gt;)&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125; failure:^(&lt;span class=&quot;name&quot;&gt;NSError&lt;/span&gt; *error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			[&lt;span class=&quot;name&quot;&gt;self&lt;/span&gt; presentError:error]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125; failure:^(&lt;span class=&quot;name&quot;&gt;NSError&lt;/span&gt; *error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[&lt;span class=&quot;name&quot;&gt;self&lt;/span&gt; presentError:error]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; failure:^(&lt;span class=&quot;name&quot;&gt;NSError&lt;/span&gt; *error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;name&quot;&gt;self&lt;/span&gt; presentError:error]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在ReactiveCocoa中可以这样简单的实现：&lt;/p&gt;
&lt;figure class=&quot;highlight clojure&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[[[[client logIn]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	then:&lt;span class=&quot;comment&quot;&gt;^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		return [client loadCachedMessages];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	flattenMap:^(&lt;span class=&quot;name&quot;&gt;NSArray&lt;/span&gt; *messages) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		return [client fetchMessagesAfterMessage:messages.lastObject]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	subscribeError:^(&lt;span class=&quot;name&quot;&gt;NSError&lt;/span&gt; *error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[self presentError:error]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125; completed:&lt;span class=&quot;comment&quot;&gt;^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		NSLog(@&quot;Fetched all messages.&quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;并行独立工作&quot;&gt;&lt;a href=&quot;#并行独立工作&quot; class=&quot;headerlink&quot; title=&quot;并行独立工作&quot;&gt;&lt;/a&gt;并行独立工作&lt;/h3&gt;&lt;p&gt;与独立的数据集合并行工作，然后将它们合并成一个non-trivial函数到Cocoa，并经常涉及大量的同步：&lt;/p&gt;
&lt;figure class=&quot;highlight mipsasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;__block NSArray *databaseObjects&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__block NSArray *fileContents&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSOperationQueue *&lt;span class=&quot;keyword&quot;&gt;backgroundQueue &lt;/span&gt;= [[NSOperationQueue alloc] init]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSBlockOperation *databaseOperation = [NSBlockOperation &lt;span class=&quot;keyword&quot;&gt;blockOperationWithBlock:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;	databaseObjects = [databaseClient fetchObjectsMatchingPredicate:predicate]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSBlockOperation *filesOperation = [NSBlockOperation &lt;span class=&quot;keyword&quot;&gt;blockOperationWithBlock:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;	NSMutableArray *filesInProgress = [NSMutableArray array]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	for (NSString *path in files) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[filesInProgress &lt;span class=&quot;keyword&quot;&gt;addObject:[NSData &lt;/span&gt;dataWithContentsOfFile:path]]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fileContents = [filesInProgress copy]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NSBlockOperation *finishOperation = [NSBlockOperation &lt;span class=&quot;keyword&quot;&gt;blockOperationWithBlock:^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;	[self finishProcessingDatabaseObjects:databaseObjects fileContents:fileContents]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;Done processing&quot;&lt;/span&gt;)&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[finishOperation &lt;span class=&quot;keyword&quot;&gt;addDependency:databaseOperation];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;[finishOperation &lt;span class=&quot;keyword&quot;&gt;addDependency:filesOperation];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;[&lt;span class=&quot;keyword&quot;&gt;backgroundQueue &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;addOperation:databaseOperation];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;[&lt;span class=&quot;keyword&quot;&gt;backgroundQueue &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;addOperation:filesOperation];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;[&lt;span class=&quot;keyword&quot;&gt;backgroundQueue &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;addOperation:finishOperation];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面的代码可以用简单的合成信号来清理和优化：&lt;/p&gt;
&lt;figure class=&quot;highlight mipsasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;RACSignal *databaseSignal = [[databaseClient&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	fetchObjectsMatchingPredicate:&lt;/span&gt;predicate]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	subscribeOn:&lt;/span&gt;[RACScheduler &lt;span class=&quot;keyword&quot;&gt;scheduler]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;RACSignal *fileSignal = [RACSignal startEagerlyWithScheduler:[RACScheduler &lt;span class=&quot;keyword&quot;&gt;scheduler] &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;block:^(id&amp;lt;RACSubscriber&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;subscriber) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	NSMutableArray *filesInProgress = [NSMutableArray array]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	for (NSString *path in files) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[filesInProgress &lt;span class=&quot;keyword&quot;&gt;addObject:[NSData &lt;/span&gt;dataWithContentsOfFile:path]]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;subscriber &lt;/span&gt;sendNext:[filesInProgress copy]]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[&lt;span class=&quot;keyword&quot;&gt;subscriber &lt;/span&gt;sendCompleted]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[[RACSignal&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	combineLatest:&lt;/span&gt;@[ databaseSignal, fileSignal ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	reduce:&lt;/span&gt;^ id (NSArray *databaseObjects, NSArray *fileContents) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		[self finishProcessingDatabaseObjects:databaseObjects fileContents:fileContents]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		return nil&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;	subscribeCompleted:&lt;/span&gt;^&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;Done processing&quot;&lt;/span&gt;)&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;简化collection转换&quot;&gt;&lt;a href=&quot;#简化collection转换&quot; class=&quot;headerlink&quot; title=&quot;简化collection转换&quot;&gt;&lt;/a&gt;简化collection转换&lt;/h3&gt;&lt;p&gt;高阶函数比如 &lt;code&gt;map&lt;/code&gt;, &lt;code&gt;filter&lt;/code&gt;, &lt;code&gt;fold&lt;/code&gt;/&lt;code&gt;reduce&lt;/code&gt;在Foundation中是非常缺少的，导致循环中的代码像这样：&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSMutableArray&lt;/span&gt; *results = [&lt;span class=&quot;built_in&quot;&gt;NSMutableArray&lt;/span&gt; array];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *str &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; strings) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (str.length &amp;lt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *newString = [str stringByAppendingString:&lt;span class=&quot;string&quot;&gt;@&quot;foobar&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[results addObject:newString];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa/blob/v2.5/ReactiveCocoa/RACSequence.h&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RACSequence&lt;/a&gt;允许所有Cocoa collection在统一的和声明的方式下被操作：&lt;/p&gt;
&lt;figure class=&quot;highlight processing&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;RACSequence *results = [[strings.rac_sequence&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;filter&lt;/span&gt;:^ BOOL (NSString *&lt;span class=&quot;built_in&quot;&gt;str&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;str&lt;/span&gt;.length &amp;gt;= &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;map&lt;/span&gt;:^(NSString *&lt;span class=&quot;built_in&quot;&gt;str&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;built_in&quot;&gt;str&lt;/span&gt; stringByAppendingString:@&lt;span class=&quot;string&quot;&gt;&quot;foobar&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;以上文章摘译自ReactiveCocoa的Objective-C官方文档&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa/blob/v2.5/README.md#when-to-use-reactivecocoa&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa Documentation&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;以上内容介绍了RAC的基本用法，仅限于使用，所以墙裂建议仔细学习下节的&lt;strong&gt;参考链接&lt;/strong&gt;，了解RAC原理及高阶用法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/03/17/meet-ReactiveCocoa&quot;&gt;http://gonghonglou.com/2016/03/17/meet-ReactiveCocoa&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ReactiveCocoa的Objective-C官方文档&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa/blob/v2.5/README.md#when-to-use-reactivecocoa&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa Documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;雷纯锋的&lt;a href=&quot;http://blog.leichunfeng.com/blog/2015/12/25/reactivecocoa-v2-dot-5-yuan-ma-jie-xi-zhi-jia-gou-zong-lan/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa v2.5 源码解析之架构总览&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;吖了个峥的&lt;a href=&quot;http://www.jianshu.com/p/87ef6720a096&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;最快让你上手ReactiveCocoa之基础篇&lt;/a&gt; 和 &lt;a href=&quot;http://www.jianshu.com/p/e10e5ca413b7&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;最快让你上手ReactiveCocoa之进阶篇&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;李忠的&lt;a href=&quot;http://limboy.me/ios/2013/06/19/frp-reactivecocoa.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa与Functional Reactive Programming&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;唐巧的&lt;a href=&quot;http://devtang.com/2016/01/03/reactive-cocoa-discussion/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa 讨论会&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://github.com/ReactiveCocoa/ReactiveCocoa&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ReactiveCocoa&lt;/a&gt; 是一个Objective-C 框架，受 &lt;a href=&quot;ht
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS开发tips之日期与星期的对应</title>
    <link href="http://gonghonglou.com/2016/03/03/date-week/"/>
    <id>http://gonghonglou.com/2016/03/03/date-week/</id>
    <published>2016-03-03T03:47:11.000Z</published>
    <updated>2017-07-24T04:16:50.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;前段时间练手模拟校园app写了个Demo，其中在写课程表的界面时，加上了当前日期，为了让日期与星期对应也是前后折腾了好几次，主要还是对日期的情况思考的不够全面吧（比如判断每月天数和月初月末的交替），不过最终还是完成需求。最后意外发现简便方法，写下来分享。    &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对校园app的Demo有兴趣的话，请移驾GitHub:  &lt;a href=&quot;https://github.com/gonghonglou/QLU-BlogDemo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;QLU-BlogDemo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;首先看一下模样吧（如图中红框所示）&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/dateandweek/dateweek.png&quot; alt=&quot;课程表&quot;&gt;&lt;br&gt;最基本的：获取当前日期的方法&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取当前时间&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSDate&lt;/span&gt; *senddate = [&lt;span class=&quot;built_in&quot;&gt;NSDate&lt;/span&gt; date];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSDateFormatter&lt;/span&gt; *dateformatter = [[&lt;span class=&quot;built_in&quot;&gt;NSDateFormatter&lt;/span&gt; alloc] init];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dateformatter setDateFormat:&lt;span class=&quot;string&quot;&gt;@&quot;yyy&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *yearString = [dateformatter stringFromDate:senddate];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dateformatter setDateFormat:&lt;span class=&quot;string&quot;&gt;@&quot;MM&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *monthString = [dateformatter stringFromDate:senddate];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dateformatter setDateFormat:&lt;span class=&quot;string&quot;&gt;@&quot;dd&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *dayString = [dateformatter stringFromDate:senddate];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dateformatter setDateFormat:&lt;span class=&quot;string&quot;&gt;@&quot;EEE&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *weekString = [dateformatter stringFromDate:senddate];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;-%@&quot;&lt;/span&gt;,weekString);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; year = [yearString intValue];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;-%d&quot;&lt;/span&gt;, year);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; month = [monthString intValue];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;--%d&quot;&lt;/span&gt;, month);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; day = [dayString intValue];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSLog&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;@&quot;---%d&quot;&lt;/span&gt;, day);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看打印结果：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/dateandweek/985173.png&quot; alt=&quot;打印结果&quot;&gt;&lt;br&gt;然后就是把获取到的日期放到对应星期上去了,需要格外注意的要判断的几点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;不同月的天数&lt;/li&gt;
&lt;li&gt;月底时，显示下个月月初的日期&lt;/li&gt;
&lt;li&gt;月初时，显示上个月月底的日期&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先获取不同月的天数,并抽离成类方法方便后边调用&lt;/p&gt;
&lt;figure class=&quot;highlight rust&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 获取某年某月总共多少天     &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)getDaysInMonth:(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)year month:(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)imonth &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// imonth == 0的情况是应对在CourseViewController里month-1的情况&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;((imonth == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;((imonth == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(imonth == &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;((year%&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(year%&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;span class=&quot;params&quot;&gt;||&lt;/span&gt;(year%&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(year%&lt;span class=&quot;number&quot;&gt;400&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(year%&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;放置label的方法，在label上写下日期&lt;/p&gt;
&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 添加日期&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- (&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt;)&lt;span class=&quot;string&quot;&gt;setDateLabel:&lt;/span&gt;(CGRect)rect &lt;span class=&quot;string&quot;&gt;number:&lt;/span&gt;(NSString *)number&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	UILabel *label = [[UILabel alloc] &lt;span class=&quot;string&quot;&gt;initWithFrame:&lt;/span&gt;rect];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	label.textColor = [UIColor &lt;span class=&quot;string&quot;&gt;colorWithRed:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/255 green:	73.0/&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;blue:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;250.0&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;alpha:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	label.textAlignment = NSTextAlignmentCenter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	label.text = number;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	label.font = [UIFont &lt;span class=&quot;string&quot;&gt;systemFontOfSize:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[self.view &lt;span class=&quot;string&quot;&gt;addSubview:&lt;/span&gt;label];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;开始判断。拿到周一是几号后面的日数递增就OK了，注意月末月初交替的特殊情况（看机智如我，走起)&lt;/p&gt;
&lt;figure class=&quot;highlight processing&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 判断当前天是周几，从而计算出当周的周一是几号（负数表示上个月月末）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString  isEqual: @&lt;span class=&quot;string&quot;&gt;&quot;周一&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 因为下面有 day++;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString isEqual:@&lt;span class=&quot;string&quot;&gt;&quot;周二&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString isEqual:@&lt;span class=&quot;string&quot;&gt;&quot;周三&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString isEqual:@&lt;span class=&quot;string&quot;&gt;&quot;周四&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString isEqual:@&lt;span class=&quot;string&quot;&gt;&quot;周五&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString isEqual:@&lt;span class=&quot;string&quot;&gt;&quot;周六&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString isEqual:@&lt;span class=&quot;string&quot;&gt;&quot;周日&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;&amp;lt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 月初时显示上个月月末的日期&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 上个月末往后的月初数字&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; days = [GetDays getDaysInMonth:&lt;span class=&quot;built_in&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;month&lt;/span&gt;:&lt;span class=&quot;built_in&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; &amp;gt; days) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 月初之前的月末数字&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = days; &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = days&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = days&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-3&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = days&lt;span class=&quot;number&quot;&gt;-3&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-4&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = days&lt;span class=&quot;number&quot;&gt;-4&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-5&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = days&lt;span class=&quot;number&quot;&gt;-5&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [self setDateLabel:CGRectMake(i*((self.view.frame.&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-33.5&lt;/span&gt;)/&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;+&lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;)+&lt;span class=&quot;number&quot;&gt;30.5&lt;/span&gt;, kTopY, (self.view.frame.&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-33.5&lt;/span&gt;)/&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;) number:[NSString stringWithFormat:@&lt;span class=&quot;string&quot;&gt;&quot;%d&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 月末&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; days = [GetDays getDaysInMonth:&lt;span class=&quot;built_in&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;month&lt;/span&gt;:&lt;span class=&quot;built_in&quot;&gt;month&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; &amp;gt; days) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [self setDateLabel:CGRectMake(i*((self.view.frame.&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-33.5&lt;/span&gt;)/&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;+&lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;)+&lt;span class=&quot;number&quot;&gt;30.5&lt;/span&gt;, kTopY, (self.view.frame.&lt;span class=&quot;built_in&quot;&gt;size&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-33.5&lt;/span&gt;)/&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;) number:[NSString stringWithFormat:@&lt;span class=&quot;string&quot;&gt;&quot;%d&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;day&lt;/span&gt;]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;劳心劳力，大功告成。接下来小L要告诉大家，上边的判断看看就好了（哭吧）我们还有so so so easy的方法（嘿）&lt;/p&gt;
&lt;p&gt;方法推荐：获取几年几月几日后的日期,并抽离成类方法方便后边调用&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  *  获取几年几月几日后的日期，0表示当天，负数表示之前&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  *  这里只要取到日就好了，年月置0，表示当年当月&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+ (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)getOneDay:(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)day &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; year = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, month = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSCalendar&lt;/span&gt; *calendar = [[&lt;span class=&quot;built_in&quot;&gt;NSCalendar&lt;/span&gt; alloc] initWithCalendarIdentifier:&lt;span class=&quot;built_in&quot;&gt;NSCalendarIdentifierGregorian&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSDateComponents&lt;/span&gt; *comps = &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    comps = [calendar components:&lt;span class=&quot;built_in&quot;&gt;NSCalendarUnitYear&lt;/span&gt;|&lt;span class=&quot;built_in&quot;&gt;NSCalendarUnitMonth&lt;/span&gt;|&lt;span class=&quot;built_in&quot;&gt;NSCalendarUnitDay&lt;/span&gt; fromDate:[&lt;span class=&quot;built_in&quot;&gt;NSDate&lt;/span&gt; date]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSDateComponents&lt;/span&gt; *adcomps = [[&lt;span class=&quot;built_in&quot;&gt;NSDateComponents&lt;/span&gt; alloc] init];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [adcomps setYear:year];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [adcomps setMonth:month];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [adcomps setDay:day];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSDate&lt;/span&gt; *newdate = [calendar dateByAddingComponents:adcomps toDate:[&lt;span class=&quot;built_in&quot;&gt;NSDate&lt;/span&gt; date] options:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSDateFormatter&lt;/span&gt;  *formatter = [[&lt;span class=&quot;built_in&quot;&gt;NSDateFormatter&lt;/span&gt; alloc] init];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [formatter setDateFormat:&lt;span class=&quot;string&quot;&gt;@&quot;dd&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; *  dayString = [formatter stringFromDate:newdate];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [dayString intValue];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重点来了：&lt;/p&gt;
&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 判断当前天是周几，从而计算出当周的周一是几号（负数表示上个月月末）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString  &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt; @&lt;span class=&quot;string&quot;&gt;&quot;周一&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 因为下面有 day++;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;周二&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;周三&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;周四&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;-3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;周五&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;-4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;周六&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;-5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ([weekString &lt;span class=&quot;string&quot;&gt;isEqual:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;周日&quot;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    day = &lt;span class=&quot;number&quot;&gt;-6&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 放置日期&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	[self &lt;span class=&quot;string&quot;&gt;setDateLabel:&lt;/span&gt;CGRectMake(i*((self.view.frame.size.width&lt;span class=&quot;number&quot;&gt;-33.5&lt;/span&gt;)&lt;span class=&quot;regexp&quot;&gt;/7+0.5)+30.5, kTopY, (self.view.frame.size.width-33.5)/&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;) &lt;span class=&quot;string&quot;&gt;number:&lt;/span&gt;[NSString &lt;span class=&quot;string&quot;&gt;stringWithFormat:&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&quot;%d&quot;&lt;/span&gt;, [GetOneDay &lt;span class=&quot;string&quot;&gt;getOneDay:&lt;/span&gt;day++]]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如此才是万事大吉！&lt;br&gt;比上边的判断简单了许多，不过上边的判断也是一种思路，所以记录下来，给大家一个借鉴！&lt;/p&gt;
&lt;h2 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h2&gt;&lt;p&gt;小白出手，请多指教。如言有误，还望斧正！&lt;/p&gt;
&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/03/03/date-week&quot;&gt;http://gonghonglou.com/2016/03/03/date-week&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;迁移文章 首发于2015-10-13&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;前段时间练手模拟校园app写了个Demo，其中在写课程表的界面时，加上了当前日期，为了让日期与星期对应也是前后折腾了好几次，主要还是对日期的
    
    </summary>
    
      <category term="iOS" scheme="http://gonghonglou.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>由丢失一部iPhone6引发的祸端</title>
    <link href="http://gonghonglou.com/2016/03/03/protect-apple-id/"/>
    <id>http://gonghonglou.com/2016/03/03/protect-apple-id/</id>
    <published>2016-03-03T03:36:26.000Z</published>
    <updated>2017-07-24T04:17:19.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言：&quot;&gt;&lt;a href=&quot;#前言：&quot; class=&quot;headerlink&quot; title=&quot;前言：&quot;&gt;&lt;/a&gt;前言：&lt;/h2&gt;&lt;p&gt;刚从售后拿到Mac 回学校的公交车上。记录下这悲惨的经历告诫各位果友&lt;br&gt;篇幅略长，怕有些读者看不下去遂将告诫先写在前面：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;为保护手机，在iPhone设置–iCloud里有查找我的iPhone功能，确保开启（默认开启）万一不幸手机丢失，尽快登录iCloud官网或在查找我的iPhone app里将iPhone设为丢失模式或锁定iPhone，为保护隐私可选抹掉iPhone（会删除iPhone里的所有数据，不可逆） Mac和iPad一样如此&lt;/li&gt;
&lt;li&gt;手机在丢失模式下，锁屏界面会显示你设置的一个联系号码。若是好心人送还手机自然大喜。但也要提防钓鱼网站，伪造Apple身份给你发短信或邮件，骗取iCloud密码（lz已上当羞耻哭晕在厕所）&lt;/li&gt;
&lt;li&gt;万一不幸iCloud密码泄漏，请及时修改Apple ID的验证问题和Apple ID的密码。切勿以为只改密码万事大吉，盗取你的密码就能获取你的验证问题的答案，有了验证问题答案就能查看你更改的密码（怕）并且可以远程操作（锁定、抹掉…）你的设备（lz已受害二次哭晕在厕所）&lt;/li&gt;
&lt;li&gt;为防万一，建议在iCloud的管理我的Apple ID里开启两步验证，此后要操作远程命令就需要短信验证码再加上密码或验证问题。（开启两步验证会给你一份字母加数字的密钥，很重要，是你丢失密码或手机卡后的唯一凭证，切记保存好）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;那么故事是这样的：&quot;&gt;&lt;a href=&quot;#那么故事是这样的：&quot; class=&quot;headerlink&quot; title=&quot;那么故事是这样的：&quot;&gt;&lt;/a&gt;那么故事是这样的：&lt;/h3&gt;&lt;h4 id=&quot;事情发生在15年10月8号，却并非起始于这个日期。&quot;&gt;&lt;a href=&quot;#事情发生在15年10月8号，却并非起始于这个日期。&quot; class=&quot;headerlink&quot; title=&quot;事情发生在15年10月8号，却并非起始于这个日期。&quot;&gt;&lt;/a&gt;事情发生在15年10月8号，却并非起始于这个日期。&lt;/h4&gt;&lt;p&gt;8号上午如往常一样打开Mac准备码字，联网之后弹出一个提示iCloud什么的对话框，点了确定Mac就重启了，重启之后竟出现这样的界面：&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/protectappleid/open.JPG&quot; alt=&quot;PIN码&quot;&gt;&lt;br&gt;这是什么鬼？刚开始四个方框上提示：输入锁定此系统的PIN码来解锁。what？PIN码？我没有啊，崩溃！百度一些提示说按住option键重新开机。然后出现了一个锁头（这就是固件锁）&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/protectappleid/sock.png&quot; alt=&quot;固件锁&quot;&gt;&lt;br&gt;并没有什么卵用，遂拨打4006-272273（苹果技术支持热线）寻助AppleCare，一系列问答之后大概明白了应该是iCloud密码泄漏，Mac被远程恶意锁定。客服询问我的Apple ID是和别人共用还是怎样泄漏过，才回想起7月份失窃一部iPhone6（新机、心痛）&lt;/p&gt;
&lt;h4 id=&quot;这就是故事的起点：&quot;&gt;&lt;a href=&quot;#这就是故事的起点：&quot; class=&quot;headerlink&quot; title=&quot;这就是故事的起点：&quot;&gt;&lt;/a&gt;这就是故事的起点：&lt;/h4&gt;&lt;p&gt;失窃iPhone后随即登录iCloud将iPhone6设为丢失模式（这时可留下一个联系方式显示在手机解锁屏幕上）几天后收到一条短信（来自香港号码）以苹果的身份，大体意思说&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;您的iPhone在苹果售后申请换机，因凭证信息不符被Apple售后截下，若情况符实请登录&lt;br&gt;    iCloud网站（一段网址）申请扣机，确认信息后Apple会联系警察交还手机。。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;一开始没注意是因为对于找回手机已经不抱希望了（尽管我还没有锁定iPhone，汗）后来看到可申请扣机（其实一开始是短信太长没看懂，笑）因为失窃后已报警，又看到希望的我内心是鸡冻的。然后就上网登录”iCoud.com”(和平常登录时的iCloud界面一个模样)熟练输入帐号密码，登录之后找半天并没有找回iPhone啊，遂电话Apple客服&lt;br&gt;被惨痛告知：这是钓鱼网站骗取Apple ID密码的常见手法。赶紧到iCloud官网查看我的设备，已不见iPhone6的踪影（哭）这里要说客服态度很好，在我传达了收到的短信后，他们首先关注的是我是否已输入了登录密码。&lt;/p&gt;
&lt;p&gt;如此看来便是那时候泄漏的iCloud密码了。之后一直没有改密码（汗）而可恶的盗窃者在盗取我的iCloud密码后竟默默蛰伏至今&lt;br&gt;我在6号晚12点左右因为6s的某原因在手机上修改了iCloud密码，在Mac被锁后发现一份iCloud邮件提示我的Mac在7号下午八点多的时候被锁定。以此推断应该是我改密码的行为触动了盗窃者所以远程锁定了我的Mac，之前我以为改密码在Mac被锁之前账号应该是安全的，后来才知并非如此（如前言所述）&lt;br&gt;前后打了四五次400，有一次为查看Apple ID的动态要转接Apple的最高级别安全部门，转接等待一个半小时没接通（汗）不过客服们的态度都特别热情，这点很欣慰！只是她们貌似对PIN码什么的也说不太清，大概认定为被人远程恶意锁定了。&lt;/p&gt;
&lt;h4 id=&quot;解决方案：&quot;&gt;&lt;a href=&quot;#解决方案：&quot; class=&quot;headerlink&quot; title=&quot;解决方案：&quot;&gt;&lt;/a&gt;解决方案：&lt;/h4&gt;&lt;p&gt;到售后解锁，赶到市里，售后态度也很好，只是他们也说不清楚PIN码什么的，今天取Mac时一位技术大哥总算给讲明白怎么回事，解释如下：&lt;br&gt;1）在查找我的iPhone里锁定我的iPhone或iPad可通过密码解锁，若忘记密码可向苹果申请解锁（需要设备的购买凭证，必须要且有效）&lt;br&gt;2）但是，锁定Mac时会输入一个密码，这个密码就是上面提到的PIN码&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;输入PIN码可以进入系统但是不能进行更改硬盘操作&lt;/li&gt;
&lt;li&gt;若是忘记PIN码或者是被恶意锁定的，按组合键&lt;a href=&quot;https://support.apple.com/zh-cn/HT204063&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Command+Option+P+R&lt;/a&gt;可以清空PIN码然后进入系统但仍然不能进行更改硬盘操作。&lt;/li&gt;
&lt;li&gt;开机时按住option键进入磁盘分区时就会出现固件锁，在这里输入PIN码也可以进入系统仍然不能进行更改硬盘操作。&lt;br&gt;怎样才能解开固件锁，只有去售后了，他们向Apple提供固件锁的信息，Apple做一个解密包发回来解锁，济南售后花费300大洋，倒是不贵可是心痛（哭）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;为保安全，你也可以为你的Mac加上固件锁，自行百度（甚用，忘了心情就不好了。。。）&lt;/p&gt;
&lt;p&gt;最后不幸中的万幸是，盗窃者或许先点的锁定Mac这一不可逆的过程导致抹掉Mac不可用，又或者其他的网络连接什么的原因总之我的硬盘资料没有被抹。技术大哥说之前解掉的几个固件锁打开后数据都是被抹掉的，连系统都没了（庆幸）&lt;br&gt;发现资料还在时心情是无法用语言表达的，就用微博上一帅哥的表情来表达吧&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/protectappleid/haha.png&quot; alt=&quot;屏幕快照 2015-10-10 17.39.16.png&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;再次告诫广大果友：&quot;&gt;&lt;a href=&quot;#再次告诫广大果友：&quot; class=&quot;headerlink&quot; title=&quot;再次告诫广大果友：&quot;&gt;&lt;/a&gt;再次告诫广大果友：&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;在保护好自己apple设备的同时更要保护好自己的Apple ID密码，最好开启两步验证。&lt;/li&gt;
&lt;li&gt;对于重要文件及时做好备份，Apple的锁做的很强大，极好的保护了我们的设备和数据，可是一旦泄露iCloud密码伤害也会很致命&lt;/li&gt;
&lt;li&gt;对于备份，Mac上有Time Machine备份工具甚是好用，听起来（嘿）&lt;br&gt;也是售后的技术大哥告知的，感谢AppleCare和Apple售后的好态度。&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/protectappleid/save.png&quot; alt=&quot;屏幕快照 2015-10-10 18.41.11.png&quot;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h2&gt;&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/03/03/protect-apple-id&quot;&gt;http://gonghonglou.com/2016/03/03/protect-apple-id&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;迁移文章 首发于2015-10-10 &lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言：&quot;&gt;&lt;a href=&quot;#前言：&quot; class=&quot;headerlink&quot; title=&quot;前言：&quot;&gt;&lt;/a&gt;前言：&lt;/h2&gt;&lt;p&gt;刚从售后拿到Mac 回学校的公交车上。记录下这悲惨的经历告诫各位果友&lt;br&gt;篇幅略长，怕有些读者看不下去遂将告诫先写在前面：&lt;/p&gt;
    
    </summary>
    
      <category term="Life" scheme="http://gonghonglou.com/categories/Life/"/>
    
    
  </entry>
  
  <entry>
    <title>Mac上搭建基于GitHub的Hexo博客</title>
    <link href="http://gonghonglou.com/2016/02/03/firstblog/"/>
    <id>http://gonghonglou.com/2016/02/03/firstblog/</id>
    <published>2016-02-03T06:50:14.000Z</published>
    <updated>2017-07-13T02:56:24.000Z</updated>
    
    <content type="html">&lt;p&gt;这是一篇详细文章来讲述用Mac搭建Hexo博客于Github上的完整历程， 也是踩了无数的坑搭起来的，现在写下些经验来分享，希望能帮大家少踩些坑。&lt;/p&gt;
&lt;p&gt;曾买过一款阿里的云虚拟主机，后来才发现不能自己装软件只能上传网站程序，除非另买&lt;a href=&quot;https://www.aliyun.com/easybuy&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ECS&lt;/a&gt;，对于第一个月的实习工资还没拿到手的我想想还是算了，先用Wordpress搭起来玩玩吧。然而在上传网站程序中几次失败，本就觉得没劲，遂一怒转向Github。好了，废话少说，开始吧。&lt;/p&gt;
&lt;h2 id=&quot;环境配置&quot;&gt;&lt;a href=&quot;#环境配置&quot; class=&quot;headerlink&quot; title=&quot;环境配置&quot;&gt;&lt;/a&gt;环境配置&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://hexo.io/docs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo官网&lt;/a&gt;上本就有对Hexo安装及使用的详细介绍，墙裂推荐。这里来讲述自己安装的亲身步骤，或有区别。&lt;/p&gt;
&lt;h3 id=&quot;1-Node-js&quot;&gt;&lt;a href=&quot;#1-Node-js&quot; class=&quot;headerlink&quot; title=&quot;1.Node.js&quot;&gt;&lt;/a&gt;1.Node.js&lt;/h3&gt;&lt;p&gt;用来生成静态页面。移步&lt;a href=&quot;https://nodejs.org/en/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Node.js官网&lt;/a&gt;，下载v5.5.0 Stable 一路安装即可。&lt;/p&gt;
&lt;h3 id=&quot;2-Git&quot;&gt;&lt;a href=&quot;#2-Git&quot; class=&quot;headerlink&quot; title=&quot;2.Git&quot;&gt;&lt;/a&gt;2.Git&lt;/h3&gt;&lt;p&gt;用来将本地Hexo内容提交到Github上。Xcode自带Git，这里不再赘述。如果没有Xcode可以参考&lt;a href=&quot;https://hexo.io/docs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo官网&lt;/a&gt;上的安装方法。    &lt;/p&gt;
&lt;h2 id=&quot;安装Hexo&quot;&gt;&lt;a href=&quot;#安装Hexo&quot; class=&quot;headerlink&quot; title=&quot;安装Hexo&quot;&gt;&lt;/a&gt;安装Hexo&lt;/h2&gt;&lt;p&gt;当Node.js和Git都安装好后就可以正式安装Hexo了，终端执行如下命令：&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; -g hexo&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;输入管理员密码（Mac登录密码）即开始安装 (&lt;code&gt;sudo&lt;/code&gt;:linux系统管理指令  &lt;code&gt;-g&lt;/code&gt;:全局安装)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意坑一：&lt;a href=&quot;https://hexo.io/docs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo官网&lt;/a&gt;上的安装命令是&lt;code&gt;$ npm install -g hexo-cli&lt;/code&gt;，安装时不要忘记前面加上&lt;code&gt;sudo&lt;/code&gt;，否则会因为权限问题报错。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;初始化&quot;&gt;&lt;a href=&quot;#初始化&quot; class=&quot;headerlink&quot; title=&quot;初始化&quot;&gt;&lt;/a&gt;初始化&lt;/h3&gt;&lt;p&gt;终端cd到一个你选定的目录，执行&lt;code&gt;hexo init&lt;/code&gt;命令：&lt;/p&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;hexo init blog&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;blog&lt;/code&gt;是你建立的文件夹名称。cd到&lt;code&gt;blog&lt;/code&gt;文件夹下，执行如下命令，安装npm：&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;执行如下命令，开启hexo服务器：&lt;br&gt;&lt;figure class=&quot;highlight cos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo &lt;span class=&quot;keyword&quot;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;此时，浏览器中打开网址&lt;a href=&quot;http://0.0.0.0:4000&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost:4000&lt;/a&gt;，能看到如下页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/firstblog/hexo4000.png&quot; alt=&quot;http://localhost:4000&quot;&gt;&lt;/p&gt;
&lt;p&gt;本地设置好后，接下来开始关联Github。&lt;/p&gt;
&lt;h2 id=&quot;关联Github&quot;&gt;&lt;a href=&quot;#关联Github&quot; class=&quot;headerlink&quot; title=&quot;关联Github&quot;&gt;&lt;/a&gt;关联Github&lt;/h2&gt;&lt;h3 id=&quot;1-创建仓库&quot;&gt;&lt;a href=&quot;#1-创建仓库&quot; class=&quot;headerlink&quot; title=&quot;1.创建仓库&quot;&gt;&lt;/a&gt;1.创建仓库&lt;/h3&gt;&lt;p&gt;登录你的Github帐号，新建仓库，名为&lt;code&gt;用户名.github.io&lt;/code&gt;固定写法，如&lt;code&gt;gonghonglou.github.io&lt;/code&gt;即下图中&lt;code&gt;1&lt;/code&gt;所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/firstblog/githubName.png&quot; alt=&quot;](http://localhost:4000&quot;&gt;&lt;/p&gt;
&lt;p&gt;本地的&lt;code&gt;blog&lt;/code&gt;文件夹下内容为：&lt;br&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;_config&lt;span class=&quot;selector-class&quot;&gt;.yml&lt;/span&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db&lt;span class=&quot;selector-class&quot;&gt;.json&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;node_modules &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;package&lt;span class=&quot;selector-class&quot;&gt;.json&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;scaffolds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;source&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;themes&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;终端cd到&lt;code&gt;blog&lt;/code&gt;文件夹下，&lt;code&gt;vim&lt;/code&gt;打开&lt;code&gt;_config.yml&lt;/code&gt;，命令如下：&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;vim _config.yml&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;打开后往下滑到最后，修改成下边的样子：&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;deploy&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;: git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;repository&lt;/span&gt;: &lt;span class=&quot;attribute&quot;&gt;https&lt;/span&gt;:&lt;span class=&quot;comment&quot;&gt;//github.com/gonghonglou/gonghonglou.github.io.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;branch&lt;/span&gt;: master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;你需要将&lt;code&gt;repository&lt;/code&gt;后&lt;code&gt;gonghonglou&lt;/code&gt;换成你自己的用户名，地址在上图&lt;code&gt;2&lt;/code&gt;位置获取。hexo 3.1.1版本后&lt;code&gt;type:&lt;/code&gt;值为&lt;code&gt;git&lt;/code&gt;。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意坑二：在配置所有的&lt;code&gt;_config.yml&lt;/code&gt;文件时（包括theme中的），在所有的冒号&lt;code&gt;:&lt;/code&gt;后边都要加一个空格，否则执行hexo命令会报错，切记 切记&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在&lt;code&gt;blog&lt;/code&gt;文件夹目录下执行生成静态页面命令：&lt;br&gt;&lt;figure class=&quot;highlight verilog&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo &lt;span class=&quot;keyword&quot;&gt;generate&lt;/span&gt;		或者：hexo g&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;pre&gt;此时若出现如下报错：
ERROR Local hexo not found in ~/blog
ERROR Try runing: &#39;npm install hexo --save&#39;

则执行命令：
npm install hexo --save

若无报错，自行忽略此步骤。&lt;/pre&gt;

&lt;p&gt;再执行配置命令：&lt;br&gt;&lt;figure class=&quot;highlight cos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo deploy			或者：hexo &lt;span class=&quot;keyword&quot;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意坑三：若执行命令&lt;code&gt;hexo deploy&lt;/code&gt;仍然报错：无法连接git或找不到git，则执行如下命令来安装&lt;a href=&quot;https://github.com/hexojs/hexo-deployer-git&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;hexo-deployer-git&lt;/a&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ npm install hexo-deployer-git --save        
&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;再次执行&lt;code&gt;hexo generate&lt;/code&gt;和&lt;code&gt;hexo deploy&lt;/code&gt;命令。&lt;/p&gt;
&lt;p&gt;若你未关联Github，则执行&lt;code&gt;hexo deploy&lt;/code&gt;命令时终端会提示你输入Github的用户名和密码，即&lt;br&gt;&lt;figure class=&quot;highlight rust&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Username &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;&#39;https&lt;/span&gt;:&lt;span class=&quot;comment&quot;&gt;//github.com&#39;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Password &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;&#39;https&lt;/span&gt;:&lt;span class=&quot;comment&quot;&gt;//github.com&#39;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;hexo deploy&lt;/code&gt;命令执行成功后，浏览器中打开网址&lt;a href=&quot;http://gonghonglou.github.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://gonghonglou.github.io&lt;/a&gt;（将&lt;code&gt;gonghonglou&lt;/code&gt;换成你的用户名）能看到和打开&lt;code&gt;http://localhost:4000&lt;/code&gt;时一样的页面。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;为避免每次输入Github用户名和密码的麻烦，可参照第二节方法&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;2-添加ssh-key到Github&quot;&gt;&lt;a href=&quot;#2-添加ssh-key到Github&quot; class=&quot;headerlink&quot; title=&quot;2.添加ssh key到Github&quot;&gt;&lt;/a&gt;2.添加ssh key到Github&lt;/h3&gt;&lt;h4 id=&quot;1-1-检查SSH-keys是否存在Github&quot;&gt;&lt;a href=&quot;#1-1-检查SSH-keys是否存在Github&quot; class=&quot;headerlink&quot; title=&quot;1.1.检查SSH keys是否存在Github&quot;&gt;&lt;/a&gt;1.1.检查SSH keys是否存在Github&lt;/h4&gt;&lt;p&gt;执行如下命令，检查SSH keys是否存在。如果有文件&lt;code&gt;id_rsa.pub&lt;/code&gt;或&lt;code&gt;id_dsa.pub&lt;/code&gt;，则直接进入步骤1.3将SSH key添加到Github中，否则进入下一步生成SSH key。&lt;br&gt;&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;keyword&quot;&gt;ls&lt;/span&gt; -&lt;span class=&quot;keyword&quot;&gt;al&lt;/span&gt; ~/.ssh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;1-2-生成新的ssh-key&quot;&gt;&lt;a href=&quot;#1-2-生成新的ssh-key&quot; class=&quot;headerlink&quot; title=&quot;1.2.生成新的ssh key&quot;&gt;&lt;/a&gt;1.2.生成新的ssh key&lt;/h4&gt;&lt;p&gt;执行如下命令生成public/private rsa key pair，注意将&lt;code&gt;your_email@example.com&lt;/code&gt;换成你自己注册Github的邮箱地址。&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;ssh-keygen -t rsa -C &lt;span class=&quot;string&quot;&gt;&quot;your_email@example.com&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;默认会在相应路径下（&lt;code&gt;~/.ssh/id_rsa.pub&lt;/code&gt;）生成&lt;code&gt;id_rsa&lt;/code&gt;和&lt;code&gt;id_rsa.pub&lt;/code&gt;两个文件。&lt;/p&gt;
&lt;h4 id=&quot;1-3-将ssh-key添加到Github中&quot;&gt;&lt;a href=&quot;#1-3-将ssh-key添加到Github中&quot; class=&quot;headerlink&quot; title=&quot;1.3.将ssh key添加到Github中&quot;&gt;&lt;/a&gt;1.3.将ssh key添加到Github中&lt;/h4&gt;&lt;p&gt;Find前往文件夹&lt;code&gt;~/.ssh/id_rsa.pub&lt;/code&gt;打开id_rsa.pub文件，里面的信息即为SSH key，将这些信息复制到Github的Add SSH key页面即可。&lt;/p&gt;
&lt;p&gt;进入Github –&amp;gt; Settings –&amp;gt; SSH keys –&amp;gt; add SSH key:&lt;/p&gt;
&lt;p&gt;Title里任意添一个标题，将复制的内容粘贴到Key里，点击下方&lt;code&gt;Add key&lt;/code&gt;绿色按钮即可。&lt;/p&gt;
&lt;h3 id=&quot;3-发布文章&quot;&gt;&lt;a href=&quot;#3-发布文章&quot; class=&quot;headerlink&quot; title=&quot;3.发布文章&quot;&gt;&lt;/a&gt;3.发布文章&lt;/h3&gt;&lt;p&gt;终端cd到&lt;code&gt;blog&lt;/code&gt;文件夹下，执行如下命令新建文章：&lt;br&gt;&lt;figure class=&quot;highlight actionscript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;postName&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;名为&lt;code&gt;postName.md&lt;/code&gt;的文件会建在目录&lt;code&gt;/blog/source/_posts&lt;/code&gt;下，&lt;code&gt;postName&lt;/code&gt;是文件名，为方便链接不建议掺杂汉字。你当然可以用vim来编辑文章。我在用Mou编辑器，支持预览，虽然其预览主题并非我喜欢，如果你有好用的markdown编辑器请推荐给我，感激不尽！&lt;/p&gt;
&lt;p&gt;文章编辑完成后，终端cd到&lt;code&gt;blog&lt;/code&gt;文件夹下，执行如下命令来发布：&lt;br&gt;&lt;figure class=&quot;highlight verilog&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;hexo &lt;span class=&quot;keyword&quot;&gt;generate&lt;/span&gt;			&lt;span class=&quot;comment&quot;&gt;//生成静态页面&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hexo deploy			&lt;span class=&quot;comment&quot;&gt;//将文章部署到Github&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;至此，Mac上搭建基于Github的Hexo博客就完成了。下面的内容是介绍安装theme和绑定个人域名，如果有兴趣且还有耐心的话，请继续吧。&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;安装theme&quot;&gt;&lt;a href=&quot;#安装theme&quot; class=&quot;headerlink&quot; title=&quot;安装theme&quot;&gt;&lt;/a&gt;安装theme&lt;/h2&gt;&lt;p&gt;你可以到&lt;a href=&quot;https://hexo.io/themes/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo官网主题页&lt;/a&gt;去搜寻自己喜欢的theme。这里以&lt;a href=&quot;https://github.com/iissnan/hexo-theme-next&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;hexo-theme-next&lt;/a&gt;为例&lt;/p&gt;
&lt;p&gt;终端cd到 &lt;code&gt;blog&lt;/code&gt; 目录下执行如下命令：&lt;br&gt;&lt;figure class=&quot;highlight vim&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ git clone http&lt;span class=&quot;variable&quot;&gt;s:&lt;/span&gt;//github.&lt;span class=&quot;keyword&quot;&gt;com&lt;/span&gt;/iissnan/hexo-theme-&lt;span class=&quot;keyword&quot;&gt;next&lt;/span&gt; themes/&lt;span class=&quot;keyword&quot;&gt;next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;将&lt;code&gt;blog&lt;/code&gt;目录下&lt;code&gt;_config.yml&lt;/code&gt;里&lt;code&gt;theme&lt;/code&gt;的名称&lt;code&gt;landscape&lt;/code&gt;修改为&lt;code&gt;next&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;终端cd到&lt;code&gt;blog&lt;/code&gt;目录下执行如下命令(每次部署文章的步骤)：&lt;br&gt;&lt;figure class=&quot;highlight gams&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; hexo clean		&lt;span class=&quot;comment&quot;&gt;//清除缓存文件 (db.json) 和已生成的静态文件 (public)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; hexo g		&lt;span class=&quot;comment&quot;&gt;//生成缓存和静态文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;$&lt;/span&gt; hexo d		&lt;span class=&quot;comment&quot;&gt;//重新部署到服务器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;至于更改theme内容比如名称、描述、头像等去修改&lt;code&gt;blog/_config.yml&lt;/code&gt;文件和&lt;code&gt;blog/themes/next/_config.yml&lt;/code&gt;文件中对应的属性名称即可， 不要忘记冒号&lt;code&gt;:&lt;/code&gt;后加空格。  &lt;a href=&quot;http://theme-next.iissnan.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt; NexT 使用文档&lt;/a&gt;里有极详细的介绍。&lt;/p&gt;
&lt;h2 id=&quot;绑定个人域名&quot;&gt;&lt;a href=&quot;#绑定个人域名&quot; class=&quot;headerlink&quot; title=&quot;绑定个人域名&quot;&gt;&lt;/a&gt;绑定个人域名&lt;/h2&gt;&lt;p&gt;现在使用的域名是Github提供的二级域名，也可以绑定为自己的个性域名。购买域名，可以到&lt;a href=&quot;https://sg.godaddy.com/zh/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GoDaddy官网&lt;/a&gt;，网友亲切称呼为：狗爹，也可以到&lt;a href=&quot;http://wanwang.aliyun.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;阿里万网&lt;/a&gt;购买。我是在万网买的，可直接在其网站做域名解析。&lt;/p&gt;
&lt;h3 id=&quot;1-Github端&quot;&gt;&lt;a href=&quot;#1-Github端&quot; class=&quot;headerlink&quot; title=&quot;1.Github端&quot;&gt;&lt;/a&gt;1.Github端&lt;/h3&gt;&lt;p&gt;在&lt;code&gt;/blog/themes/next/source&lt;/code&gt;目录下新建文件名为：&lt;code&gt;CNAME&lt;/code&gt;文件，注意没有后缀名！直接将自己的域名如：&lt;code&gt;gonghonglou.com&lt;/code&gt;写入。&lt;/p&gt;
&lt;p&gt;终端cd到&lt;code&gt;blog&lt;/code&gt;目录下执行如下命令重新部署：&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;hexo clean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;hexo g&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;hexo d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意坑四：网上许多都是说在Github上直接新建&lt;code&gt;CNAME&lt;/code&gt;文件，如果这样的话，在你下一次执行&lt;code&gt;hexo d&lt;/code&gt;部署命令后&lt;code&gt;CNAME&lt;/code&gt;文件就消失了，因为本地没有此文件嘛。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;2-域名解析&quot;&gt;&lt;a href=&quot;#2-域名解析&quot; class=&quot;headerlink&quot; title=&quot;2.域名解析&quot;&gt;&lt;/a&gt;2.域名解析&lt;/h3&gt;&lt;p&gt;如果将域名指向一个域名，实现与被指向域名相同的访问效果，需要增加CNAME记录。登录万网，在你购买的域名后边点击：解析 –&amp;gt; 添加解析&lt;/p&gt;
&lt;p&gt;记录类型：CNAME&lt;/p&gt;
&lt;p&gt;主机记录：将域名解析为example.com（不带www），填写@或者不填写&lt;/p&gt;
&lt;p&gt;记录值：gonghonglou.github.io.    (不要忘记最后的&lt;code&gt;.&lt;/code&gt;，&lt;code&gt;gonghonglou&lt;/code&gt;改为你自己的用户名)，点击保存即可，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/firstblog/yumingjiexi.png&quot; alt=&quot;域名解析](http://localhost:4000&quot;&gt;&lt;/p&gt;
&lt;p&gt;此时，点击访问&lt;a href=&quot;http://gonghonglou.com&quot;&gt;http://gonghonglou.com&lt;/a&gt;和访问&lt;a href=&quot;http://gonghonglou.github.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://gonghonglou.github.io&lt;/a&gt;效果一致。&lt;/p&gt;
&lt;p&gt;大功告成！&lt;/p&gt;
&lt;h4 id=&quot;——11-10更新-以下————————————————&quot;&gt;&lt;a href=&quot;#——11-10更新-以下————————————————&quot; class=&quot;headerlink&quot; title=&quot;——11.10更新 以下————————————————&quot;&gt;&lt;/a&gt;——11.10更新 以下————————————————&lt;/h4&gt;&lt;h4 id=&quot;1、解决-deploy-后博客空白问题&quot;&gt;&lt;a href=&quot;#1、解决-deploy-后博客空白问题&quot; class=&quot;headerlink&quot; title=&quot;1、解决 deploy 后博客空白问题&quot;&gt;&lt;/a&gt;1、解决 deploy 后博客空白问题&lt;/h4&gt;&lt;p&gt;昨晚更新了一下 blog 做了个部署，结果blog就挂了，打开 &lt;code&gt;gonghonglou.com&lt;/code&gt; 页面显示一片空白。然而 &lt;code&gt;hexo s&lt;/code&gt; 开启本地服务器 &lt;code&gt;localhost:4000&lt;/code&gt; 访问是没问题的。&lt;br&gt;上网查了一下，原来是 GitHub Pages 禁止了 &lt;code&gt;source/vendors&lt;/code&gt; 目录的访问。Github 在 11 月 3 日更新了版本。其中包括升级了 Jekyll 到 3.3。Jekyll 为了加快构建速度，忽略 &lt;code&gt;vendor&lt;/code&gt; 和 &lt;code&gt;node_modules&lt;/code&gt; 文件夹。所以部署到 GitHub 后，识别不到本地下的的这个文件夹 &lt;code&gt;blog/themes/next/source/vendor&lt;/code&gt;，你只需要给这个文件夹换个名字再重新部署一次就 OK 了。&lt;code&gt;nexT&lt;/code&gt; 在 GitHub 上的 isusses 已经给出了解决方案：&lt;a href=&quot;https://github.com/iissnan/hexo-theme-next/issues/1214&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;#1214
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/firstblog/update-hexo-folder.png&quot; alt=&quot;#1214&quot;&gt;&lt;/p&gt;
&lt;p&gt;还有另一种解决方案就是升级 &lt;code&gt;nexT&lt;/code&gt; 主题，cd 到 &lt;code&gt;blog/themes/next/&lt;/code&gt; 下执行命令 &lt;code&gt;git pull&lt;/code&gt; 更新。&lt;br&gt;然而，有可能升级后多说评论等第三方工具会失效，慎用。&lt;/p&gt;
&lt;h4 id=&quot;2、将个人博客同时部署到-GitHub-和-Coding&quot;&gt;&lt;a href=&quot;#2、将个人博客同时部署到-GitHub-和-Coding&quot; class=&quot;headerlink&quot; title=&quot;2、将个人博客同时部署到 GitHub 和 Coding&quot;&gt;&lt;/a&gt;2、将个人博客同时部署到 GitHub 和 Coding&lt;/h4&gt;&lt;p&gt;1、首先到 &lt;a href=&quot;https://coding.net&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Coding&lt;/a&gt; 上注册并开一个项目，项目名称和用户个性后缀相同（方便二级域名访问博客），拿到项目的 https 地址&lt;/p&gt;
&lt;p&gt;2、打开本地 &lt;code&gt;blog&lt;/code&gt; 目录下的 &lt;code&gt;_config.yml&lt;/code&gt; 文件，修改如下&lt;br&gt;&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;deploy&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;: git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;repository&lt;/span&gt;: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;github&lt;/span&gt;: &lt;span class=&quot;attribute&quot;&gt;https&lt;/span&gt;:&lt;span class=&quot;comment&quot;&gt;//github.com/gonghonglou/gonghonglou.github.io.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;attribute&quot;&gt;coding&lt;/span&gt;: &lt;span class=&quot;attribute&quot;&gt;https&lt;/span&gt;:&lt;span class=&quot;comment&quot;&gt;//git.coding.net/gonghonglou/gonghonglou.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;branch&lt;/span&gt;: master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;3、cd 到本地 &lt;code&gt;blog/source&lt;/code&gt; 目录下执行如下命令新建 &lt;code&gt;Staticfile&lt;/code&gt; 文件&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;touch Staticfile  &lt;span class=&quot;comment&quot;&gt;#名字必须是Staticfile&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;原因是 coding.net 需要以这个文件来作为静态文件部署的标志，就是说看到这个 Staticfile 就知道按照静态文件来发布。&lt;/p&gt;
&lt;p&gt;4、执行发布命令 &lt;code&gt;hexo g&lt;/code&gt; 、 &lt;code&gt;hexo d&lt;/code&gt;  &lt;/p&gt;
&lt;p&gt;5、个人域名添加两条 &lt;code&gt;CNAME&lt;/code&gt; 解析。将 &lt;code&gt;gonghonglou.github.io.&lt;/code&gt; 解析为 [海外] ，将 &lt;code&gt;gonghonglou.coding.me.&lt;/code&gt; 解析为 [默认]&lt;br&gt;&lt;img src=&quot;http://image.gonghonglou.com/firstblog/two-cname.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这样就是为了从国内访问 &lt;code&gt;gonghonglou.com&lt;/code&gt; 就是访问 Coding 上的博客项目，从国外访问 &lt;code&gt;gonghonglou.com&lt;/code&gt; 就是访问 GitHub 上的博客项目。&lt;/p&gt;
&lt;p&gt;6、到 Coding 上的博客项目主页，点击 &lt;code&gt;Pages服务&lt;/code&gt; 输入部署分支 &lt;code&gt;master&lt;/code&gt; 立即开启&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://image.gonghonglou.com/firstblog/coding-pages.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这样就可以访问自己在 Coding 上的个人博客了 &lt;a href=&quot;http://gonghonglou.coding.me/gonghonglou&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gonghonglou.coding.me/gonghonglou&lt;/a&gt; 如果像这样你的用户后缀名与博客项目名称相同你还可以省略项目名称直接访问 &lt;a href=&quot;http://gonghonglou.coding.me&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;gonghonglou.coding.me&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;7、添加域名绑定，输入个人域名就 OK 了，可能需要耐心等待几分钟，这样在国内访问自己的博客就快得多了。&lt;/p&gt;
&lt;p&gt;试了一下在国内访问 &lt;a href=&quot;http://gonghonglou.com&quot;&gt;gonghonglou.com&lt;/a&gt; 拦不住 要飞起来了😂&lt;/p&gt;
&lt;h4 id=&quot;——11-10更新-以上————————————————&quot;&gt;&lt;a href=&quot;#——11-10更新-以上————————————————&quot; class=&quot;headerlink&quot; title=&quot;——11.10更新 以上————————————————&quot;&gt;&lt;/a&gt;——11.10更新 以上————————————————&lt;/h4&gt;&lt;h2 id=&quot;后记&quot;&gt;&lt;a href=&quot;#后记&quot; class=&quot;headerlink&quot; title=&quot;后记&quot;&gt;&lt;/a&gt;后记&lt;/h2&gt;&lt;p&gt;以上便是我搭建&lt;a href=&quot;http://gonghonglou.com&quot;&gt;与佳期的个人博客(gonghonglou.com)&lt;/a&gt;的全过程，希望对大家有所帮助，欢迎吐槽～&lt;/p&gt;
&lt;p&gt;转载请保留原文地址：&lt;a href=&quot;http://gonghonglou.com/2016/02/03/firstblog&quot;&gt;http://gonghonglou.com/2016/02/03/firstblog&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hexo.io/docs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo官网&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://leopardpan.github.io/2015/08/12/hexo/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HEXO&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/31cbbbc5f9fa/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;如何生成SSH key&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这是一篇详细文章来讲述用Mac搭建Hexo博客于Github上的完整历程， 也是踩了无数的坑搭起来的，现在写下些经验来分享，希望能帮大家少踩些坑。&lt;/p&gt;
&lt;p&gt;曾买过一款阿里的云虚拟主机，后来才发现不能自己装软件只能上传网站程序，除非另买&lt;a href=&quot;https://
    
    </summary>
    
      <category term="Technology" scheme="http://gonghonglou.com/categories/Technology/"/>
    
    
  </entry>
  
</feed>
